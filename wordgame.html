<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>ğŸ¯ Ù„Ø¹Ø¨Ø© Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø¨Ø¹Ø«Ø±Ø© - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„ÙØ§Ø®Ø±Ø©</title>
  <!-- Ø®Ø· Cairo -->
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <script src="tmi.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/tmi.js@1.8.5/dist/tmi.min.js"></script>
  <style>
    :root {
      /* Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
      --primary: #ff3b5c;
      --primary-dark: #d32f4e;
      --primary-light: #ff6b8b;
      --accent: #9146ff;
      --accent-dark: #6c1ed9;
      --accent-light: #b57aff;
      --success: #00ffcc;
      --success-dark: #00cc99;
      --warning: #ffcc00;
      --warning-dark: #cc9900;
      --info: #0099ff;
      --info-dark: #0077cc;
      --danger: #ff3333;
      --danger-dark: #cc0000;
      
      /* Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù…Ø­Ø§ÙŠØ¯Ø© */
      --dark-1: #0a0b14;
      --dark-2: #0e0f1a;
      --dark-3: #1a1b26;
      --dark-4: #2a2b3a;
      --light-1: #f8f9fa;
      --light-2: #e9ecef;
      --light-3: #dee2e6;
      --light-4: #ced4da;
      
      /* Ø§Ù„ØªØ¯Ø±Ø¬Ø§Øª */
      --gradient-primary: linear-gradient(135deg, var(--primary), var(--accent));
      --gradient-dark: linear-gradient(135deg, var(--dark-1), var(--dark-3));
      --gradient-success: linear-gradient(135deg, var(--success), var(--info));
      --gradient-warning: linear-gradient(135deg, var(--warning), var(--danger));
      
      /* Ø§Ù„Ø¸Ù„Ø§Ù„ */
      --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.1);
      --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.2);
      --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.3);
      --shadow-xl: 0 16px 64px rgba(0, 0, 0, 0.4);
      --shadow-primary: 0 4px 20px rgba(255, 59, 92, 0.3);
      --shadow-accent: 0 4px 20px rgba(145, 70, 255, 0.3);
      
      /* Ø§Ù„Ø²ÙˆØ§ÙŠØ§ */
      --radius-sm: 8px;
      --radius-md: 16px;
      --radius-lg: 24px;
      --radius-xl: 32px;
      --radius-full: 9999px;
      
      /* Ø§Ù„Ø£Ù†ÙŠÙ…ÙŠØ´Ù† */
      --transition-fast: 150ms ease;
      --transition-normal: 300ms ease;
      --transition-slow: 500ms ease;
      --transition-bounce: 500ms cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }

    /* Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¶Ø¨Ø· */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      height: 100%;
      font-family: 'Cairo', sans-serif;
      background: var(--dark-1);
      color: var(--light-1);
      overflow-x: hidden;
    }

    /* Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© */
    .bg-animation {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -3;
      background: linear-gradient(135deg, 
        var(--dark-1) 0%, 
        var(--dark-2) 25%, 
        var(--dark-3) 50%, 
        var(--dark-2) 75%, 
        var(--dark-1) 100%);
      background-size: 400% 400%;
      animation: gradientBG 15s ease infinite;
    }

    .particles {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -2;
      pointer-events: none;
    }

    .particle {
      position: absolute;
      background: var(--primary);
      border-radius: 50%;
      opacity: 0.1;
      animation: float 20s infinite linear;
    }

    .glow-effect {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 1000px;
      height: 1000px;
      background: radial-gradient(circle at center, 
        rgba(255, 59, 92, 0.1) 0%, 
        rgba(145, 70, 255, 0.05) 40%, 
        transparent 70%);
      z-index: -1;
      pointer-events: none;
    }

    /* Ø§Ù„Ø£Ù†ÙŠÙ…ÙŠØ´Ù†Ø§Øª */
    @keyframes gradientBG {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    @keyframes float {
      0% { transform: translateY(0) rotate(0deg); }
      100% { transform: translateY(-1000px) rotate(360deg); }
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    @keyframes slideIn {
      from { transform: translateY(-20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes fadeOut {
      from { opacity: 1; }
      to { opacity: 0; }
    }

    @keyframes glow {
      0%, 100% { box-shadow: 0 0 20px var(--primary); }
      50% { box-shadow: 0 0 40px var(--primary); }
    }

    @keyframes typing {
      from { width: 0; }
      to { width: 100%; }
    }

    /* Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
    .container {
      max-width: 1800px;
      margin: 0 auto;
      padding: 20px;
      position: relative;
      z-index: 1;
    }

    /* Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ */
    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
      padding: 20px;
      background: rgba(26, 27, 38, 0.8);
      backdrop-filter: blur(10px);
      border-radius: var(--radius-lg);
      border: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: var(--shadow-lg);
      animation: slideIn var(--transition-normal);
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .logo-icon {
      width: 50px;
      height: 50px;
      background: var(--gradient-primary);
      border-radius: var(--radius-md);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      animation: pulse 2s infinite;
    }

    .logo-text {
      display: flex;
      flex-direction: column;
    }

    .logo-text h1 {
      font-size: 28px;
      font-weight: 800;
      background: linear-gradient(135deg, var(--primary), var(--accent));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .logo-text span {
      font-size: 14px;
      color: var(--light-3);
      font-weight: 300;
    }

    /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
    .btn {
      padding: 12px 24px;
      border: none;
      border-radius: var(--radius-md);
      font-family: 'Cairo', sans-serif;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all var(--transition-fast);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      position: relative;
      overflow: hidden;
    }

    .btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left var(--transition-normal);
    }

    .btn:hover::before {
      left: 100%;
    }

    .btn-primary {
      background: var(--gradient-primary);
      color: white;
      box-shadow: var(--shadow-primary);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }

    .btn-secondary {
      background: rgba(255, 255, 255, 0.1);
      color: white;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .btn-secondary:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: translateY(-2px);
    }

    .btn-success {
      background: var(--gradient-success);
      color: white;
    }

    .btn-warning {
      background: var(--gradient-warning);
      color: white;
    }

    .btn-danger {
      background: linear-gradient(135deg, var(--danger), var(--danger-dark));
      color: white;
    }

    .btn-icon {
      width: 40px;
      height: 40px;
      padding: 0;
      border-radius: var(--radius-full);
    }

    /* Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª */
    .card {
      background: rgba(26, 27, 38, 0.8);
      backdrop-filter: blur(10px);
      border-radius: var(--radius-lg);
      border: 1px solid rgba(255, 255, 255, 0.1);
      padding: 24px;
      box-shadow: var(--shadow-lg);
      transition: all var(--transition-normal);
      animation: slideIn var(--transition-normal);
    }

    .card:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-xl);
      border-color: rgba(255, 59, 92, 0.3);
    }

    .card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
      padding-bottom: 16px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .card-header h2 {
      font-size: 20px;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    /* Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ø·ÙŠ */
    .collapsible-section {
      margin-bottom: 20px;
    }

    .section-header {
      background: rgba(42, 43, 58, 0.8);
      padding: 20px;
      border-radius: var(--radius-md);
      display: flex;
      align-items: center;
      justify-content: space-between;
      cursor: pointer;
      transition: all var(--transition-fast);
      border: 1px solid transparent;
    }

    .section-header:hover {
      background: rgba(42, 43, 58, 1);
      border-color: rgba(255, 255, 255, 0.1);
    }

    .section-header.open {
      border-bottom-left-radius: 0;
      border-bottom-right-radius: 0;
      border-color: var(--primary);
    }

    .section-header h3 {
      font-size: 18px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .toggle-icon {
      transition: transform var(--transition-fast);
    }

    .section-header.open .toggle-icon {
      transform: rotate(180deg);
    }

    .section-content {
      background: rgba(26, 27, 38, 0.8);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-top: none;
      border-radius: 0 0 var(--radius-md) var(--radius-md);
      padding: 20px;
      display: grid;
      grid-template-columns: 1fr 2fr;
      gap: 20px;
      animation: fadeIn var(--transition-normal);
    }

    @media (max-width: 1200px) {
      .section-content {
        grid-template-columns: 1fr;
      }
    }

    /* Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ */
    .form-group {
      margin-bottom: 20px;
    }

    .form-label {
      display: block;
      margin-bottom: 8px;
      font-size: 14px;
      font-weight: 500;
      color: var(--light-3);
    }

    .form-control {
      width: 100%;
      padding: 14px 16px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: var(--radius-md);
      color: white;
      font-family: 'Cairo', sans-serif;
      font-size: 16px;
      transition: all var(--transition-fast);
    }

    .form-control:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(255, 59, 92, 0.1);
    }

    .form-select {
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='white'%3E%3Cpath d='M7 10l5 5 5-5z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 16px center;
      background-size: 20px;
      padding-right: 50px;
    }

    /* Ø§Ù„Ø´Ø¨ÙƒØ§Øª */
    .grid {
      display: grid;
      gap: 20px;
    }

    .grid-2 {
      grid-template-columns: repeat(2, 1fr);
    }

    .grid-3 {
      grid-template-columns: repeat(3, 1fr);
    }

    .grid-4 {
      grid-template-columns: repeat(4, 1fr);
    }

    @media (max-width: 768px) {
      .grid-2, .grid-3, .grid-4 {
        grid-template-columns: 1fr;
      }
    }

    /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© */
    .game-stage {
      display: grid;
      grid-template-columns: 1fr 2fr 1fr;
      gap: 30px;
      margin-top: 30px;
    }

    @media (max-width: 1200px) {
      .game-stage {
        grid-template-columns: 1fr;
      }
    }

    .team-panel {
      background: rgba(26, 27, 38, 0.8);
      backdrop-filter: blur(10px);
      border-radius: var(--radius-lg);
      padding: 24px;
      border: 2px solid;
      box-shadow: var(--shadow-lg);
      animation: slideIn var(--transition-normal);
    }

    .team-blue {
      border-color: var(--info);
      box-shadow: 0 0 20px rgba(0, 153, 255, 0.2);
    }

    .team-red {
      border-color: var(--danger);
      box-shadow: 0 0 20px rgba(255, 51, 51, 0.2);
    }

    .team-header {
      text-align: center;
      margin-bottom: 20px;
      padding-bottom: 16px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .team-header h3 {
      font-size: 22px;
      font-weight: 700;
      margin-bottom: 8px;
    }

    .players-list {
      max-height: 400px;
      overflow-y: auto;
      padding: 16px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: var(--radius-md);
    }

    .player-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 16px;
      margin-bottom: 8px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: var(--radius-md);
      border: 1px solid transparent;
      transition: all var(--transition-fast);
    }

    .player-item:hover {
      background: rgba(255, 255, 255, 0.1);
      transform: translateX(5px);
    }

    .player-item.current-turn {
      background: rgba(255, 59, 92, 0.2);
      border-color: var(--primary);
      animation: pulse 2s infinite;
    }

    .player-info {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .player-avatar {
      width: 40px;
      height: 40px;
      background: var(--gradient-primary);
      border-radius: var(--radius-full);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
    }

    .player-name {
      font-weight: 600;
      font-size: 16px;
    }

    .player-turn-indicator {
      font-size: 12px;
      color: var(--primary);
      font-weight: 500;
    }

    /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© Ø§Ù„Ù…Ø±ÙƒØ²ÙŠØ© */
    .game-area {
      background: rgba(26, 27, 38, 0.8);
      backdrop-filter: blur(10px);
      border-radius: var(--radius-xl);
      padding: 32px;
      border: 3px solid var(--primary);
      box-shadow: 
        var(--shadow-xl),
        0 0 40px rgba(255, 59, 92, 0.3),
        inset 0 0 40px rgba(255, 59, 92, 0.1);
      animation: slideIn var(--transition-normal);
    }

    .game-controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
      padding: 20px;
      background: rgba(42, 43, 58, 0.8);
      border-radius: var(--radius-lg);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .game-info {
      text-align: center;
      margin: 30px 0;
    }

    .current-player-display {
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 20px;
      padding: 16px 32px;
      background: rgba(255, 59, 92, 0.2);
      border-radius: var(--radius-lg);
      border: 2px solid var(--primary);
      display: inline-block;
    }

    .word-container {
      margin: 40px 0;
      position: relative;
    }

    .difficulty-badge {
      position: absolute;
      top: -15px;
      left: 50%;
      transform: translateX(-50%);
      background: linear-gradient(135deg, var(--warning), var(--danger));
      color: white;
      padding: 8px 20px;
      border-radius: var(--radius-full);
      font-size: 16px;
      font-weight: 600;
      box-shadow: var(--shadow-md);
      z-index: 2;
      white-space: nowrap;
    }

    .scrambled-word {
      font-size: 96px;
      font-weight: 900;
      letter-spacing: 20px;
      line-height: 1.2;
      text-align: center;
      min-height: 150px;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 40px 20px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: var(--radius-lg);
      border: 2px solid rgba(255, 255, 255, 0.1);
      margin-top: 20px;
      animation: pulse 3s infinite;
    }

    .word-letters {
      color: white;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
    }

    @media (max-width: 768px) {
      .scrambled-word {
        font-size: 48px;
        letter-spacing: 10px;
        min-height: 100px;
        padding: 20px 10px;
      }
      
      .difficulty-badge {
        font-size: 14px;
        padding: 6px 15px;
        top: -12px;
      }
    }

    .timer-container {
      margin: 40px auto;
      max-width: 600px;
    }

    .timer-display {
      font-size: 36px;
      font-weight: 800;
      text-align: center;
      margin-bottom: 20px;
      font-family: monospace;
    }

    .progress-bar {
      height: 20px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: var(--radius-full);
      overflow: hidden;
      border: 2px solid rgba(255, 255, 255, 0.2);
    }

    .progress-fill {
      height: 100%;
      background: var(--gradient-primary);
      width: 100%;
      transition: width 1s linear;
      position: relative;
      overflow: hidden;
    }

    .progress-fill::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, 
        transparent, 
        rgba(255, 255, 255, 0.4), 
        transparent);
      animation: shimmer 2s infinite;
    }

    @keyframes shimmer {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }

    .scoreboard {
      display: flex;
      justify-content: center;
      gap: 60px;
      margin-top: 40px;
      padding: 24px;
      background: rgba(42, 43, 58, 0.8);
      border-radius: var(--radius-lg);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .score-item {
      text-align: center;
    }

    .score-label {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 12px;
    }

    .score-value {
      font-size: 48px;
      font-weight: 900;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    /* ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© */
    .answer-box {
      position: fixed;
      bottom: 30px;
      left: 30px;
      background: rgba(26, 27, 38, 0.95);
      backdrop-filter: blur(10px);
      border-radius: var(--radius-lg);
      padding: 20px;
      border: 2px solid var(--accent);
      box-shadow: var(--shadow-xl);
      z-index: 1000;
      animation: slideIn var(--transition-normal);
    }

    .answer-box h4 {
      font-size: 18px;
      margin-bottom: 10px;
      color: var(--accent);
    }

    .answer-text {
      font-size: 24px;
      font-weight: 700;
      color: var(--success);
      margin-bottom: 15px;
    }

    /* Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª */
    .stats-button {
      position: fixed;
      bottom: 30px;
      right: 30px;
      z-index: 1000;
      width: 60px;
      height: 60px;
      animation: pulse 2s infinite;
    }

    .stats-panel {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 90%;
      max-width: 1200px;
      max-height: 90vh;
      overflow-y: auto;
      z-index: 2000;
      display: none;
      animation: fadeIn var(--transition-normal);
    }

    .stats-panel.active {
      display: block;
    }

    /* Ø§Ù„Ø´Ø§Øª Ø§Ù„Ù…Ø¤Ù‚Øª */
    .chat-flash {
      position: fixed;
      top: 100px;
      right: 30px;
      width: 300px;
      max-height: 400px;
      overflow-y: auto;
      z-index: 900;
      display: none;
      background: rgba(26, 27, 38, 0.95);
      backdrop-filter: blur(10px);
      border-radius: var(--radius-lg);
      border: 2px solid var(--info);
      box-shadow: var(--shadow-xl);
      padding: 15px;
    }

    .chat-flash.active {
      display: block;
      animation: fadeIn 0.3s ease;
    }

    .chat-flash.fading {
      animation: fadeOut 0.3s ease forwards;
    }

    .chat-message {
      background: rgba(255, 255, 255, 0.05);
      border-radius: var(--radius-md);
      padding: 12px 16px;
      margin-bottom: 10px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      animation: slideIn 0.3s ease;
    }

    /* Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ */
    .modal-backdrop {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(5px);
      z-index: 1900;
      display: none;
      animation: fadeIn var(--transition-normal);
    }

    .modal-backdrop.active {
      display: block;
    }

    .modal {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 90%;
      max-width: 1000px;
      z-index: 2000;
      display: none;
      animation: slideIn var(--transition-bounce);
    }

    .modal.active {
      display: block;
    }

    .modal-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }

    @media (max-width: 768px) {
      .modal-grid {
        grid-template-columns: 1fr;
      }
    }

    /* ØªØ®ØµÙŠØµØ§Øª */
    .status-chip {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 8px 16px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: var(--radius-full);
      border: 1px solid rgba(255, 255, 255, 0.2);
      font-size: 14px;
    }

    .status-chip.connected {
      background: rgba(0, 255, 204, 0.2);
      border-color: var(--success);
      color: var(--success);
    }

    .status-chip.disconnected {
      background: rgba(255, 51, 51, 0.2);
      border-color: var(--danger);
      color: var(--danger);
    }

    .switch {
      position: relative;
      display: inline-block;
      width: 50px;
      height: 28px;
    }

    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(255, 255, 255, 0.1);
      transition: var(--transition-fast);
      border-radius: var(--radius-full);
    }

    .slider:before {
      position: absolute;
      content: "";
      height: 20px;
      width: 20px;
      left: 4px;
      bottom: 4px;
      background-color: white;
      transition: var(--transition-fast);
      border-radius: 50%;
    }

    input:checked + .slider {
      background-color: var(--primary);
    }

    input:checked + .slider:before {
      transform: translateX(22px);
    }

    /* Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª */
    .notification {
      position: fixed;
      top: 30px;
      right: 30px;
      padding: 20px;
      background: rgba(26, 27, 38, 0.95);
      backdrop-filter: blur(10px);
      border-radius: var(--radius-lg);
      border-left: 4px solid;
      box-shadow: var(--shadow-xl);
      z-index: 3000;
      animation: slideIn var(--transition-normal);
      display: none;
      max-width: 400px;
    }

    .notification.success {
      border-left-color: var(--success);
    }

    .notification.error {
      border-left-color: var(--danger);
    }

    .notification.warning {
      border-left-color: var(--warning);
    }

    .notification.info {
      border-left-color: var(--info);
    }

    .notification.active {
      display: block;
    }

    /* ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ù†Øµ */
    .typing-effect {
      overflow: hidden;
      white-space: nowrap;
      animation: typing 2s steps(40, end);
    }

    /* Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
    .loader {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--dark-1);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      transition: opacity var(--transition-normal);
    }

    .loader-content {
      text-align: center;
    }

    .spinner {
      width: 60px;
      height: 60px;
      border: 4px solid rgba(255, 255, 255, 0.1);
      border-top-color: var(--primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-bottom: 20px;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Ø§Ù„ØªØ¬Ø§ÙˆØ¨ */
    @media (max-width: 768px) {
      .container {
        padding: 10px;
      }
      
      .top-bar {
        flex-direction: column;
        gap: 20px;
        text-align: center;
      }
      
      .game-controls {
        flex-direction: column;
        gap: 15px;
      }
      
      .scoreboard {
        flex-direction: column;
        gap: 30px;
      }
      
      .answer-box, .stats-button {
        bottom: 10px;
        left: 10px;
        right: 10px;
        width: calc(100% - 20px);
      }
    }

    /* ØªØ£Ø«ÙŠØ±Ø§Øª Ø®Ø§ØµØ© */
    .particles-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: -1;
    }

    .confetti {
      position: absolute;
      width: 10px;
      height: 10px;
      background: var(--primary);
      animation: confetti-fall 5s linear forwards;
    }

    @keyframes confetti-fall {
      0% {
        transform: translateY(-100px) rotate(0deg);
        opacity: 1;
      }
      100% {
        transform: translateY(100vh) rotate(720deg);
        opacity: 0;
      }
    }

    /* ØªÙ„Ù…ÙŠØ­Ø§Øª */
    .tooltip {
      position: relative;
      display: inline-block;
    }

    .tooltip .tooltip-text {
      visibility: hidden;
      width: 200px;
      background-color: rgba(26, 27, 38, 0.95);
      color: white;
      text-align: center;
      padding: 8px;
      border-radius: var(--radius-md);
      position: absolute;
      z-index: 1;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      opacity: 0;
      transition: opacity var(--transition-fast);
      font-size: 12px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: var(--shadow-md);
    }

    .tooltip:hover .tooltip-text {
      visibility: visible;
      opacity: 1;
    }
  </style>
</head>
<body>
  <!-- Ø§Ù„Ø®Ù„ÙÙŠØ§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© -->
  <div class="bg-animation"></div>
  <div class="glow-effect"></div>
  <div class="particles-container" id="particles"></div>

  <!-- Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ -->
  <div class="loader" id="loader">
    <div class="loader-content">
      <div class="spinner"></div>
      <h2 style="color: var(--primary); margin-bottom: 10px;">ğŸ¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù„Ø¹Ø¨Ø©</h2>
      <p style="color: var(--light-3);">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰...</p>
    </div>
  </div>

  <!-- Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª -->
  <div class="notification" id="notification"></div>

  <!-- Ø§Ù„Ù…ÙˆØ¯Ø§Ù„Ø§Øª -->
  <div class="modal-backdrop" id="modalBackdrop"></div>

  <!-- Ù†Ø§ÙØ°Ø© Ù…ÙˆØ­Ø¯Ø© Ù„Ù„Ø§ØªØµØ§Ù„ ÙˆØ§Ù„ØªØ­ÙƒÙ… -->
  <div class="modal" id="controlModal">
    <div class="card" style="max-height: 90vh; overflow-y: auto;">
      <div class="card-header">
        <h2><span>âš™ï¸</span> Ø§Ù„ØªØ­ÙƒÙ… ÙˆØ§Ù„Ø§ØªØµØ§Ù„</h2>
        <button class="btn btn-icon" onclick="closeControlModal()">âœ–</button>
      </div>
      
      <div class="modal-grid">
        <!-- Ù„ÙˆØ­Ø© Ø§Ù„Ø§ØªØµØ§Ù„ -->
        <div class="card">
          <h3 style="margin-bottom: 20px; color: var(--info);">ğŸ”— Ø§ØªØµØ§Ù„ Ø§Ù„Ø´Ø§Øª</h3>
          
          <div class="form-group">
            <label class="form-label">ğŸ“º Ø§Ø³Ù… Ø§Ù„Ù‚Ù†Ø§Ø©</label>
            <input type="text" class="form-control" id="channelInput" placeholder="Ù…Ø«Ø§Ù„: streamer_name">
          </div>
          
          <div class="form-group">
            <label class="form-label">ğŸŒ Ø§Ù„Ù…Ù†ØµØ©</label>
            <select class="form-control form-select" id="platformSelect">
              <option value="twitch">Twitch</option>
              <option value="kick">Kick</option>
            </select>
          </div>
          
          <div style="display: flex; align-items: center; gap: 20px; margin-bottom: 20px;">
            <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
              <div class="switch">
                <input type="checkbox" id="rememberMe">
                <span class="slider"></span>
              </div>
              <span>ğŸ’¾ ØªØ°ÙƒÙ‘Ø±Ù†ÙŠ</span>
            </label>
            
            <div id="statusDisplay" class="status-chip">
              <span>ğŸ”´</span> ØºÙŠØ± Ù…ØªØµÙ„
            </div>
          </div>
          
          <button class="btn btn-primary" onclick="connectChat()" style="width: 100%;">
            <span>ğŸš€</span> Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø´Ø§Øª
          </button>
          
          <div style="margin-top: 20px; padding: 15px; background: rgba(0, 153, 255, 0.1); border-radius: var(--radius-md); font-size: 14px;">
            <span>ğŸ’¡</span> ØªØ¹Ù„ÙŠÙ…Ø§Øª: Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ù‚Ù†Ø§ØªÙƒØŒ Ø§Ø®ØªØ± Ø§Ù„Ù…Ù†ØµØ©ØŒ Ø«Ù… Ø§Ø¶ØºØ· Ø§ØªØµØ§Ù„
          </div>
        </div>
        
        <!-- Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… -->
        <div class="card">
          <h3 style="margin-bottom: 20px; color: var(--warning);">ğŸ® ØªØ­ÙƒÙ… Ø§Ù„Ø³ØªØ±ÙŠÙ…Ø±</h3>
          
          <div class="grid grid-2" style="gap: 15px; margin-bottom: 20px;">
            <div class="form-group">
              <label class="form-label">â±ï¸ ÙˆÙ‚Øª Ø§Ù„Ø¬ÙˆÙ„Ø©</label>
              <input type="number" class="form-control" id="roundTime" value="30" min="10" max="180">
            </div>
            
            <div class="form-group">
              <label class="form-label">ğŸ† Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</label>
              <input type="number" class="form-control" id="targetScore" value="15" min="5" max="100">
            </div>
          </div>
          
          <div class="grid grid-2" style="gap: 15px; margin-bottom: 20px;">
            <label style="display: flex; align-items: center; gap: 10px; padding: 12px; background: rgba(255, 255, 255, 0.05); border-radius: var(--radius-md);">
              <div class="switch">
                <input type="checkbox" id="autoTimer" checked>
                <span class="slider"></span>
              </div>
              <span>Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø¤Ù‚Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹</span>
            </label>
            
            <label style="display: flex; align-items: center; gap: 10px; padding: 12px; background: rgba(255, 255, 255, 0.05); border-radius: var(--radius-md);">
              <div class="switch">
                <input type="checkbox" id="autoNext" checked>
                <span class="slider"></span>
              </div>
              <span>Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ</span>
            </label>
          </div>
          
          <div style="margin-top: 25px; padding-top: 20px; border-top: 1px solid rgba(255, 255, 255, 0.1);">
            <h4 style="margin-bottom: 15px; color: var(--primary);">ğŸ›ï¸ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø³Ø±ÙŠØ¹Ø©</h4>
            <div class="grid grid-2" style="gap: 10px;">
              <button class="btn btn-primary" onclick="startGame(); closeControlModal();">
                <span>ğŸš€</span> Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©
              </button>
              <button class="btn btn-warning" onclick="skipTurn(); closeControlModal();">
                <span>â­ï¸</span> ØªØ®Ø·ÙŠ
              </button>
              <button class="btn btn-secondary" onclick="startTimer(); closeControlModal();">
                <span>â±ï¸</span> Ù…Ø¤Ù‚Øª
              </button>
              <button class="btn btn-info" onclick="useHint(); closeControlModal();">
                <span>ğŸ’¡</span> ØªÙ„Ù…ÙŠØ­
              </button>
            </div>
          </div>
        </div>
      </div>
      
      <div style="text-align: center; margin-top: 25px; padding-top: 20px; border-top: 1px solid rgba(255, 255, 255, 0.1);">
        <button class="btn btn-secondary" onclick="closeControlModal()" style="width: 200px;">Ø¥ØºÙ„Ø§Ù‚</button>
      </div>
    </div>
  </div>

  <!-- Ø´Ø±Ø­ Ø§Ù„Ù„Ø¹Ø¨Ø© -->
  <div class="modal" id="helpModal">
    <div class="card">
      <div class="card-header">
        <h2><span>ğŸ“˜</span> Ø´Ø±Ø­ Ø§Ù„Ù„Ø¹Ø¨Ø©</h2>
        <button class="btn btn-icon" onclick="closeHelp()">âœ–</button>
      </div>
      <div class="content" style="padding: 20px; line-height: 1.8;">
        <h3 style="color: var(--primary); margin-bottom: 20px;">ğŸ® ÙƒÙŠÙÙŠØ© Ø§Ù„Ù„Ø¹Ø¨</h3>
        <p>ÙÙŠ ÙƒÙ„ Ø¯ÙˆØ±ØŒ ØªØ¸Ù‡Ø± ÙƒÙ„Ù…Ø© <b style="color: var(--accent)">Ù…Ø¨Ø¹Ø«Ø±Ø©</b>. Ø¹Ù„Ù‰ Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø­Ø§Ù„ÙŠ Ø¥Ø¹Ø§Ø¯Ø© ØªØ±ØªÙŠØ¨Ù‡Ø§ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­ Ø®Ù„Ø§Ù„ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø­Ø¯Ø¯.</p>
        
        <div style="margin: 25px 0;">
          <h4 style="color: var(--info); margin-bottom: 15px;">ğŸ› ï¸ Ø§Ù„Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©:</h4>
          <div class="grid grid-2" style="gap: 15px;">
            <div class="card" style="background: rgba(0, 153, 255, 0.1);">
              <h5 style="color: var(--info);">!Ø§Ø²Ø±Ù‚</h5>
              <p style="font-size: 14px;">Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù… Ù„Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø²Ø±Ù‚</p>
            </div>
            <div class="card" style="background: rgba(255, 51, 51, 0.1);">
              <h5 style="color: var(--danger);">!Ø§Ø­Ù…Ø±</h5>
              <p style="font-size: 14px;">Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù… Ù„Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø­Ù…Ø±</p>
            </div>
            <div class="card" style="background: rgba(255, 204, 0, 0.1);">
              <h5 style="color: var(--warning);">!Ù†Ù‚Ø§Ø·ÙŠ</h5>
              <p style="font-size: 14px;">Ø¹Ø±Ø¶ Ù†Ù‚Ø§Ø·Ùƒ Ø§Ù„Ø´Ø®ØµÙŠØ©</p>
            </div>
            <div class="card" style="background: rgba(0, 255, 204, 0.1);">
              <h5 style="color: var(--success);">!ØªØ­Ø¯ÙŠ @Ø§Ø³Ù…</h5>
              <p style="font-size: 14px;">ØªØ­Ø¯Ù‘ÙŠ Ù„Ø§Ø¹Ø¨ Ø¢Ø®Ø±</p>
            </div>
          </div>
        </div>

        <div style="margin: 25px 0;">
          <h4 style="color: var(--primary); margin-bottom: 15px;">âš¡ Ø§Ø®ØªØµØ§Ø±Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­:</h4>
          <div class="grid grid-2" style="gap: 10px;">
            <div style="display: flex; align-items: center; gap: 10px; padding: 10px; background: rgba(255, 255, 255, 0.05); border-radius: var(--radius-md);">
              <span style="background: var(--dark-4); padding: 4px 12px; border-radius: var(--radius-sm); font-family: monospace;">Space</span>
              <span>Ø¥ÙŠÙ‚Ø§Ù/ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø¤Ù‚Øª</span>
            </div>
            <div style="display: flex; align-items: center; gap: 10px; padding: 10px; background: rgba(255, 255, 255, 0.05); border-radius: var(--radius-md);">
              <span style="background: var(--dark-4); padding: 4px 12px; border-radius: var(--radius-sm); font-family: monospace;">N</span>
              <span>Ø§Ù„Ø¯ÙˆØ± Ø§Ù„ØªØ§Ù„ÙŠ</span>
            </div>
            <div style="display: flex; align-items: center; gap: 10px; padding: 10px; background: rgba(255, 255, 255, 0.05); border-radius: var(--radius-md);">
              <span style="background: var(--dark-4); padding: 4px 12px; border-radius: var(--radius-sm); font-family: monospace;">H</span>
              <span>Ø·Ù„Ø¨ ØªÙ„Ù…ÙŠØ­</span>
            </div>
            <div style="display: flex; align-items: center; gap: 10px; padding: 10px; background: rgba(255, 255, 255, 0.05); border-radius: var(--radius-md);">
              <span style="background: var(--dark-4); padding: 4px 12px; border-radius: var(--radius-sm); font-family: monospace;">S</span>
              <span>Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</span>
            </div>
          </div>
        </div>

        <div style="margin-top: 30px; padding: 20px; background: rgba(255, 59, 92, 0.1); border-radius: var(--radius-md); border-left: 4px solid var(--primary);">
          <h5 style="color: var(--primary);">ğŸ’¡ Ù†ØµØ§Ø¦Ø­ Ù…Ù‡Ù…Ø©:</h5>
          <ul style="margin-top: 10px; padding-right: 20px;">
            <li>ÙŠÙ…ÙƒÙ† Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù… Ù„Ø£ÙŠ ÙØ±ÙŠÙ‚ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©</li>
            <li>ÙƒÙ„ Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø© ØªÙ…Ù†Ø­ Ù†Ù‚Ø§Ø·Ø§Ù‹ Ø­Ø³Ø¨ ØµØ¹ÙˆØ¨Ø© Ø§Ù„ÙƒÙ„Ù…Ø©</li>
            <li>Ø§Ù„ØªÙ„Ù…ÙŠØ­ ÙŠÙƒØ´Ù Ø£ÙˆÙ„ ÙˆØ¢Ø®Ø± Ø­Ø±Ù ÙˆÙŠØ®ØµÙ… 5 Ø«ÙˆØ§Ù†Ù Ù…Ù† Ø§Ù„ÙˆÙ‚Øª</li>
            <li>ØªØ®Ø·ÙŠ Ø§Ù„Ø¯ÙˆØ± ÙŠØ®ØµÙ… Ù†Ù‚Ø·ØªÙŠÙ† Ù…Ù† Ø§Ù„ÙØ±ÙŠÙ‚</li>
            <li>ÙŠÙ…ÙƒÙ† ØªØ®ØµÙŠØµ ÙˆÙ‚Øª Ø§Ù„Ø¬ÙˆÙ„Ø© ÙˆØ§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø³ØªØ±ÙŠÙ…Ø±</li>
          </ul>
        </div>
      </div>
      <div style="text-align: center; padding: 20px; border-top: 1px solid rgba(255, 255, 255, 0.1);">
        <button class="btn btn-primary" onclick="closeHelp()" style="width: 200px;">ÙÙ‡Ù…Øª! Ø¯Ø¹Ù†Ø§ Ù†Ù„Ø¹Ø¨</button>
      </div>
    </div>
  </div>

  <!-- Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
  <div class="modal" id="statsModal">
    <div class="card">
      <div class="card-header">
        <h2><span>ğŸ“Š</span> Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†</h2>
        <button class="btn btn-icon" onclick="closeStats()">âœ–</button>
      </div>
      <div id="statsContent" style="padding: 20px; max-height: 60vh; overflow-y: auto;">
        <!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
      </div>
    </div>
  </div>

  <!-- Ø´Ø§Øª Ù…Ø¤Ù‚Øª -->
  <div class="chat-flash" id="chatFlash">
    <div id="chatMessages"></div>
  </div>

  <div class="container">
    <!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ -->
    <div class="top-bar">
      <div class="logo">
        <div class="logo-icon">ğŸ¯</div>
        <div class="logo-text">
          <h1>Ù„Ø¹Ø¨Ø© Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø¨Ø¹Ø«Ø±Ø©</h1>
          <span>Ù†Ø³Ø®Ø© ÙØ§Ø®Ø±Ø© Ù…Ø¹ Ø§ØªØµØ§Ù„ Ù…Ø¨Ø§Ø´Ø± Ø¨Ø§Ù„Ø´Ø§Øª</span>
        </div>
      </div>
      
      <div style="display: flex; gap: 15px;">
        <button class="btn btn-primary" onclick="showHelp()">
          <span>â”</span> Ø´Ø±Ø­ Ø§Ù„Ù„Ø¹Ø¨Ø©
        </button>
        <button class="btn btn-secondary" onclick="showControlModal()">
          <span>âš™ï¸</span> Ø§Ù„ØªØ­ÙƒÙ… ÙˆØ§Ù„Ø§ØªØµØ§Ù„
        </button>
      </div>
    </div>

    <!-- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© -->
    <div class="game-stage">
      <!-- Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø²Ø±Ù‚ -->
      <div class="team-panel team-blue">
        <div class="team-header">
          <h3 style="color: var(--info);">ğŸ”µ Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø²Ø±Ù‚</h3>
          <div style="font-size: 32px; font-weight: 800; color: var(--info);" id="blueScore">0</div>
          <div style="color: var(--light-3); font-size: 14px;">Ù†Ù‚Ø·Ø©</div>
        </div>
        
        <div class="players-list" id="bluePlayers">
          <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† -->
        </div>
      </div>

      <!-- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© Ø§Ù„Ù…Ø±ÙƒØ²ÙŠØ© -->
      <div class="game-area">
        <!-- Ø´Ø±ÙŠØ· Ø§Ù„ØªØ­ÙƒÙ… Ø¯Ø§Ø®Ù„ Ø§Ù„Ù„Ø¹Ø¨Ø© -->
        <div class="game-controls">
          <div style="display: flex; gap: 10px;">
            <button class="btn btn-primary" onclick="startGame()">
              <span>ğŸš€</span> Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©
            </button>
            <button class="btn btn-warning" onclick="skipTurn()">
              <span>â­ï¸</span> ØªØ®Ø·ÙŠ
            </button>
          </div>
          
          <div style="display: flex; gap: 10px;">
            <button class="btn btn-secondary" onclick="startTimer()">
              <span>â±ï¸</span> Ù…Ø¤Ù‚Øª
            </button>
            <button class="btn btn-secondary" onclick="nextTurn()">
              <span>ğŸ”„</span> ØªØ§Ù„ÙŠ
            </button>
            <button class="btn btn-info" onclick="useHint()">
              <span>ğŸ’¡</span> ØªÙ„Ù…ÙŠØ­
            </button>
          </div>
        </div>

        <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø­Ø§Ù„ÙŠ -->
        <div class="game-info">
          <div class="current-player-display" id="currentPlayer">
            â³ Ø¬Ø§Ø±ÙŠ ØªØ­Ø¶ÙŠØ± Ø§Ù„Ù„Ø¹Ø¨Ø©...
          </div>
        </div>

        <!-- Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø¨Ø¹Ø«Ø±Ø© Ù…Ø¹ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØµØ¹ÙˆØ¨Ø© -->
        <div class="word-container">
          <div class="difficulty-badge" id="difficultyBadge">
            âš¡ Ù…ØªÙˆØ³Ø·
          </div>
          <div class="scrambled-word" id="scrambledWord">
            ğŸ¯ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨Ø©
          </div>
        </div>

        <!-- Ø§Ù„Ù…Ø¤Ù‚Øª -->
        <div class="timer-container">
          <div class="timer-display" id="timerDisplay">
            â° 00:00
          </div>
          <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
          </div>
        </div>

        <!-- Ù†ØªÙŠØ¬Ø© Ø§Ù„ØªØ®Ù…ÙŠÙ† -->
        <div style="text-align: center; margin: 30px 0; min-height: 40px;">
          <div id="guessResult" style="font-size: 20px; font-weight: 600;"></div>
        </div>

        <!-- Ø§Ù„Ù†Ù‚Ø§Ø· -->
        <div class="scoreboard">
          <div class="score-item">
            <div class="score-label" style="color: var(--info);">ğŸ”µ Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø²Ø±Ù‚</div>
            <div class="score-value" id="blueScoreDisplay">0</div>
          </div>
          
          <div class="score-item">
            <div class="score-label" style="color: var(--danger);">ğŸ”´ Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø­Ù…Ø±</div>
            <div class="score-value" id="redScoreDisplay">0</div>
          </div>
        </div>
      </div>

      <!-- Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø­Ù…Ø± -->
      <div class="team-panel team-red">
        <div class="team-header">
          <h3 style="color: var(--danger);">ğŸ”´ Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø­Ù…Ø±</h3>
          <div style="font-size: 32px; font-weight: 800; color: var(--danger);" id="redScore">0</div>
          <div style="color: var(--light-3); font-size: 14px;">Ù†Ù‚Ø·Ø©</div>
        </div>
        
        <div class="players-list" id="redPlayers">
          <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† -->
        </div>
      </div>
    </div>
  </div>

  <!-- ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© -->
  <div class="answer-box">
    <h4>ğŸ” Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©:</h4>
    <div class="answer-text" id="answerText">â“</div>
    <button class="btn btn-secondary" onclick="toggleAnswer()" style="width: 100%;">
      <span>ğŸ‘ï¸</span> Ø¥Ø®ÙØ§Ø¡/Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©
    </button>
  </div>

  <!-- Ø²Ø± Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
  <button class="btn btn-primary stats-button" onclick="toggleStats()">
    <span>ğŸ“Š</span>
  </button>

<script>
/* ========= Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„ÙØ§Ø®Ø± ========= */

// ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø¬Ø³ÙŠÙ…Ø§Øª
function initParticles() {
  const container = document.getElementById('particles');
  const colors = ['#ff3b5c', '#9146ff', '#00ffcc', '#0099ff', '#ffcc00'];
  
  for (let i = 0; i < 50; i++) {
    const particle = document.createElement('div');
    particle.className = 'particle';
    
    const size = Math.random() * 10 + 5;
    particle.style.width = `${size}px`;
    particle.style.height = `${size}px`;
    particle.style.left = `${Math.random() * 100}%`;
    particle.style.top = `${Math.random() * 100}%`;
    particle.style.background = colors[Math.floor(Math.random() * colors.length)];
    particle.style.opacity = Math.random() * 0.2 + 0.05;
    particle.style.animationDuration = `${Math.random() * 20 + 10}s`;
    particle.style.animationDelay = `${Math.random() * 5}s`;
    
    container.appendChild(particle);
  }
}

// Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª
function showNotification(message, type = 'info') {
  const notification = document.getElementById('notification');
  const icons = {
    success: 'âœ…',
    error: 'âŒ',
    warning: 'âš ï¸',
    info: 'â„¹ï¸'
  };
  
  notification.innerHTML = `
    <div style="display: flex; align-items: start; gap: 15px;">
      <div style="font-size: 24px;">${icons[type]}</div>
      <div>
        <div style="font-weight: 600; margin-bottom: 5px;">${type === 'success' ? 'Ù†Ø¬Ø§Ø­' : type === 'error' ? 'Ø®Ø·Ø£' : type === 'warning' ? 'ØªØ­Ø°ÙŠØ±' : 'Ù…Ø¹Ù„ÙˆÙ…Ø©'}</div>
        <div style="color: var(--light-3);">${message}</div>
      </div>
    </div>
  `;
  
  notification.className = `notification ${type} active`;
  
  setTimeout(() => {
    notification.classList.remove('active');
  }, 5000);
}

// Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
window.addEventListener('load', () => {
  setTimeout(() => {
    document.getElementById('loader').style.opacity = '0';
    setTimeout(() => {
      document.getElementById('loader').style.display = 'none';
      initParticles();
      showNotification('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¨Ù†Ø¬Ø§Ø­! ğŸ®', 'success');
    }, 500);
  }, 1000);
});

// Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø¨ØµØ±ÙŠØ©
function createConfetti() {
  const container = document.getElementById('particles');
  const colors = ['#ff3b5c', '#9146ff', '#00ffcc', '#0099ff', '#ffcc00'];
  
  for (let i = 0; i < 50; i++) {
    const confetti = document.createElement('div');
    confetti.className = 'confetti';
    
    const size = Math.random() * 15 + 5;
    confetti.style.width = `${size}px`;
    confetti.style.height = `${size}px`;
    confetti.style.left = `${Math.random() * 100}%`;
    confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
    confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
    confetti.style.animationDuration = `${Math.random() * 3 + 2}s`;
    confetti.style.animationDelay = `${Math.random() * 0.5}s`;
    
    container.appendChild(confetti);
    
    setTimeout(() => {
      confetti.remove();
    }, 5000);
  }
}

/* ========= Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ========= */

// Ø§Ù„Ø­Ø§Ù„Ø©
const bluePlayers = [];
const redPlayers = [];
let blueTurnOrder = [];
let redTurnOrder = [];
let turnIndex = 0;
let currentAnswer = "";
let blueScore = 0;
let redScore = 0;
let roundSeconds = 30;
let targetScore = 15;
let autoTimer = true;
let autoNext = true;
let timeLeft = 0;
let timerInterval;
let timerRunning = false;
let twitchClient = null;
let kickSocket = null;
let currentPlayerName = "";
let answeringTeam = "";
const usedWords = [];
const playerStats = {};
const blacklistedUsers = [];
const commandCooldowns = {};

// Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙƒÙ„Ù…Ø§Øª
const words = [
  "Ø£Ù…Ù„","Ø­ÙŠØ§Ø©","Ù†ÙˆØ±","Ø³Ø¹Ø§Ø¯Ø©","Ø´Ù…Ø³","Ù‚Ù…Ø±","Ø³Ù…Ø§Ø¡","Ù†Ø¬Ù…Ø©","Ø¨Ø­Ø±","Ù†Ù‡Ø±",
  "Ø¬Ø¨Ù„","ÙˆØ±Ø¯Ø©","Ø²Ù‡Ø±Ø©","Ø´Ø¬Ø±Ø©","ØºØ§Ø¨Ø©","Ø·ÙŠÙˆØ±","Ø£Ø³Ø¯","Ù†Ù…Ø±","ÙÙ‡Ø¯","Ø°Ø¦Ø¨",
  "Ø¯Ø¨","Ø­ØµØ§Ù†","Ø­Ù…Ø§Ø±","Ø¨Ù‚Ø±Ø©","ØºØ²Ø§Ù„","Ø³Ù…ÙƒØ©","Ø­ÙˆØª","Ø¯Ù„ÙÙŠÙ†","Ù†Ø­Ù„Ø©","ÙØ±Ø§Ø´Ø©",
  "Ù†Ù…Ù„Ø©","Ø¹ØµÙÙˆØ±","Ø¨Ø¨ØºØ§Ø¡","ØµÙ‚Ø±","Ø¨ÙˆÙ…Ø©","Ø¯ÙŠÙƒ","Ø¯Ø¬Ø§Ø¬Ø©","Ø¨Ø·","ÙˆØ²Ø©","Ø¨Ø·Ø©",
  "ÙƒÙ„Ø¨","Ù‚Ø·Ø©","Ø¬Ù…Ù„","Ù‚Ø±Ø´","ØªÙ…Ø³Ø§Ø­","Ø³Ù„Ø­ÙØ§Ø©","Ø«Ø¹Ø¨Ø§Ù†","Ø¹Ù‚Ø±Ø¨","Ø¶ÙØ¯Ø¹","Ù‚Ø±Ø¯",
  "ÙƒÙ†ØºØ±","Ø·Ø§ÙˆÙˆØ³","Ù†Ø¹Ø§Ù…Ø©","Ø­Ù…Ø§Ù…Ø©","ØºØ±Ø§Ø¨","Ø¨Ù„Ø¨Ù„","ÙŠÙ…Ø§Ù…Ø©","Ø¯Ø±Ø§Ø¬","Ø¯Ø¨ÙˆØ±","Ø¬Ø±Ø§Ø¯Ø©",
  "ØµØ±ØµÙˆØ±","ÙŠØ±Ø§Ø¹Ø©","Ø®ÙØ§Ø´","Ø£Ø±Ù†Ø¨","Ø­Ø±Ø¨Ø§Ø¡","ØºØ±ÙŠØ±","Ù„Ø§Ù…Ø§","Ù…ÙˆØ¸","Ø¸Ø¨ÙŠ","Ø¶Ø¨Ø¹",
  "ØªÙ†ÙŠÙ†","Ø£Ø³Ø·ÙˆØ±Ø©","Ø³Ø§Ø­Ø±","Ù‚Ù„Ø¹Ø©","Ø¹Ø±Ø´","ØªØ§Ø¬","Ù…Ù„Ùƒ","Ù…Ù„ÙƒØ©","Ø£Ù…ÙŠØ±","Ø£Ù…ÙŠØ±Ø©",
  "ÙˆØ²ÙŠØ±","Ø¬ÙŠØ´","Ø³ÙŠÙ","Ø¯Ø±Ø¹","Ø±Ù…Ø­","Ù‚ÙˆØ³","Ø³Ù‡Ù…","Ø­Ø±Ø¨Ø©","Ø®ÙˆØ°Ø©","ÙØ±Ø³",
  "Ù†Ø³Ø±","Ø´Ø¹Ù„Ø©","Ù„Ù‡Ø¨","Ø¬Ù…Ø±","Ø±ÙŠØ­","Ø¹Ø§ØµÙØ©","Ø«Ù„Ø¬","Ø¨Ø±Ø¯","ØµÙ‚ÙŠØ¹","ØµØ­Ø±Ø§Ø¡",
  "ÙˆØ§Ø­Ø©","Ø±Ù…Ù„","Ø·ÙŠÙ†","Ø¨Ø±ÙƒØ§Ù†","Ø²Ù„Ø²Ø§Ù„","Ù…Ø·Ø±","Ù†Ø¯Ù‰","ØºÙŠÙ…","Ø¹Ø´Ø¨","Ø£Ø±Ø¶",
  "ØªØ±Ø¨Ø©","Ø­Ø¯ÙŠÙ‚Ø©","Ù…Ø²Ø±Ø¹Ø©","Ø¨Ø³ØªØ§Ù†","Ø¯ÙˆØ­Ø©","Ù…Ø¯ÙŠÙ†Ø©","Ù‚Ø±ÙŠØ©","Ø¨Ù„Ø¯Ø©","Ø³ÙˆÙ‚","Ù…ÙƒØªØ¨Ø©",
  "Ù…Ø¯Ø±Ø³Ø©","Ø¬Ø§Ù…Ø¹Ø©","Ù…Ø³Ø¬Ø¯","ÙƒÙ†ÙŠØ³Ø©","Ù…Ø¹Ø¨Ø¯","Ù…ØªØ­Ù","Ù‚ØµØ±","Ù…Ø³Ø±Ø­","Ù…Ø³ØªØ´ÙÙ‰","Ù…Ø·Ø¹Ù…",
  "Ù…Ù‚Ù‡Ù‰","ÙÙ†Ø¯Ù‚","Ù…Ø·Ø§Ø±","Ù…ÙŠÙ†Ø§Ø¡","Ù…Ø­Ø·Ø©","Ù‚Ø·Ø§Ø±","Ø­Ø§ÙÙ„Ø©","Ø³ÙŠØ§Ø±Ø©","Ø¯Ø±Ø§Ø¬Ø©","Ø³ÙÙŠÙ†Ø©",
  "Ø·Ø§Ø¦Ø±Ø©","ØµØ§Ø±ÙˆØ®","Ù‚Ø§Ø±Ø¨","ØºÙˆØ§ØµØ©","Ù…Ø±ÙˆØ­ÙŠØ©","Ù…ØµØ¨Ø§Ø­","Ø´Ù…Ø¹Ø©","Ø¨Ø·Ø§Ø±ÙŠØ©","Ù‡Ø§ØªÙ","Ø­Ø§Ø³ÙˆØ¨",
  "Ù„ÙˆØ­Ø©","Ø³Ø§Ø¹Ø©","ÙƒØªØ§Ø¨","Ø¯ÙØªØ±","Ù‚Ù„Ù…","ÙØ±Ø´Ø§Ø©","Ù…Ù…Ø­Ø§Ø©","Ù…Ø³Ø·Ø±Ø©","Ù…Ù‚Øµ","Ù…Ø±Ø¢Ø©",
  "ÙƒØ±Ø³ÙŠ","Ø·Ø§ÙˆÙ„Ø©","Ø³Ø±ÙŠØ±","Ø®Ø²Ø§Ù†Ø©","Ø¨Ø§Ø¨","Ù†Ø§ÙØ°Ø©","Ø³ØªØ§Ø±Ø©","Ø³Ø¬Ø§Ø¯Ø©","ÙˆØ³Ø§Ø¯Ø©","Ø¨Ø·Ø§Ù†ÙŠØ©",
  "Ø­Ù‚ÙŠØ¨Ø©","ØµÙ†Ø¯ÙˆÙ‚","Ø¯Ø±Ø¬","Ø±Ù","Ø·Ø¨Ù‚","ÙƒÙˆØ¨","Ù…Ù„Ø¹Ù‚Ø©","Ø³ÙƒÙŠÙ†","Ø´ÙˆÙƒØ©","Ù‚Ø¯Ø±",
  "Ù…Ù‚Ù„Ø§Ø©","ØºÙ„Ø§ÙŠØ©","Ø²Ø¬Ø§Ø¬Ø©","Ø¬Ø±Ø©","ÙˆØ¹Ø§Ø¡","Ù…ØµÙØ§Ø©","Ù…ØºØ³Ù„Ø©","Ø«Ù„Ø§Ø¬Ø©","ÙØ±Ù†","Ù…ÙƒÙŠÙ",
  "Ù…Ø¯ÙØ£Ø©","Ù…Ø±ÙˆØ­Ø©","ØºØ³Ø§Ù„Ø©","Ù…Ø¬ÙÙ","Ù…ÙƒÙ†Ø³Ø©","Ù…Ù…Ø³Ø­Ø©","Ø³Ù„Ø©","Ø¹Ù„Ø¨Ø©","Ù…ØºÙ„Ù","Ù…Ø·Ø±Ù‚Ø©",
  "Ù…Ø³Ù…Ø§Ø±","Ù…ÙØªØ§Ø­","ÙƒÙ…Ø§Ø´Ø©","Ù…Ù†Ø´Ø§Ø±","Ù…Ø¨Ø±Ø¯","Ù…Ø«Ù‚Ø§Ø¨","Ø­Ø¨Ù„","Ø³Ù„Ø³Ù„Ø©","Ù‚ÙÙ„","Ù…ÙŠØ²Ø§Ù†",
  "Ù…ÙŠØ²Ø§Ø¨","Ø®Ø±Ø·ÙˆÙ…","Ø¨Ø±Ù…ÙŠÙ„","Ø¯Ù„Ùˆ","Ø³Ø·Ù„","Ø§Ø³ÙÙ†Ø¬Ø©","ØµØ§Ø¨ÙˆÙ†","Ù…Ø¹Ø¬ÙˆÙ†","Ù…Ø±Ø·Ø¨","Ù…Ø±Ù‡Ù…",
  "Ø¯ÙˆØ§Ø¡","Ø¹Ø·Ø±","Ø¨Ø®ÙˆØ±","Ù…Ù†Ø´ÙØ©","Ø´Ø±Ø´Ù","Ø­Ø¬Ø§Ø¨","Ù‚Ø¨Ø¹Ø©","Ù‚Ù…ÙŠØµ","Ø¨Ù†Ø·Ø§Ù„","ØªÙ†ÙˆØ±Ø©",
  "ÙØ³ØªØ§Ù†","Ø¬Ø§ÙƒÙŠØª","Ù…Ø¹Ø·Ù","Ø­Ø°Ø§Ø¡","Ø¬ÙˆØ±Ø¨","Ù‚ÙØ§Ø²","Ù†Ø¸Ø§Ø±Ø©","Ø­Ø²Ø§Ù…","Ù…Ø­ÙØ¸Ø©",
  "Ø®Ø§ØªÙ…","Ù‚Ù„Ø§Ø¯Ø©","Ø­Ù„Ù‚","Ø²ÙŠÙ†Ø©","Ù…Ø¸Ù„Ø©","Ø´Ø±ÙØ©","Ø³Ø·Ø­","Ø³Ø±Ø¯Ø§Ø¨","Ù‚Ø¨Ùˆ",
  "Ø¯Ù‡Ù„ÙŠØ²","Ø±Ø¯Ù‡Ø©","ØµØ§Ù„Ø©","Ù…Ø·Ø¨Ø®","Ù…Ù…Ø±","Ø¨ÙˆØ§Ø¨Ø©","Ø³ÙˆØ±","Ø³ÙŠØ§Ø¬","Ø±ØµÙŠÙ",
  "Ø¬Ø³Ø±","Ù†ÙÙ‚","Ù…ÙŠØ¯Ø§Ù†","Ø´Ø§Ø±Ø¹","Ø²Ù‚Ø§Ù‚","Ø¯Ø±Ø¨","Ø·Ø±ÙŠÙ‚","Ù…Ø³Ø§Ø±","Ø±Ø­Ù„Ø©","Ø³ÙØ±Ø©",
  "Ø¬ÙˆÙ„Ø©","Ù†Ø²Ù‡Ø©","Ù…ØºØ§Ù…Ø±Ø©","Ø§ÙƒØªØ´Ø§Ù","Ø¨Ø­Ø«","Ù„Ù‚Ø§Ø¡","Ù…ÙˆØ¹Ø¯","Ø§Ø¬ØªÙ…Ø§Ø¹","Ù…Ø­Ø§Ø¯Ø«Ø©","Ù†Ù‚Ø§Ø´",
  "Ø§ØªÙØ§Ù‚","Ø¹Ù‚Ø¯","ØµÙÙ‚Ø©","ØªØ¬Ø§Ø±Ø©","Ø¨ÙŠØ¹","Ø´Ø±Ø§Ø¡","ØªØ¨Ø§Ø¯Ù„","Ù‡Ø¯ÙŠØ©","ØªØ°ÙƒØ§Ø±","ØªØ­ÙØ©",
  "ØµÙˆØ±Ø©","Ø±Ø³Ù…","ØªÙ…Ø«Ø§Ù„","Ø·Ø§Ø¨Ø¹","Ø®ØªÙ…","Ø¸Ø±Ù","ÙˆØ«ÙŠÙ‚Ø©","Ø¨Ø·Ø§Ù‚Ø©","Ø¬ÙˆØ§Ø²",
  "ØªØ±Ø®ÙŠØµ","ÙØ§ØªÙˆØ±Ø©","Ø¥ÙŠØµØ§Ù„","Ø³Ø¬Ù„","Ù…ÙÙƒØ±Ø©","Ù…Ø°ÙƒØ±Ø©","ØªÙ‚Ø±ÙŠØ±","Ù‚ØµØ©","Ø±ÙˆØ§ÙŠØ©",
  "Ù…Ø¬Ù„Ø©","Ø¬Ø±ÙŠØ¯Ø©","Ø¥Ø¹Ù„Ø§Ù†","Ø¯Ø¹Ø§ÙŠØ©","Ø´Ø¹Ø§Ø±","Ø¹Ù„Ø§Ù…Ø©","Ø±Ù…Ø²","Ø®Ø±ÙŠØ·Ø©","Ø¬Ø¯ÙˆÙ„","ØªØµÙ…ÙŠÙ…",
  "Ø®Ø·Ø©","Ø¨Ø±Ù†Ø§Ù…Ø¬","Ø·Ø±ÙŠÙ‚Ø©","Ù†Ù…Ø·","Ø´ÙƒÙ„","Ø¨Ù†ÙŠØ©","Ù‡ÙŠÙƒÙ„","Ø¹Ù…Ø§Ø±Ø©","Ø²Ø®Ø±ÙØ©","Ù†Ù‚Ø´",
  "ØªØ·Ø±ÙŠØ²","ØµØ¨Ø§ØºØ©","ØªØ±Ù…ÙŠÙ…","ØµÙŠØ§Ù†Ø©","ØªØµÙˆÙŠØ±","Ø·Ø¨Ø§Ø¹Ø©","Ù†Ø³Ø®","ØªØ±Ø¬Ù…Ø©","ØªØ­Ø±ÙŠØ±","Ø¥Ø¹Ø¯Ø§Ø¯",
  "Ø¥Ù†ØªØ§Ø¬","Ù†Ø´Ø±","Ø¥Ø°Ø§Ø¹Ø©","ØªØ³Ø¬ÙŠÙ„","Ø¹Ø±Ø¶","Ù…Ø´Ø§Ø±ÙƒØ©","ØªÙˆØ²ÙŠØ¹","ØªØ­Ù…ÙŠÙ„","ØªØ´ØºÙŠÙ„","Ø¥ÙŠÙ‚Ø§Ù",
  "Ø¨Ø¯Ø¡","ØªØ­Ø¯ÙŠØ«","ØªØ·ÙˆÙŠØ±","Ø¥ØµÙ„Ø§Ø­","ØªØºÙŠÙŠØ±","Ø­Ø°Ù","Ø¥Ø¶Ø§ÙØ©","Ù„ØµÙ‚","Ø­ÙØ¸",
  "Ø±ÙØ¹","ØªÙ†Ø²ÙŠÙ„","Ø¥Ø±Ø³Ø§Ù„","Ø§Ø³ØªÙ‚Ø¨Ø§Ù„","Ø¶Ø¨Ø·","ØªÙ‡ÙŠØ¦Ø©","ØªÙØ¹ÙŠÙ„","Ø¥Ù„ØºØ§Ø¡","Ø­Ù…Ø§ÙŠØ©",
  "ØªØ´ÙÙŠØ±","Ø¨Ø±Ù…Ø¬Ø©","Ø§Ø®ØªØ¨Ø§Ø±","ØªÙˆØ«ÙŠÙ‚","Ø¯Ø¹Ù…","Ù…ØªØ§Ø¨Ø¹Ø©","Ø¥Ø¯Ø§Ø±Ø©","Ù‚ÙŠØ§Ø¯Ø©",
  "ØªÙ†Ø¸ÙŠÙ…","ØªÙˆØ¬ÙŠÙ‡","Ù…Ø±Ø§Ù‚Ø¨Ø©","ØªÙ‚ÙŠÙŠÙ…","ØªØ­Ù„ÙŠÙ„","Ø§Ø¨ØªÙƒØ§Ø±","Ø§Ø³ØªÙƒØ´Ø§Ù","ØªØ¹Ù„ÙŠÙ…","ØªØ¯Ø±ÙŠØ¨","ØªØ¯Ø±ÙŠØ³",
  "Ø´Ø±Ø­","ØªÙˆØ¶ÙŠØ­","Ø¥ÙŠØ¶Ø§Ø­","ØªØ­Ø³ÙŠÙ†","ØªØ¹Ø¯ÙŠÙ„","ØªØ¬Ø±Ø¨Ø©","Ù…Ø­Ø§ÙˆÙ„Ø©","Ø¥Ù†Ø¬Ø§Ø²","Ù†Ø¬Ø§Ø­","ØªÙ…ÙŠØ²",
  "Ø´ØºÙ","Ø¥Ù„Ù‡Ø§Ù…","Ø¥Ø¨Ø¯Ø§Ø¹","Ø®ÙŠØ§Ù„","ÙÙƒØ±","ÙˆØ¹ÙŠ","Ø¥Ø¯Ø±Ø§Ùƒ","Ø­ÙƒÙ…Ø©","Ù…Ø¹Ø±ÙØ©","Ø®Ø¨Ø±Ø©",
  "Ù…ÙˆÙ‡Ø¨Ø©","Ù…Ù‡Ø§Ø±Ø©","Ù‚Ø¯Ø±Ø©","ÙƒÙØ§Ø¡Ø©","ØªØ®ØµØµ","Ø§Ù‡ØªÙ…Ø§Ù…","ÙØ¶ÙˆÙ„","Ø±ØºØ¨Ø©","Ø¹Ø²ÙŠÙ…Ø©",
  "Ø¥Ø±Ø§Ø¯Ø©","Ø·Ù…ÙˆØ­","ØªÙØ§Ø¤Ù„","Ø¥ÙŠÙ…Ø§Ù†","ÙŠÙ‚ÙŠÙ†","Ø«Ù‚Ø©","Ø¥Ø®Ù„Ø§Øµ","Ù…Ø­Ø¨Ø©",
  "Ù…ÙˆØ¯Ø©","Ø±Ø­Ù…Ø©","Ø¹Ø·Ù","Ø­Ù†Ø§Ù†","Ø±Ø¹Ø§ÙŠØ©","ØªØ¹Ø§ÙˆÙ†","Ù…Ø³Ø§Ø¹Ø¯Ø©","ØªØ¶Ø§Ù…Ù†","Ù…ÙˆØ§Ø³Ø§Ø©",
  "ØµØ¯Ø§Ù‚Ø©","Ø£Ø®ÙˆØ©","Ù‚Ø±Ø§Ø¨Ø©","Ø¬Ø§Ø±","Ø¶ÙŠÙ","Ø²Ù…ÙŠÙ„","Ø´Ø±ÙŠÙƒ","Ø±ÙÙŠÙ‚","Ù…Ø¹Ø§Ø±Ù","Ù†Ø§Ø³",
  "Ø´Ø®Øµ","Ø±Ø¬Ù„","Ø§Ù…Ø±Ø£Ø©","Ø·ÙÙ„","Ø´Ø§Ø¨","ÙØªØ§Ø©","ÙƒÙ‡Ù„","Ø´ÙŠØ®","Ù…Ø³Ù†","Ø¹Ø¬ÙˆØ²",
  "Ø±Ø¶ÙŠØ¹","Ù…Ø±Ø§Ù‡Ù‚","ÙŠØªÙŠÙ…","Ø£Ø±Ù…Ù„","Ø£Ø¹Ø²Ø¨","Ù…ØªØ²ÙˆØ¬","Ù…Ø·Ù„Ù‚","Ø­Ø¨ÙŠØ¨","Ø®Ø·ÙŠØ¨","ØµØ¯ÙŠÙ‚",
  "Ø¹Ø¯Ùˆ","Ø®ØµÙ…","Ù…Ù†Ø§ÙØ³","ØªØ§Ø¨Ø¹","Ù…Ø³ØªÙ‚Ù„","Ù…Ø­Ø§ÙŠØ¯","Ø²Ø¹ÙŠÙ…","Ù‚Ø§Ø¦Ø¯","Ø±Ø¦ÙŠØ³",
  "ÙˆÙƒÙŠÙ„","Ù†Ø§Ø¦Ø¨","Ø³ÙÙŠØ±","ÙˆØ§Ù„ÙŠ","Ø­Ø§ÙƒÙ…","Ù‚Ø§Ø¶ÙŠ","Ù…Ø­Ø§Ù…ÙŠ","Ø´Ø±Ø·ÙŠ","Ø¬Ù†Ø¯ÙŠ",
  "Ø·ÙŠØ§Ø±","Ø¨Ø­Ø§Ø±","Ø³Ø§Ø¦Ù‚","Ø¹Ø§Ù…Ù„","Ø­Ø§Ø±Ø³","Ù…Ø²Ø§Ø±Ø¹","ØµÙŠØ§Ø¯","ØµØ§Ù†Ø¹","Ø¨Ø§Ø¦Ø¹","ØªØ§Ø¬Ø±",
  "Ù†Ø¬Ø§Ø±","Ø­Ø¯Ø§Ø¯","Ø®ÙŠØ§Ø·","Ø­Ù„Ø§Ù‚","Ù…ØµÙˆØ±","Ù…Ø®Ø±Ø¬","Ù…Ù…Ø«Ù„","Ù…ØºÙ†ÙŠ",
  "Ø´Ø§Ø¹Ø±","ÙƒØ§ØªØ¨","Ù…Ø¤Ù„Ù","Ù†Ø§Ù‚Ø¯","Ù…ÙˆØ³ÙŠÙ‚ÙŠ","ÙÙ†Ø§Ù†","Ø£Ø¯ÙŠØ¨","Ø¹Ø§Ù„Ù…","Ø¨Ø§Ø­Ø«","Ù…Ø®ØªØ±Ø¹",
  "Ù…Ø¨ØªÙƒØ±","Ù…ÙƒØªØ´Ù","Ù…Ø¯ÙŠØ±","Ù…Ø³Ø¤ÙˆÙ„","Ù…Ø¯Ø±Ø¨","Ù…Ø¹Ù„Ù…","Ù…Ø±Ø´Ø¯","ÙˆØ§Ø¹Ø¸","Ø¥Ù…Ø§Ù…",
  "Ø¯Ø§Ø¹ÙŠØ©","Ø²Ø§Ù‡Ø¯","Ø­ÙƒÙŠÙ…","ÙÙ‚ÙŠÙ‡","Ù…Ø¤Ø±Ø®","ØµØ­ÙÙŠ","Ù…Ø°ÙŠØ¹","Ù…Ø±Ø§Ø³Ù„","Ù…Ø­Ø±Ø±",
  "Ù…ØªØ±Ø¬Ù…","Ù…Ø¯Ù‚Ù‚","Ù†Ø§Ø´Ø±","Ù…ÙˆØ²Ø¹","Ù…Ø³ÙˆÙ‚","Ù…Ø·ÙˆØ±","Ù…Ø¨Ø±Ù…Ø¬","Ù…ØµÙ…Ù…","Ù…Ù†ØªØ¬","Ù…Ù†Ø´Ø¯",
  "Ù…Ø¤Ø°Ù†","Ø­Ø§ÙØ¸","Ù‚Ø§Ø±Ø¦","Ù†Ø§Ø³Ø®","Ø®Ø·Ø§Ø·","Ø²Ø®Ø±Ù","Ù…Ù†Ù‚ÙˆØ´","ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ",
  "Ø³Ø¨Ø§Ùƒ","Ø¨Ù†Ø§Ø¡","Ø±Ø§Ø¹ÙŠ","Ù…Ø±Ø¨ÙŠ","Ø·Ø¨Ø§Ø®","Ø¬Ø²Ø§Ø±","Ø®Ø¨Ø§Ø²",
  "Ø³Ø§Ø¹ÙŠ","Ù…Ø³ØªØ´Ø§Ø±","Ø³Ù„Ø·Ø§Ù†","Ø®Ù„ÙŠÙØ©","Ø£Ø³ØªØ§Ø°","Ù…Ø­Ø§Ø³Ø¨",
  "Ø·Ø¨ÙŠØ¨","ØµÙŠØ¯Ù„ÙŠ","Ù…Ù…Ø±Ø¶","Ø¬Ø±Ø§Ø­","Ù…Ø¹Ø§Ù„Ø¬","Ø®Ø¨ÙŠØ±","ÙÙ†ÙŠ","Ù…Ù‡Ù†Ø¯Ø³","Ù…ÙÙƒØ±","Ù†Ø§Ø¸Ø±",
  "Ù…ÙØªØ´","Ù…Ø±Ø§Ù‚Ø¨","Ù…Ø´ØºÙ„","Ù…Ù„Ø§Ø­Ø¸","Ù†Ø§Ø¯Ù„","Ø®Ø§Ø¯Ù…","Ø­Ù…Ø§Ù„","Ø¨ÙˆØ§Ø¨","Ù†Ø§Ø·ÙˆØ±","Ù…Ø´Ø±Ù",
  "Ø§Ø¨ØªØ³Ø§Ù…Ø©","Ø¥ØµØ±Ø§Ø±","Ø¥Ù†Ø¬Ø§Ø²","Ø¥ÙŠØ«Ø§Ø±","Ø¨Ø³Ø§Ø·Ø©","Ø¨Ù‡Ø¬Ø©","ØªØ­Ø¯ÙŠ","ØªÙØ§Ù†ÙŠ","ØªÙ…Ø§Ø³Ùƒ","Ø«Ø¨Ø§Øª",
  "Ø¬Ù…Ø§Ù„","Ø¬ÙˆØ¯","Ø­Ø¨","Ø­Ù„Ù…","Ø®Ø¬Ù„","Ø¯Ø¹Ù…","Ø°ÙƒØ§Ø¡","Ø±ÙˆØ­","Ø²Ù‡Ø¯","Ø³Ø®Ø§Ø¡",
  "Ø³Ù„Ø§Ù…","Ø´Ø¬Ø§Ø¹Ø©","ØµØ¨Ø±","Ø¶Ø­Ùƒ","Ø·Ù…Ø£Ù†ÙŠÙ†Ø©","Ø¹Ø·Ø§Ø¡","ÙØ±Ø­","ÙØ®Ø±","Ù‚ÙˆØ©","ÙƒØ±Ù…",
  "Ù„Ø·Ù","Ù…Ø±Ø­","Ù†Ù‚Ø§Ø¡","Ù‡Ø¯ÙˆØ¡","ÙˆÙØ§Ø¡","ÙŠØ³Ø±","Ø£Ù…Ø§Ù†","Ø¥Ø¨Ø¯Ø§Ø¹","Ø¨Ø±Ø§Ø¡Ø©","ØªØ¢Ù„Ù",
  "ØªØ³Ø§Ù…Ø­","ØªÙˆØ§Ø¶Ø¹","Ø¬Ø§Ø°Ø¨ÙŠØ©","Ø­ÙƒÙ…Ø©","Ø®ÙŠØ§Ù„","Ø¯ÙØ¡","Ø±Ù‚Ø©","Ø´Ù‡Ø§Ù…Ø©","ØµÙØ§Ø¡","Ø¹Ø²ÙŠÙ…Ø©",
  "Ø¹ÙÙˆÙŠØ©","ØºØ±ÙˆØ±","ÙØ·Ø±Ø©","Ù‚Ù†Ø§Ø¹Ø©","Ù„Ø¨Ø§Ù‚Ø©","Ù…Ø±ÙˆØ¡Ø©","Ù†Ø¨Ù„","Ù‡ÙŠØ¨Ø©","ÙˆØ¯Ø§Ø¹Ø©","ÙŠØ£Ø³",
  "Ø¥ØªÙ‚Ø§Ù†","Ø¨Ø´Ø§Ø´Ø©","ØªØ£Ù„Ù‚","ØªØ¹Ø§Ø·Ù","Ø¬Ø¯","Ø­Ø²Ù…","Ø®Ø¨Ø±Ø©","Ø¯Ù‚Ø©","Ø±Ø²Ø§Ù†Ø©","Ø³Ø¹Ø§Ø¯Ø©",
  "Ø´Ù…ÙˆØ®","ØµØ¯Ù‚","Ø·Ù…ÙˆØ­","Ø¹ÙØ©","ØºÙ…ÙˆØ¶","ÙØ·Ù†Ø©","Ù‚Ø¯Ø±","ÙƒÙŠØ§Ø³Ø©","Ù…Ø«Ø§Ø¨Ø±Ø©","Ù†Ø´Ø§Ø·",
  "Ù‡Ù…Ø©","Ø£Ù„ÙØ©","Ø¨Ø´Ø±","ØªÙƒØ§ÙÙ„","Ø«Ù‚Ø©","Ø­ÙŠØ§Ø©","Ø®ÙˆÙ","Ø°ÙˆÙ‚","Ø±Ø­ÙŠÙ„","Ø²Ù‡Ùˆ",
  "Ø´ÙˆÙ‚","ØµÙ…ÙˆØ¯","Ø¹Ø´Ù‚","ÙØ±ÙˆØ³ÙŠØ©","Ù‚Ø¯Ø±Ø©","ÙƒÙ„Ù…Ø©","Ù…ÙˆØ¯Ø©","Ù†Ù‚Ø§Ø´","Ù‡Ù…Ø³","ÙˆØ¬Ø¯",
  "Ø¥Ø­Ø³Ø§Ù†","Ø¨ØµÙŠØ±Ø©","ØªÙ…ÙŠØ²","Ø­ÙƒÙ…Ø©","Ø¯Ù„Ø§Ù„","Ø±Ø§Ø­Ø©","Ø³Ø­Ø±","Ø´ØºÙ","Ø¶ÙŠØ§Ø¡","Ø¹Ø¨Ø±Ø©",
  "ÙÙ†","Ù‚ÙŠÙ…Ø©","Ù„ØºØ©","Ù…Ù‡Ø§Ø±Ø©","Ù†ÙˆØ±","Ù‡ÙˆÙŠØ©","Ø§Ø¨ØªÙƒØ§Ø±","Ø¨Ø±ÙŠÙ‚","ØªØ­Ù…Ù„","ØªØ¹Ù„Ù‚",
  "Ø¬Ù„Ø§Ù„","Ø­Ù†ÙŠÙ†","Ø¯Ø¹Ø§Ø¨Ø©","Ø±ÙˆÙ…Ø§Ù†Ø³ÙŠØ©","Ø³Ù…Ùˆ","Ø´Ø¹Ø±","ØµØ®Ø¨","Ø¹Ø¸Ù…Ø©","ÙÙ„Ø³ÙØ©","Ù‚Ø¨Ø³",
  "Ù„Ù…Ø³Ø©","Ù…Ø²Ø§Ø¬","Ù†ØºÙ…","Ù‡Ø¨Ø©","Ø¥Ø±Ø«","Ø¨Ø³Ø§Ù„Ø©","ØªØ£Ù…Ù„","Ø¬Ø±Ø£Ø©","Ø­Ø¶ÙˆØ±","Ø®Ø¨Ø±",
  "Ø¯ÙŠÙ†","Ø±ÙŠØ§Ø¯Ø©","Ø³ÙƒÙˆÙ†","Ø´Ø±Ø§ÙƒØ©","ØµØ¯ÙŠÙ‚","Ø¹Ø·Ø´","ÙÙƒØ±","Ù‚Ø¯ÙˆØ©","Ù„Ù‚Ø§Ø¡","Ù…Ø¨Ø¯Ø£",
  "Ù†Ø¶Ø¬","Ù‡ÙŠØ§Ù…","Ø¥Ø´Ø±Ø§Ù‚","Ø¨Ø²ÙˆØº","ØªØ­Ù‚ÙŠÙ‚","ØªØ¶Ø­ÙŠØ©","Ø¬Ø°Ù„","Ø­ÙƒØ§ÙŠØ©","Ø¯Ø±Ø§ÙŠØ©","Ø±ØºØ¨Ø©",
  "Ø³Ø±Ø¯","Ø´ÙƒØ±","ØµØ¯Ù‰","Ø¹Ø²","ÙÙ‡Ù…","Ù‚Ù„Ø¨","Ù…Ù‚ØµØ¯","Ù†Ù‡Ø¶Ø©","ÙˆØ¬Ø¯Ø§Ù†","Ø¥Ù„Ù‡Ø§Ù…",
  "Ø¨Ø²ÙˆØº","ØªÙ†Ø§ØºÙ…","Ø­ÙˆØ§Ø±","Ø°ÙƒØ§Ø¡","Ø±ÙˆØ§ÙŠØ©","Ø³Ø¹Ø§Ø¯Ø©","Ø´Ø¹Ø±","ØµÙˆØª","Ø¹Ø§Ù„Ù…","ÙÙ†ÙˆÙ†",
  "Ù‚ØµØ©","Ù…ÙƒØªØ¨","Ù†Ù‡Ø§ÙŠØ©","Ù‡Ù†Ø¯Ø³Ø©","Ø§Ø¨ØªÙƒØ§Ø±","Ø¨Ø­Ø±","ØªØ§Ø±ÙŠØ®","Ø­Ø¶Ø§Ø±Ø©","Ø¯ÙˆØ§Ø¡","Ø±Ø³Ù…",
  "Ø³ÙØ±","Ø´Ù…Ø³","ØµØ­Ø©","Ø¹Ù„Ù…","ÙÙ„Ùƒ","Ù‚Ù…Ø±","Ù…ÙˆØ³ÙŠÙ‚Ù‰","Ù†Ø¬ÙˆÙ…","Ù‡ÙˆØ§Ø¡","ÙŠØ§Ù‚ÙˆØª"
];

// Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©
function normalizeArabic(s) {
  if (!s) return "";
  return s.replace(/[\u0640]/g, '')
    .replace(/[Ø¥Ø£Ø¢Ø§]/g, 'Ø§')
    .replace(/Ù‰/g, 'ÙŠ')
    .replace(/Ø¤/g, 'Ùˆ')
    .replace(/Ø¦/g, 'ÙŠ')
    .replace(/Ø©/g, 'Ù‡')
    .replace(/\s+/g, '')
    .trim();
}

function shuffleWord(w) {
  let a = w.split(''), s;
  do {
    s = a.slice();
    for (let i = s.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [s[i], s[j]] = [s[j], s[i]];
    }
  } while (s.join('') === w);
  return s.join('');
}

function getDifficultyLevel(word) {
  const length = word.length;
  if (length <= 5) return { level: 'ğŸŸ¢ Ø³Ù‡Ù„', time: 25, points: 1 };
  if (length <= 7) return { level: 'ğŸŸ¡ Ù…ØªÙˆØ³Ø·', time: 35, points: 2 };
  return { level: 'ğŸ”´ ØµØ¹Ø¨', time: 50, points: 3 };
}

// Ø§Ù„Ù…Ø¤Ù‚Øª
function startTimer() {
  if (timerRunning) return;
  
  roundSeconds = parseInt(document.getElementById('roundTime').value);
  timeLeft = roundSeconds;
  
  updateTimerDisplay();
  clearInterval(timerInterval);
  timerRunning = true;
  
  timerInterval = setInterval(() => {
    timeLeft--;
    updateTimerDisplay();
    
    if (timeLeft <= 0) {
      clearInterval(timerInterval);
      timerRunning = false;
      document.getElementById('timerDisplay').innerHTML = 'â° Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª!';
      showNotification('Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª! Ø§Ù†ØªÙ‚Ù„ Ù„Ù„Ø¯ÙˆØ± Ø§Ù„ØªØ§Ù„ÙŠ', 'warning');
    }
  }, 1000);
}

function stopTimer() {
  clearInterval(timerInterval);
  timerRunning = false;
}

function updateTimerDisplay() {
  const timerDisplay = document.getElementById('timerDisplay');
  const progressFill = document.getElementById('progressFill');
  
  timerDisplay.innerHTML = `â° ${timeLeft.toString().padStart(2, '0')}:00`;
  
  const percentage = (timeLeft / roundSeconds) * 100;
  progressFill.style.width = `${percentage}%`;
  
  // ØªØºÙŠÙŠØ± Ø§Ù„Ù„ÙˆÙ† Ø­Ø³Ø¨ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ
  if (timeLeft <= 10) {
    progressFill.style.background = 'linear-gradient(135deg, var(--danger), var(--danger-dark))';
    timerDisplay.style.color = 'var(--danger)';
  } else if (timeLeft <= 20) {
    progressFill.style.background = 'linear-gradient(135deg, var(--warning), var(--warning-dark))';
    timerDisplay.style.color = 'var(--warning)';
  } else {
    progressFill.style.background = 'var(--gradient-primary)';
    timerDisplay.style.color = 'var(--primary)';
  }
}

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†
function updatePlayerList(team) {
  const listId = team === 'blue' ? "bluePlayers" : "redPlayers";
  const players = team === 'blue' ? bluePlayers : redPlayers;
  const container = document.getElementById(listId);
  
  if (players.length === 0) {
    container.innerHTML = `
      <div style="text-align: center; padding: 40px; color: var(--light-3);">
        <div style="font-size: 48px; margin-bottom: 20px;">ğŸ‘¤</div>
        <div>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø¨Ø¹Ø¯</div>
        <div style="font-size: 14px; margin-top: 10px;">Ø§ÙƒØªØ¨ <b>!${team === 'blue' ? 'Ø§Ø²Ø±Ù‚' : 'Ø§Ø­Ù…Ø±'}</b> ÙÙŠ Ø§Ù„Ø´Ø§Øª Ù„Ù„Ø§Ù†Ø¶Ù…Ø§Ù…</div>
      </div>
    `;
    return;
  }
  
  container.innerHTML = players.map((player, index) => {
    const isCurrent = (player === currentPlayerName);
    const avatarLetter = player.charAt(0).toUpperCase();
    
    return `
      <div class="player-item ${isCurrent ? 'current-turn' : ''}">
        <div class="player-info">
          <div class="player-avatar" style="background: ${team === 'blue' ? 'linear-gradient(135deg, var(--info), var(--info-dark))' : 'linear-gradient(135deg, var(--danger), var(--danger-dark))'}">
            ${avatarLetter}
          </div>
          <div>
            <div class="player-name">${player}</div>
            ${isCurrent ? '<div class="player-turn-indicator">ğŸ® Ø¯ÙˆØ±Ùƒ Ø§Ù„Ø¢Ù†!</div>' : ''}
          </div>
        </div>
        <button class="btn btn-icon" onclick="removePlayer('${team}', ${index})" style="background: rgba(255, 51, 51, 0.2); color: var(--danger);">
          ğŸ—‘ï¸
        </button>
      </div>
    `;
  }).join('');
}

function removePlayer(team, index) {
  let removed;
  if (team === 'blue') {
    removed = bluePlayers.splice(index, 1)[0];
    blueTurnOrder = blueTurnOrder.filter(p => p !== removed);
    delete playerStats[removed];
  } else {
    removed = redPlayers.splice(index, 1)[0];
    redTurnOrder = redTurnOrder.filter(p => p !== removed);
    delete playerStats[removed];
  }
  
  updatePlayerList(team);
  showNotification(`ØªÙ… Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨ ${removed}`, 'info');
}

// Ø§Ù„Ø¬ÙˆÙ„Ø©
function startGame() {
  if (!words.length) {
    showNotification('Ù„Ø§ ØªÙˆØ¬Ø¯ ÙƒÙ„Ù…Ø§Øª ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©!', 'error');
    return;
  }
  
  blueTurnOrder = [...bluePlayers];
  redTurnOrder = [...redPlayers];
  turnIndex = 0;
  
  document.querySelectorAll('#startButton, .btn-primary').forEach(btn => {
    btn.disabled = true;
  });
  
  showNotification('Ø¨Ø¯Ø£Øª Ø§Ù„Ù„Ø¹Ø¨Ø©! ğŸ®', 'success');
  nextTurn();
}

function pickNewWord() {
  if (!words.length) {
    currentAnswer = "";
    document.getElementById("scrambledWord").innerText = "âš ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ ÙƒÙ„Ù…Ø§Øª";
    document.getElementById("answerText").innerText = "â“";
    return;
  }
  
  let available = words.filter(w => !usedWords.includes(w));
  if (available.length === 0) {
    usedWords.length = 0;
    available = words.slice();
  }
  
  const w = available[Math.floor(Math.random() * available.length)];
  usedWords.push(w);
  currentAnswer = w;
  
  const difficulty = getDifficultyLevel(w);
  
  // ØªØ­Ø¯ÙŠØ« Ø´Ø§Ø±Ø© Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØµØ¹ÙˆØ¨Ø©
  document.getElementById('difficultyBadge').innerHTML = `
    ${difficulty.level} | â±ï¸ ${difficulty.time}Ø« | â­ ${difficulty.points} Ù†Ù‚Ø·Ø©
  `;
  
  // ØªØ¹ÙŠÙŠÙ† Ù„ÙˆÙ† Ø§Ù„Ø´Ø§Ø±Ø© Ø­Ø³Ø¨ Ø§Ù„ØµØ¹ÙˆØ¨Ø©
  const badge = document.getElementById('difficultyBadge');
  if (difficulty.level.includes('Ø³Ù‡Ù„')) {
    badge.style.background = 'linear-gradient(135deg, var(--success), var(--success-dark))';
  } else if (difficulty.level.includes('Ù…ØªÙˆØ³Ø·')) {
    badge.style.background = 'linear-gradient(135deg, var(--warning), var(--warning-dark))';
  } else {
    badge.style.background = 'linear-gradient(135deg, var(--danger), var(--danger-dark))';
  }
  
  if (autoTimer) {
    roundSeconds = difficulty.time;
    document.getElementById('roundTime').value = roundSeconds;
  }
  
  // Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø¨Ø¹Ø«Ø±Ø©
  const scrambled = shuffleWord(w);
  const scrambledDisplay = scrambled.split('').join(' ');
  
  document.getElementById("scrambledWord").innerHTML = `
    <div class="word-letters" style="color: ${answeringTeam === 'blue' ? 'var(--info)' : 'var(--danger)'};">
      ${scrambledDisplay}
    </div>
  `;
  
  document.getElementById("answerText").innerText = w;
  document.getElementById("guessResult").innerHTML = "";
  
  // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
  updateTimerDisplay();
}

function nextTurn() {
  stopTimer();
  document.getElementById("timerDisplay").innerText = "â° 00:00";
  document.getElementById("progressFill").style.width = "100%";
  
  if (blueTurnOrder.length === 0 || redTurnOrder.length === 0) {
    showNotification("ÙŠØ¬Ø¨ ÙˆØ¬ÙˆØ¯ Ù„Ø§Ø¹Ø¨ÙŠÙ† ÙÙŠ ÙƒÙ„Ø§ Ø§Ù„ÙØ±ÙŠÙ‚ÙŠÙ†!", "error");
    document.querySelectorAll('#startButton, .btn-primary').forEach(btn => {
      btn.disabled = false;
    });
    return;
  }
  
  const isBlueTurn = turnIndex % 2 === 0;
  if (isBlueTurn) {
    const i = Math.floor(turnIndex / 2) % blueTurnOrder.length;
    currentPlayerName = blueTurnOrder[i];
    answeringTeam = 'blue';
  } else {
    const i = Math.floor(turnIndex / 2) % redTurnOrder.length;
    currentPlayerName = redTurnOrder[i];
    answeringTeam = 'red';
  }
  
  document.getElementById("currentPlayer").innerHTML = `
    <div style="display: flex; align-items: center; gap: 15px;">
      <div style="font-size: 32px;">ğŸ®</div>
      <div style="text-align: right;">
        <div style="font-size: 20px; font-weight: 700; color: ${answeringTeam === 'blue' ? 'var(--info)' : 'var(--danger)'}">
          ${currentPlayerName}
        </div>
        <div style="font-size: 16px; color: var(--light-3);">
          Ø§Ù„ÙØ±ÙŠÙ‚ ${answeringTeam === 'blue' ? 'ğŸ”µ Ø§Ù„Ø£Ø²Ø±Ù‚' : 'ğŸ”´ Ø§Ù„Ø£Ø­Ù…Ø±'}
        </div>
      </div>
    </div>
  `;
  
  turnIndex++;
  pickNewWord();
  
  updatePlayerList('blue');
  updatePlayerList('red');
  
  if (autoTimer) {
    setTimeout(() => startTimer(), 1000);
  }
  
  // Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø­Ø§Ù„ÙŠ
  showFlashMessage(`ğŸ® Ø¯ÙˆØ± <b>${currentPlayerName}</b> Ø§Ù„Ø¢Ù†!`);
}

// Ø§Ù„ØªÙ„Ù…ÙŠØ­
function useHint() {
  if (!timerRunning && timeLeft === 0) return;
  
  timeLeft = Math.max(0, timeLeft - 5);
  updateTimerDisplay();
  
  const ans = currentAnswer;
  if (ans && ans.length >= 2) {
    const first = ans[0], last = ans[ans.length - 1];
    document.getElementById('guessResult').innerHTML = `
      <div style="background: rgba(0, 153, 255, 0.1); padding: 15px; border-radius: var(--radius-md); border-left: 4px solid var(--info);">
        <div style="display: flex; align-items: center; gap: 10px;">
          <span style="font-size: 24px;">ğŸ’¡</span>
          <div>
            <div style="font-weight: 600; margin-bottom: 5px;">ØªÙ„Ù…ÙŠØ­</div>
            <div>ÙŠØ¨Ø¯Ø£ Ø¨Ù€ <b style="color: var(--success);">${first}</b> ÙˆÙŠÙ†ØªÙ‡ÙŠ Ø¨Ù€ <b style="color: var(--success);">${last}</b></div>
            <div style="color: var(--danger); font-size: 14px; margin-top: 5px;">â±ï¸ -5 Ø«ÙˆØ§Ù†Ù</div>
          </div>
        </div>
      </div>
    `;
    
    showNotification('ØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… ØªÙ„Ù…ÙŠØ­! -5 Ø«ÙˆØ§Ù†Ù', 'info');
  }
}

// Ø§Ù„ØªØ®Ø·ÙŠ
function skipTurn() {
  if (!currentPlayerName) return;
  
  // Ø®ØµÙ… Ù†Ù‚Ø·ØªÙŠÙ† Ù…Ù† Ø§Ù„ÙØ±ÙŠÙ‚
  if (answeringTeam === 'blue') {
    blueScore = Math.max(0, blueScore - 2);
    document.getElementById('blueScore').innerText = blueScore;
    document.getElementById('blueScoreDisplay').innerText = blueScore;
  } else {
    redScore = Math.max(0, redScore - 2);
    document.getElementById('redScore').innerText = redScore;
    document.getElementById('redScoreDisplay').innerText = redScore;
  }
  
  document.getElementById('guessResult').innerHTML = `
    <div style="background: rgba(255, 204, 0, 0.1); padding: 15px; border-radius: var(--radius-md); border-left: 4px solid var(--warning);">
      <div style="display: flex; align-items: center; gap: 10px;">
        <span style="font-size: 24px;">â­ï¸</span>
        <div>
          <div style="font-weight: 600; margin-bottom: 5px;">ØªÙ… ØªØ®Ø·ÙŠ Ø§Ù„Ø¯ÙˆØ±!</div>
          <div><b>${currentPlayerName}</b> ØªØ®Ø·Ù‰ Ø§Ù„Ø¯ÙˆØ±</div>
          <div style="color: var(--danger); font-size: 14px; margin-top: 5px;">-2 Ù†Ù‚Ø·Ø© Ù„Ù„ÙØ±ÙŠÙ‚ ${answeringTeam === 'blue' ? 'Ø§Ù„Ø£Ø²Ø±Ù‚' : 'Ø§Ù„Ø£Ø­Ù…Ø±'}</div>
        </div>
      </div>
    </div>
  `;
  
  showNotification(`ØªÙ… ØªØ®Ø·ÙŠ Ø¯ÙˆØ± ${currentPlayerName}! -2 Ù†Ù‚Ø·Ø©`, 'warning');
  
  // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø¯ÙˆØ± Ø§Ù„ØªØ§Ù„ÙŠ Ø¨Ø¹Ø¯ Ø«Ø§Ù†ÙŠØ©
  setTimeout(() => {
    nextTurn();
  }, 1500);
}

// Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©
function checkAnswer(username, content) {
  if (!timerRunning) return;
  if (username !== currentPlayerName) return;
  
  const ok = normalizeArabic(content) === normalizeArabic(currentAnswer);
  
  if (ok) {
    createConfetti();
    
    document.getElementById("guessResult").innerHTML = `
      <div style="background: rgba(0, 255, 204, 0.1); padding: 15px; border-radius: var(--radius-md); border-left: 4px solid var(--success); animation: pulse 0.5s;">
        <div style="display: flex; align-items: center; gap: 10px;">
          <span style="font-size: 24px;">âœ…</span>
          <div>
            <div style="font-weight: 600; margin-bottom: 5px; color: var(--success);">Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©!</div>
            <div><b>${username}</b> Ø£Ø¬Ø§Ø¨ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­!</div>
          </div>
        </div>
      </div>
    `;
    
    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Ù‚Ø§Ø· Ø­Ø³Ø¨ Ø§Ù„ØµØ¹ÙˆØ¨Ø©
    const difficulty = getDifficultyLevel(currentAnswer);
    if (answeringTeam === 'red') {
      redScore += difficulty.points;
      document.getElementById("redScore").innerText = redScore;
      document.getElementById("redScoreDisplay").innerText = redScore;
      
      if (redScore >= targetScore) {
        showNotification("ğŸ† Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø­Ù…Ø± ÙØ§Ø²!", "success");
        createConfetti();
        setTimeout(() => resetScores(), 3000);
      }
    } else {
      blueScore += difficulty.points;
      document.getElementById("blueScore").innerText = blueScore;
      document.getElementById("blueScoreDisplay").innerText = blueScore;
      
      if (blueScore >= targetScore) {
        showNotification("ğŸ† Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø²Ø±Ù‚ ÙØ§Ø²!", "success");
        createConfetti();
        setTimeout(() => resetScores(), 3000);
      }
    }
    
    showNotification(`Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©! +${difficulty.points} Ù†Ù‚Ø·Ø©`, 'success');
    
    if (autoNext) {
      setTimeout(() => {
        nextTurn();
      }, 1500);
    }
  } else {
    document.getElementById("guessResult").innerHTML = `
      <div style="background: rgba(255, 51, 51, 0.1); padding: 15px; border-radius: var(--radius-md); border-left: 4px solid var(--danger);">
        <div style="display: flex; align-items: center; gap: 10px;">
          <span style="font-size: 24px;">âŒ</span>
          <div>
            <div style="font-weight: 600; margin-bottom: 5px; color: var(--danger);">Ø¥Ø¬Ø§Ø¨Ø© ØºÙŠØ± ØµØ­ÙŠØ­Ø©</div>
            <div><b>${username}</b>: Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰!</div>
          </div>
        </div>
      </div>
    `;
    
    showNotification('Ø¥Ø¬Ø§Ø¨Ø© ØºÙŠØ± ØµØ­ÙŠØ­Ø©! Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰', 'error');
  }
}

// Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø£Ø®Ø±Ù‰
function toggleAnswer() {
  const el = document.getElementById("answerText");
  el.style.visibility = el.style.visibility === "hidden" ? "visible" : "hidden";
}

function resetScores() {
  blueScore = 0;
  redScore = 0;
  document.getElementById('blueScore').innerText = blueScore;
  document.getElementById('redScore').innerText = redScore;
  document.getElementById('blueScoreDisplay').innerText = blueScore;
  document.getElementById('redScoreDisplay').innerText = redScore;
  
  showNotification('ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù‚Ø§Ø·!', 'info');
}

// Ø§Ù„Ù…ÙˆØ¯Ø§Ù„Ø§Øª
function showControlModal() {
  document.getElementById('modalBackdrop').classList.add('active');
  document.getElementById('controlModal').classList.add('active');
}

function closeControlModal() {
  document.getElementById('modalBackdrop').classList.remove('active');
  document.getElementById('controlModal').classList.remove('active');
}

function showHelp() {
  document.getElementById('modalBackdrop').classList.add('active');
  document.getElementById('helpModal').classList.add('active');
}

function closeHelp() {
  document.getElementById('modalBackdrop').classList.remove('active');
  document.getElementById('helpModal').classList.remove('active');
}

function toggleStats() {
  const modal = document.getElementById('statsModal');
  const backdrop = document.getElementById('modalBackdrop');
  
  if (modal.classList.contains('active')) {
    modal.classList.remove('active');
    backdrop.classList.remove('active');
  } else {
    loadStats();
    showStats();
    modal.classList.add('active');
    backdrop.classList.add('active');
  }
}

function closeStats() {
  document.getElementById('modalBackdrop').classList.remove('active');
  document.getElementById('statsModal').classList.remove('active');
}

// Ø§Ù„Ø´Ø§Øª Ø§Ù„Ù…Ø¤Ù‚Øª
let chatTimeout;
function showFlashMessage(message) {
  const chatFlash = document.getElementById('chatFlash');
  const chatMessages = document.getElementById('chatMessages');
  
  const messageElement = document.createElement('div');
  messageElement.className = 'chat-message';
  messageElement.innerHTML = message;
  
  chatMessages.prepend(messageElement);
  chatFlash.classList.add('active');
  chatFlash.classList.remove('fading');
  
  // Ø­Ø°Ù Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
  if (chatMessages.children.length > 3) {
    chatMessages.removeChild(chatMessages.lastChild);
  }
  
  // Ø¥Ø®ÙØ§Ø¡ Ø¨Ø¹Ø¯ Ø«Ø§Ù†ÙŠØªÙŠÙ†
  clearTimeout(chatTimeout);
  chatTimeout = setTimeout(() => {
    chatFlash.classList.add('fading');
    setTimeout(() => {
      chatFlash.classList.remove('active');
      chatMessages.innerHTML = '';
    }, 300);
  }, 2000);
}

// Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
function updatePlayerStats(username, correct) {
  if (!playerStats[username]) {
    playerStats[username] = {
      correct: 0,
      wrong: 0,
      total: 0,
      score: 0,
      team: bluePlayers.includes(username) ? 'blue' : 'red'
    };
  }
  
  playerStats[username].total++;
  if (correct) {
    playerStats[username].correct++;
    const difficulty = getDifficultyLevel(currentAnswer);
    playerStats[username].score += difficulty.points;
  } else {
    playerStats[username].wrong++;
  }
  
  saveStats();
}

function saveStats() {
  localStorage.setItem('wm_playerStats', JSON.stringify(playerStats));
}

function loadStats() {
  try {
    const saved = JSON.parse(localStorage.getItem('wm_playerStats') || '{}');
    Object.assign(playerStats, saved);
  } catch (e) {
    console.log("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª:", e);
  }
}

function showStats() {
  const statsContainer = document.getElementById('statsContent');
  const allPlayers = [...new Set([...bluePlayers, ...redPlayers])];
  
  if (allPlayers.length === 0) {
    statsContainer.innerHTML = `
      <div style="text-align: center; padding: 60px; color: var(--light-3);">
        <div style="font-size: 64px; margin-bottom: 20px;">ğŸ“Š</div>
        <div style="font-size: 20px; margin-bottom: 10px;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø¨Ø¹Ø¯</div>
        <div>Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨Ø© ÙˆØ³Ø¬Ù„ Ø§Ù„Ù†Ù‚Ø§Ø·!</div>
      </div>
    `;
    return;
  }
  
  // ØªØ±ØªÙŠØ¨ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø­Ø³Ø¨ Ø§Ù„Ù†Ù‚Ø§Ø·
  const sortedPlayers = allPlayers.sort((a, b) => {
    const scoreA = playerStats[a]?.score || 0;
    const scoreB = playerStats[b]?.score || 0;
    return scoreB - scoreA;
  });
  
  statsContainer.innerHTML = `
    <div class="grid grid-3" style="gap: 20px;">
      ${sortedPlayers.map((player, index) => {
        const stat = playerStats[player] || {
          correct: 0,
          wrong: 0,
          total: 0,
          score: 0,
          team: 'none'
        };
        
        const accuracy = stat.total > 0 ? Math.round((stat.correct / stat.total) * 100) : 0;
        const teamColor = stat.team === 'blue' ? 'var(--info)' : stat.team === 'red' ? 'var(--danger)' : '#aaa';
        const rank = index + 1;
        
        return `
          <div class="card" style="border-color: ${teamColor};">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
              <div>
                <div style="font-size: 12px; color: var(--light-3);">Ø§Ù„ØªØ±ØªÙŠØ¨</div>
                <div style="font-size: 32px; font-weight: 800; color: ${teamColor};">#${rank}</div>
              </div>
              <div style="text-align: right;">
                <div style="font-size: 20px; font-weight: 700; color: ${teamColor};">${player}</div>
                <div style="font-size: 14px; color: var(--light-3);">Ø§Ù„ÙØ±ÙŠÙ‚ ${stat.team === 'blue' ? 'ğŸ”µ Ø§Ù„Ø£Ø²Ø±Ù‚' : stat.team === 'red' ? 'ğŸ”´ Ø§Ù„Ø£Ø­Ù…Ø±' : 'âšª'}</div>
              </div>
            </div>
            
            <div style="margin-bottom: 15px;">
              <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                <span style="color: var(--light-3);">âœ… ØµØ­ÙŠØ­:</span>
                <span style="color: var(--success); font-weight: 600;">${stat.correct}</span>
              </div>
              <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                <span style="color: var(--light-3);">âŒ Ø®Ø·Ø£:</span>
                <span style="color: var(--danger); font-weight: 600;">${stat.wrong}</span>
              </div>
              <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                <span style="color: var(--light-3);">ğŸ¯ Ø§Ù„Ø¯Ù‚Ø©:</span>
                <span style="color: var(--warning); font-weight: 600;">${accuracy}%</span>
              </div>
              <div style="display: flex; justify-content: space-between;">
                <span style="color: var(--light-3);">â­ Ø§Ù„Ù†Ù‚Ø§Ø·:</span>
                <span style="color: #ffcc00; font-weight: 600; font-size: 18px;">${stat.score}</span>
              </div>
            </div>
            
            <div style="background: rgba(255, 255, 255, 0.05); height: 8px; border-radius: var(--radius-full); overflow: hidden; margin-top: 15px;">
              <div style="height: 100%; background: linear-gradient(90deg, var(--success), #00cc99); width: ${accuracy}%; transition: width 1s ease;"></div>
            </div>
          </div>
        `;
      }).join('')}
    </div>
  `;
}

// Ù…Ø¹Ø§Ù„Ø¬Ø© Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø´Ø§Øª
function handleChatMessage(username, content) {
  content = content.trim();
  const command = content.split(' ')[0];
  
  if (content === "!Ø§Ø²Ø±Ù‚") {
    if (!bluePlayers.includes(username)) {
      bluePlayers.push(username);
      blueTurnOrder.push(username);
      updatePlayerList("blue");
      showFlashMessage(`ğŸ® <b style="color: var(--info);">${username}</b> Ø§Ù†Ø¶Ù… Ø¥Ù„Ù‰ Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø²Ø±Ù‚!`);
      showNotification(`${username} Ø§Ù†Ø¶Ù… Ù„Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø²Ø±Ù‚`, 'info');
    }
  } else if (content === "!Ø§Ø­Ù…Ø±") {
    if (!redPlayers.includes(username)) {
      redPlayers.push(username);
      redTurnOrder.push(username);
      updatePlayerList("red");
      showFlashMessage(`ğŸ® <b style="color: var(--danger);">${username}</b> Ø§Ù†Ø¶Ù… Ø¥Ù„Ù‰ Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø­Ù…Ø±!`);
      showNotification(`${username} Ø§Ù†Ø¶Ù… Ù„Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø­Ù…Ø±`, 'info');
    }
  } else if (content === "!Ù†Ù‚Ø§Ø·ÙŠ") {
    const stat = playerStats[username] || { score: 0 };
    showFlashMessage(`â­ <b>${username}</b>: Ù„Ø¯ÙŠÙƒ <b style="color: #ffcc00;">${stat.score}</b> Ù†Ù‚Ø·Ø©`);
  } else if (content === "!ØªØ±ØªÙŠØ¨ÙŠ") {
    if (bluePlayers.includes(username)) {
      const index = blueTurnOrder.indexOf(username);
      showFlashMessage(`ğŸ”µ <b>${username}</b>: ØªØ±ØªÙŠØ¨Ùƒ ÙÙŠ Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø²Ø±Ù‚ Ù‡Ùˆ <b>${index + 1}</b>`);
    } else if (redPlayers.includes(username)) {
      const index = redTurnOrder.indexOf(username);
      showFlashMessage(`ğŸ”´ <b>${username}</b>: ØªØ±ØªÙŠØ¨Ùƒ ÙÙŠ Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø­Ù…Ø± Ù‡Ùˆ <b>${index + 1}</b>`);
    }
  } else if (content.startsWith("!ØªØ­Ø¯ÙŠ @")) {
    const target = content.replace("!ØªØ­Ø¯ÙŠ @", "").trim();
    if (bluePlayers.includes(target) || redPlayers.includes(target)) {
      showFlashMessage(`âš”ï¸ <b>${username}</b> ÙŠØªØ­Ø¯Ù‰ <b>${target}</b> ÙÙŠ Ø§Ù„Ø¬ÙˆÙ„Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©!`);
      showNotification(`${username} ÙŠØªØ­Ø¯Ù‰ ${target}!`, 'warning');
    }
  } else if (timerRunning && username === currentPlayerName) {
    if (normalizeArabic(content) === normalizeArabic(currentAnswer)) {
      updatePlayerStats(username, true);
      checkAnswer(username, content);
    } else {
      updatePlayerStats(username, false);
      showFlashMessage(`âŒ <b>${username}</b>: Ø¥Ø¬Ø§Ø¨Ø© ØºÙŠØ± ØµØ­ÙŠØ­Ø©!`);
    }
  }
}

// Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø´Ø§Øª
function connectChat() {
  const platform = document.getElementById("platformSelect").value;
  const channel = document.getElementById("channelInput").value.trim();
  const remember = document.getElementById("rememberMe").checked;
  const statusDisplay = document.getElementById("statusDisplay");
  
  if (!channel) {
    showNotification("Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ù‚Ù†Ø§Ø© Ø£ÙˆÙ„Ø§Ù‹!", "error");
    return;
  }
  
  // Ø­ÙØ¸ Ø§Ù„Ù‚Ù†Ø§Ø© Ø¥Ø°Ø§ Ø·Ù„Ø¨ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
  if (remember) {
    localStorage.setItem('wm_saved_channel', channel);
  }
  
  // Ù‚Ø·Ø¹ Ø§Ù„Ø§ØªØµØ§Ù„ Ø§Ù„Ø³Ø§Ø¨Ù‚
  if (twitchClient) {
    try { twitchClient.disconnect(); } catch (e) {}
  }
  if (kickSocket) {
    try { kickSocket.close(); } catch (e) {}
  }
  
  statusDisplay.innerHTML = '<span>ğŸ”„</span> Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„...';
  statusDisplay.className = 'status-chip';
  
  if (platform === "twitch") {
    twitchClient = new tmi.Client({
      connection: { reconnect: true, secure: true },
      channels: [channel]
    });
    
    twitchClient.connect().then(() => {
      statusDisplay.innerHTML = '<span>âœ…</span> Ù…ØªØµÙ„ Ø¨Ù€ Twitch';
      statusDisplay.classList.add('connected');
      showNotification(`ØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ù†Ø§Ø© ${channel} Ø¹Ù„Ù‰ Twitch!`, 'success');
      showFlashMessage(`âœ… <b>ØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ Twitch:</b> ${channel}`);
      closeControlModal();
    }).catch((error) => {
      statusDisplay.innerHTML = '<span>âŒ</span> ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„';
      statusDisplay.classList.add('disconnected');
      showNotification(`ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ù†Ø§Ø© ${channel}`, 'error');
    });
    
    twitchClient.on('message', (channel, tags, message, self) => {
      if (self) return;
      const username = tags['display-name'] || tags['username'] || 'Ù…Ø¬Ù‡ÙˆÙ„';
      handleChatMessage(username, message);
    });
    
  } else {
    // Kick API
    (async () => {
      try {
        const res = await fetch(`https://kick.com/api/v2/channels/${channel}`);
        const data = await res.json();
        const roomId = data.chatroom.id;
        
        kickSocket = new WebSocket("wss://ws-us2.pusher.com/app/32cbd69e4b950bf97679?protocol=7&client=js&version=8.4.0-rc2&flash=false");
        
        kickSocket.onopen = () => {
          kickSocket.send(JSON.stringify({
            event: "pusher:subscribe",
            data: { auth: "", channel: `chatrooms.${roomId}.v2` }
          }));
          
          statusDisplay.innerHTML = '<span>âœ…</span> Ù…ØªØµÙ„ Ø¨Ù€ Kick';
          statusDisplay.classList.add('connected');
          showNotification(`ØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ù†Ø§Ø© ${channel} Ø¹Ù„Ù‰ Kick!`, 'success');
          showFlashMessage(`âœ… <b>ØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ Kick:</b> ${channel}`);
          closeControlModal();
        };
        
        kickSocket.onmessage = (event) => {
          const msg = JSON.parse(event.data);
          if (msg.event === "App\\Events\\ChatMessageEvent") {
            const d = JSON.parse(msg.data);
            const username = d.sender?.username || "Ù…Ø¬Ù‡ÙˆÙ„";
            const content = d.content || "";
            handleChatMessage(username, content);
          }
        };
        
        kickSocket.onerror = () => {
          statusDisplay.innerHTML = '<span>âŒ</span> ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„';
          statusDisplay.classList.add('disconnected');
          showNotification(`ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ù†Ø§Ø© ${channel}`, 'error');
        };
        
      } catch (error) {
        statusDisplay.innerHTML = '<span>âŒ</span> ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„';
        statusDisplay.classList.add('disconnected');
        showNotification(`ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ù†Ø§Ø© ${channel}`, 'error');
      }
    })();
  }
}

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
function loadState() {
  try {
    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ù†Ø§Ø© Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
    const savedChannel = localStorage.getItem('wm_saved_channel');
    if (savedChannel) {
      document.getElementById('channelInput').value = savedChannel;
      document.getElementById('rememberMe').checked = true;
    }
    
    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
    const settings = JSON.parse(localStorage.getItem('wm_settings') || '{}');
    if (settings.roundSeconds) {
      roundSeconds = settings.roundSeconds;
      document.getElementById('roundTime').value = roundSeconds;
    }
    if (settings.targetScore) {
      targetScore = settings.targetScore;
      document.getElementById('targetScore').value = targetScore;
    }
    if (typeof settings.autoTimer === 'boolean') {
      autoTimer = settings.autoTimer;
      document.getElementById('autoTimer').checked = autoTimer;
    }
    if (typeof settings.autoNext === 'boolean') {
      autoNext = settings.autoNext;
      document.getElementById('autoNext').checked = autoNext;
    }
    
    loadStats();
    
  } catch (e) {
    console.log("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø­Ø§Ù„Ø©:", e);
  }
}

// Ø§Ø®ØªØµØ§Ø±Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­
document.addEventListener('keydown', (e) => {
  if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;
  
  switch (e.key.toLowerCase()) {
    case ' ':
      e.preventDefault();
      if (timerRunning) stopTimer();
      else startTimer();
      break;
    case 'n':
      nextTurn();
      break;
    case 'h':
      useHint();
      break;
    case 's':
      toggleStats();
      break;
    case 'k':
      skipTurn();
      break;
    case 'escape':
      closeHelp();
      closeStats();
      closeControlModal();
      break;
  }
});

// Ø§Ù„ØªÙ‡ÙŠØ¦Ø©
window.addEventListener('DOMContentLoaded', () => {
  loadState();
  
  // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
  document.querySelectorAll('.section-content').forEach(content => {
    content.style.display = 'grid';
  });
});
</script>
</body>
</html>
