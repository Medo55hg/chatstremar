<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<title>ğŸ¯ Ù„Ø¹Ø¨Ø© Ø®Ù…Ø§Ø³ÙŠØ§Øª</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link href="https://fonts.googleapis.com/css2?family=Amiri&display=swap" rel="stylesheet">
<style>
  :root{ --bg:#111; --panel:#222; --line:#555; --red:#ff3333; --ok:#4caf50; --warn:#f1c40f; --abs:#555; --txt:#fff; --muted:#aaa; }
  body { background: var(--bg); color: var(--txt); font-family: 'Amiri', serif; text-align: center; padding: 20px; }
  h1 { color: var(--red); margin-top: 10px; }
  .topbar{display:flex;gap:10px;justify-content:center;align-items:center;flex-wrap:wrap;margin:10px 0;}
  .pill{background:#1b1b1b;border:1px solid var(--line);padding:8px 12px;border-radius:999px;font-size:14px}
  .btn{background:#2a2a2a;border:1px solid var(--line);padding:8px 12px;border-radius:10px;cursor:pointer}
  .btn:hover{background:#333}
  .description { background: var(--panel); border: 2px solid #444; border-radius: 12px; padding: 14px; font-size: 18px; line-height: 1.6; width: min(92%, 820px); margin: 16px auto; }

  .grid { --cell:60px; display: grid; grid-template-columns: repeat(5, var(--cell)); grid-template-rows: repeat(8, var(--cell)); gap: 6px; justify-content: center; margin: 18px 0; }
  .cell { width: var(--cell); height: var(--cell); background: #333; border: 2px solid var(--line); font-size: 32px; color: var(--txt);
          display: flex; align-items: center; justify-content: center; border-radius:10px; transform-style: preserve-3d; }
  .cell.correct { background: var(--ok); border-color: var(--ok); }
  .cell.present { background: var(--warn); border-color: var(--warn); color: #000; }
  .cell.absent { background: var(--abs); border-color: var(--abs); color: var(--muted); }

  @keyframes shake { 10%,90%{transform:translateX(-3px)} 20%,80%{transform:translateX(3px)}
                     30%,50%,70%{transform:translateX(-6px)} 40%,60%{transform:translateX(6px)}}
  .shake { animation: shake 400ms; }
  @keyframes flip { 0%{transform: rotateX(0)} 50%{transform: rotateX(90deg)} 100%{transform: rotateX(0)} }
  .flip { animation: flip 380ms ease; }

  .statusbar{display:flex;gap:10px;justify-content:center;align-items:center;flex-wrap:wrap;margin:8px 0;}
  .status{background:#191919;border:1px solid var(--line);padding:6px 10px;border-radius:8px;font-size:14px}

  .keyboard-container { display: flex; flex-direction: column; gap: 6px; max-width: 650px; margin: auto; }
  .keyboard-row { display: flex; gap: 6px; justify-content: center; flex-wrap: wrap; }
  .key { min-width: 44px; height: 52px; padding: 0 6px; font-size: 20px; background: #222; color: var(--txt);
         border: 1px solid var(--line); border-radius: 8px; cursor: pointer; user-select: none; display: flex; align-items: center; justify-content: center; }
  .key.correct { background: var(--ok) !important; color: #fff; }
  .key.present { background: var(--warn) !important; color: #000; }
  .key.absent { background: var(--abs) !important; color: var(--muted); }
  .key:hover { background: #333; }
  .key-enter { background: #28a745 !important; color: #fff; }
  .key-backspace { background: #c0392b !important; color: #fff; }

  .message { margin-top: 10px; font-size: 16px; color: #0f0; min-height: 22px; }
  .summary { margin-top: 20px; }
  .summary-grid { display: inline-grid; grid-template-columns: repeat(5, 30px); grid-template-rows: repeat(8, 30px); gap: 3px; margin: 10px; }
  .summary-cell { width:30px; height:30px; font-size:18px; border:1px solid var(--line); display:flex; align-items:center; justify-content:center; border-radius:6px; }
  .summary-cell.correct { background: var(--ok); }
  .summary-cell.present { background: var(--warn); color:#000; }
  .summary-cell.absent { background: var(--abs); color: var(--muted); }

  .stats{background:#181818;border:1px solid var(--line);border-radius:12px;padding:10px; width:min(92%,820px); margin:14px auto; text-align:center}
  .stats h3{margin:0 0 8px 0;color:#eee}
  .stats .row{display:flex;gap:10px;justify-content:center;flex-wrap:wrap}
  .stats .chip{background:#202020;border:1px solid var(--line);border-radius:10px;padding:6px 10px;font-size:14px}

  @media (max-width: 480px){
    .grid{ --cell: 46px; gap:5px }
    .cell{ font-size:24px }
    .keyboard-container{ max-width: 96% }
    .key{ min-width: 36px; height: 44px; font-size:18px }
    .description{ font-size:16px; }
  }
  @media (max-width: 380px){
    .grid{ --cell: 42px }
    .key{ min-width: 32px; height: 40px; font-size:16px }
  }
</style>
</head>
<body>
  <h1>ğŸ¯ Ø®Ù…Ø§Ø³ÙŠØ§Øª</h1>

  <div class="topbar">
    <div class="pill" id="daySeedPill">Ø§Ù„ÙŠÙˆÙ…: â€”</div>
    <div class="pill" id="categoryPill">Ø§Ù„ÙØ¦Ø©: â€”</div>
    <div class="pill" id="countdown">â³ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: â€”</div>
    <button class="btn" id="hintBtn" title="ØªÙ„Ù…ÙŠØ­ (Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© ÙŠÙˆÙ…ÙŠÙ‹Ø§)">ğŸ’¡ ØªÙ„Ù…ÙŠØ­</button>
    <button class="btn" id="copyResultBtn" title="Ù†Ø³Ø® Ø§Ù„Ù…Ù„Ø®Øµ Ù„Ù„Ù†Ø´Ø±">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ù…Ù„Ø®Øµ</button>
  </div>

  <div class="description">
    ğŸ§  <strong>Ø´Ø±Ø­ Ø§Ù„Ù„Ø¹Ø¨Ø©:</strong><br>
    ÙƒÙ„ ÙŠÙˆÙ… 3 ÙƒÙ„Ù…Ø§Øª Ù…Ù† ÙØ¦Ø© Ù…Ø­Ø¯Ø¯Ø© â€” Ù„Ø¯ÙŠÙƒ 8 Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ù„ÙƒÙ„ ÙƒÙ„Ù…Ø© (5 Ø­Ø±ÙˆÙ).<br>
    ğŸŸ© Ø­Ø±Ù ØµØ­ÙŠØ­ Ø¨Ù…ÙƒØ§Ù†Ù‡ â€” ğŸŸ¨ Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ù…ÙƒØ§Ù† Ø¢Ø®Ø± â€” â¬› ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯. Ù„Ø¯ÙŠÙƒ <b>ØªÙ„Ù…ÙŠØ­ ÙˆØ§Ø­Ø¯ ÙŠÙˆÙ…ÙŠÙ‹Ø§</b>.
  </div>

  <div class="statusbar">
    <div class="status" id="attemptStatus">Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©: 1 / 8</div>
    <div class="status" id="bestStatus">Ø£ÙØ¶Ù„ Ù†ØªÙŠØ¬Ø© Ø§Ù„ÙŠÙˆÙ…: â€”</div>
  </div>

  <div id="summary" class="summary"></div>

  <div class="game-container">
    <div id="correctAnswer" class="message" style="color:#0ff; text-align:right;"></div>
    <div id="grid" class="grid"></div>

    <div class="keyboard-container">
      <div class="keyboard-row" id="row1"></div>
      <div class="keyboard-row" id="row2"></div>
      <div class="keyboard-row" id="row3"></div>
      <div class="keyboard-row">
        <div class="key key-backspace" onclick="handleBackspace()">âŒ«</div>
        <div class="key key-enter" onclick="handleEnter()">â</div>
      </div>
    </div>

    <div class="message" id="messageBox"></div>
  </div>

  <div class="stats" id="statsBox" style="display:none;">
    <h3>ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ÙŠÙˆÙ…</h3>
    <div class="row" id="statsChips"></div>
  </div>

<script>
/* =========================
   Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ø§Ù…Ø©
   ========================= */
const REQUIRE_DICTIONARY = false; // ÙŠÙ‚Ø¨Ù„ Ø£ÙŠ ÙƒÙ„Ù…Ø© 5 Ø£Ø­Ø±Ù
const WORD_LEN = 5;
const MAX_ROWS = 8;

/* =========================
   Ù‚Ø§Ù…ÙˆØ³ ÙƒØ¨ÙŠØ± Ù…Ø¯Ù…Ø¬ (426 ÙƒÙ„Ù…Ø© Ø®Ù…Ø³ÙŠØ©)
   ========================= */
const WORDS5_LARGE = [
  "Ø¥Ø´Ø§Ø±Ø©",
  "Ø¥ÙØ§Ø¯Ø©",
  "Ø¨Ø§Ø¨Ù†Ø§",
  "Ø¨Ø§Ø¨Ù‡Ø§",
  "Ø¨Ø§Ø¨Ù‡Ù…",
  "Ø¨Ø­Ø±Ù†Ø§",
  "Ø¨Ø­Ø±Ù‡Ø§",
  "Ø¨Ø­Ø±Ù‡Ù…",
  "Ø¨Ø±Ù‚Ù†Ø§",
  "Ø¨Ø±Ù‚Ù‡Ø§",
  "Ø¨Ø±Ù‚Ù‡Ù…",
  "Ø¨Ø·Ø§Ù‚Ø©",
  "Ø¨Ø·Ù†Ù†Ø§",
  "Ø¨Ø·Ù†Ù‡Ø§",
  "Ø¨Ø·Ù†Ù‡Ù…",
  "Ø¨Ù†ØªÙ†Ø§",
  "Ø¨Ù†ØªÙ‡Ø§",
  "Ø¨Ù†ØªÙ‡Ù…",
  "Ø¨ÙˆØ§Ø¨Ø©",
  "Ø¨ÙŠØªÙ†Ø§",
  "Ø¨ÙŠØªÙ‡Ø§",
  "Ø¨ÙŠØªÙ‡Ù…",
  "ØªØ§Ø¬Ù‡Ø§",
  "ØªØ§Ø¬Ù‡Ù…",
  "ØªÙØ§Ø­",
  "ØªÙ‚Ø±ÙŠØ±",
  "ØªØ±ØªÙŠØ¨",
  "ØªØ³Ù„ÙŠÙ…",
  "ØªØ¯Ø±ÙŠØ¨",
  "ØªØ¹Ø§ÙŠØ´",
  "ØªØ¨Ø§Ø¯Ù„",
  "Ø«ÙŠØ§Ø¨Ùƒ",
  "Ø¬Ø¨Ø§Ù„",
  "Ø¬Ø²ÙŠØ±Ø©",
  "Ø¬Ø³Ø±Ùƒ",
  "Ø¬Ø³Ø±Ù‡Ø§",
  "Ø¬Ø³Ø±Ù‡Ù…",
  "Ø¬Ù…Ø§Ø¹Ø©",
  "Ø¬Ù…ÙŠÙ„Ø©",
  "Ø¬Ù†ÙˆØ¨",
  "Ø¬ÙˆØ§Ø¦Ø²",
  "Ø¬ÙˆØ§Ù„",
  "Ø¬Ù„ÙˆØ³",
  "Ø­Ø¯ÙŠÙ‚Ø©",
  "Ø­Ø¯ÙˆØ¯Ùƒ",
  "Ø­Ø¯ÙˆØ¯Ù‡",
  "Ø­ÙƒØ§ÙŠØ©",
  "Ø­Ø±Ø§Ø³Ø©",
  "Ø­Ù‚ÙŠÙ‚Ø©",
  "Ø­ØµÙŠÙ„Ø©",
  "Ø­ÙŠØ§Ø©",
  "Ø­ÙŠØ§Ø©ÙŒ",
  "Ø®Ø±ÙŠØ·Ø©",
  "Ø®ÙŠÙ…Ø©",
  "Ø¯Ø±ÙˆØ³",
  "Ø¯ÙØªØ±Ùƒ",
  "Ø¯Ù‚ÙŠÙ‚Ø©",
  "Ø¯Ù„ÙŠÙ„Ùƒ",
  "Ø¯Ø¹Ø§ÙˆÙ‰",
  "Ø°Ù‡Ø¨Ùƒ",
  "Ø°Ù‡Ø¨Ù‡Ø§",
  "Ø°Ù‡Ø¨Ù‡Ù…",
  "Ø°Ù‡Ø¨Ù†Ø§",
  "Ø±Ø¦ÙŠØ³",
  "Ø±Ø³Ø§Ù„Ø©",
  "Ø±Ø¹Ø¯Ù†Ø§",
  "Ø±Ø¹Ø¯Ù‡Ø§",
  "Ø±Ø¹Ø¯Ù‡Ù…",
  "Ø±ÙˆØ§ÙŠØ©",
  "Ø±ÙŠØ§Ø­",
  "Ø²Ù‡Ø±Ù‡",
  "Ø²Ù‡Ø±Ù‡Ù",
  "Ø³Ø§Ø­Ø§Øª",
  "Ø³ÙÙŠÙ†Ø©",
  "Ø³Ù„Ø§Ù…Ø©",
  "Ø³Ù„Ø§Ù„Ø©",
  "Ø³Ù…Ø§Ùƒ",
  "Ø³Ù…Ø§Ù‡Ø§",
  "Ø³Ù…Ø§Ù‡Ù…",
  "Ø³Ù…Ø§ÙŠ",
  "Ø³Ù…Ø§Ø¹",
  "Ø³ÙˆÙ‚Ùƒ",
  "Ø³ÙˆÙ‚Ù‡Ø§",
  "Ø³ÙˆÙ‚Ù‡Ù…",
  "Ø³ÙˆÙ‚Ù†Ø§",
  "Ø³ÙŠØ§Ø±Ø©",
  "Ø³ÙŠØ§Ù‚",
  "Ø³ÙŠØ§Ù‚Ùƒ",
  "Ø³ÙŠØ§Ù‚Ù‡Ø§",
  "Ø³ÙŠØ§Ù‚Ù‡Ù…",
  "Ø³ØªØ§Ø¦Ø±",
  "Ø³Ø¬Ù„Ø§Øª",
  "Ø´Ù‡Ø§Ø¯Ø©",
  "Ø´Ø¬Ø§Ø¹Ø©",
  "Ø´Ø·Ø§Ø¦Ø±",
  "Ø´Ø±ÙŠØ¹Ø©",
  "Ø´Ø±ÙŠÙƒØ©",
  "Ø´Ù…Ø³Ùƒ",
  "Ø´Ù…Ø³Ù‡Ø§",
  "Ø´Ù…Ø³Ù‡Ù…",
  "Ø´Ù…Ø³Ù†Ø§",
  "Ø´Ù…Ø³ÙŒ",
  "ØµØ¨ÙŠØ§Ù†",
  "ØµØ¯Ø±Ùƒ",
  "ØµØ¯Ø±Ù‡Ø§",
  "ØµØ¯Ø±Ù‡Ù…",
  "ØµØ¯Ø§Ù‚Ø©",
  "ØµÙ†Ø§Ø¹Ø©",
  "ØµØ±Ø§Ø­Ø©",
  "ØµÙŠØ§Ù†Ø©",
  "ØµÙˆØ±Ø©",
  "ØµÙˆØ±Ø©Ù",
  "ØµÙˆØ±Ùƒ",
  "ØµÙˆØ±Ù‡Ù…",
  "ØµÙˆØ§Ø¹Ù‚",
  "ØµÙŠØºØ©",
  "Ø¶Ø¨Ø§Ø¨",
  "Ø¶Ø¨Ø§Ø¨ÙŠ",
  "Ø¶Ø±Ø¨Ø§Øª",
  "Ø¶Ù…Ø§Ù†Ùƒ",
  "Ø¶ÙˆØ§Ø¨Ø·",
  "Ø·Ø§Ø¦Ø±Ø©",
  "Ø·Ø§Ø¨Ù‚",
  "Ø·Ø±ÙŠÙ‚",
  "Ø·Ø±ÙŠÙ‚Ø§",
  "Ø·Ø±ÙŠÙ‚Ùƒ",
  "Ø·Ø±ÙŠÙ‚Ù‡",
  "Ø·Ù…Ø§Ø·Ù…",
  "Ø·Ù„Ø¨Ùƒ",
  "Ø·Ù„Ø¨Ù‡Ø§",
  "Ø·Ù„Ø¨Ù‡Ù…",
  "Ø·Ù„Ø¨Ù†Ø§",
  "Ø·Ù„Ø¨Ø§Øª",
  "Ø·Ø¨ÙŠØ¹ÙŠ",
  "Ø¸Ù„Ø§Ù„",
  "Ø¸Ù„Ø§Ù„Ùƒ",
  "Ø¸Ù†ÙˆÙ†",
  "Ø¹Ø°ÙˆØ¨Ø©",
  "Ø¹ÙˆØ§Ù…Ù„",
  "Ø¹Ù†Ø§ØµØ±",
  "Ø¹Ù†Ø§ÙŠØ©",
  "Ø¹ÙˆØ§Ø·Ù",
  "Ø¹ÙˆØ§ØµÙ",
  "Ø¹ÙŠÙ†Ùƒ",
  "Ø¹ÙŠÙ†Ù‡Ø§",
  "Ø¹ÙŠÙ†Ù‡Ù…",
  "ØºØ±ÙØ©",
  "ØºØ±ÙØªÙƒ",
  "ØºØ±Ø§Ù…Ø©",
  "ØºÙ†Ø§Ø¦Ù…",
  "ØºÙ†ÙŠÙ…Ø©",
  "ØºÙ„Ø§ÙÙƒ",
  "ØºØ³Ø§Ù„Ø©",
  "ÙØ§Ø¦Ø¯Ø©",
  "ÙØ¶Ø§Ø¦Ù„",
  "ÙØµÙˆÙ„Ùƒ",
  "ÙÙƒØ§Ù‡Ø©",
  "ÙÙˆØ§ÙƒÙ‡",
  "ÙØµØ§Ø¦Ù„",
  "ÙØ¬Ø±Ù†Ø§",
  "ÙØ¬Ø±Ù‡Ø§",
  "ÙØ¬Ø±Ù‡Ù…",
  "ÙÙ…Ùƒ",
  "ÙÙ…Ù‡Ø§",
  "ÙÙ…Ù‡Ù…",
  "Ù‚Ø§Ø¦Ù…Ø©",
  "Ù‚Ø§Ø¶ÙŠÙ‡",
  "Ù‚Ø§Ø¶ÙŠÙƒ",
  "Ù‚Ø§Ø±Ø¨Ùƒ",
  "Ù‚Ø§Ø±Ø¨Ù‡Ø§",
  "Ù‚Ø§Ø±Ø¨Ù‡Ù…",
  "Ù‚Ø¨Ø±Ùƒ",
  "Ù‚Ø¨Ø±Ù‡Ø§",
  "Ù‚Ø¨Ø±Ù‡Ù…",
  "Ù‚Ø¯Ø±Ø§Øª",
  "Ù‚Ù„Ø¨Ùƒ",
  "Ù‚Ù„Ø¨Ù‡Ø§",
  "Ù‚Ù„Ø¨Ù‡Ù…",
  "Ù‚Ù„Ù…Ùƒ",
  "Ù‚Ù„Ù…Ù‡Ø§",
  "Ù‚Ù„Ù…Ù‡Ù…",
  "Ù‚Ù…ÙŠØµ",
  "Ù‚ÙŠÙ…Ø©",
  "Ù‚ÙŠÙ…Ø©ÙŒ",
  "ÙƒØ§ØªØ¨Ù‡",
  "ÙƒØ§ØªØ¨Ùƒ",
  "ÙƒØ§ØªØ¨Ù‡Ø§",
  "ÙƒØªØ§Ø¨",
  "ÙƒØªØ§Ø¨Ùƒ",
  "ÙƒØªØ§Ø¨Ù‡Ø§",
  "ÙƒØªØ§Ø¨Ù‡Ù…",
  "ÙƒØªØ§Ø¨Ù‡",
  "ÙƒØªØ§Ø¦Ø¨",
  "ÙƒØ±Ø§Ù…Ø©",
  "ÙƒØ±Ø³ÙŠ",
  "ÙƒÙØ§Ù„Ø©",
  "ÙƒÙØ§Ø¡Ø©",
  "ÙƒÙ„Ù…Ø§Øª",
  "ÙƒÙ†ÙŠØ³Ø©",
  "ÙƒÙˆØ®Ùƒ",
  "ÙƒÙˆØ®Ù‡Ø§",
  "ÙƒÙˆØ®Ù‡Ù…",
  "ÙƒÙˆØ®Ù†Ø§",
  "Ù„ÙˆØ­Ø©",
  "Ù„ÙˆØ­Ø©Ù",
  "Ù„ÙˆØ­Ø§Øª",
  "Ù„ÙˆØ§Ø²Ù…",
  "Ù„Ù…Ø­Ø§Øª",
  "Ù„Ø­Ø¸Ø§Øª",
  "Ù…Ø¯ÙŠÙ†Ø©",
  "Ù…Ø¹Ø¨Ø¯",
  "Ù…ÙØªØ§Ø­",
  "Ù…ØµØ¨Ø§Ø­",
  "Ù…Ø·Ø§Ø±Ùƒ",
  "Ù…Ø·Ø¹Ù…",
  "Ù…ÙƒØªØ¨Ùƒ",
  "Ù…ÙƒØªØ¨Ø©",
  "Ù…Ù„Ø§Ø¹Ø¨",
  "Ù…Ù„Ø§Ø¨Ø³",
  "Ù…Ù„Ø¹Ø¨",
  "Ù…Ù„Ø¹Ø¨Ùƒ",
  "Ù…Ù„Ø¹Ø¨Ù‡",
  "Ù…Ù†Ø§Ø²Ù„",
  "Ù…Ø±Ø§Ø­Ù„",
  "Ù…Ø¯Ø§Ø±Ø³",
  "Ù…Ø±Ø§Ø³Ù…",
  "Ù…Ù†Ø§Ø²Ù„",
  "Ù…Ù†Ø§ÙˆØ±",
  "Ù…Ù†Ø§Ø®",
  "Ù…Ù†Ø§Ø±Ø©",
  "Ù…ÙŠÙ†Ø§Ùƒ",
  "Ù…ÙŠÙ†Ø§Ø¡",
  "Ù…Ø³Ø§Ø±",
  "Ù…Ø´Ø§Ø¹Ø±",
  "Ù…ÙØ§ØªÙŠØ­",
  "Ù…Ø±Ø§Ø­Ù„",
  "Ù…Ù…Ø§Ù„Ùƒ",
  "Ù…ÙˆØ§Ø³Ù…",
  "Ù…Ø·Ø¨Ø®",
  "Ù…ÙƒØªØ¨",
  "Ù…ÙŠØ¯Ø§Ù†",
  "Ù…ÙŠØ¯Ø§Ù†Ùƒ",
  "Ù…Ø®Ø²Ù†",
  "Ù…Ø®Ø²Ù†Ù‡",
  "Ù…Ø³Ø§Ø¹Ø¯",
  "Ù†Ø§ÙØ°Ø©",
  "Ù†Ø¨Ø§Øª",
  "Ù†Ø¨Ø¶Ùƒ",
  "Ù†Ø¨Ø¶Ù‡Ø§",
  "Ù†Ø¨Ø¶Ù‡Ù…",
  "Ù†Ø¬Ù…Ùƒ",
  "Ù†Ø¬Ù…Ù‡Ø§",
  "Ù†Ø¬Ù…Ù‡Ù…",
  "Ù†Ø¬Ø§Ø­Ùƒ",
  "Ù†Ø¬Ø§Ø­Ù‡",
  "Ù†Ø¬Ø§Ø­ÙŠ",
  "Ù†Ø¬Ø§Ø­Ù‡Ù…",
  "Ù†Ù‡Ø±Ù†Ø§",
  "Ù†Ù‡Ø±Ù‡Ø§",
  "Ù†Ù‡Ø±Ù‡Ù…",
  "Ù†ÙˆØ§Ø­ÙŠ",
  "Ù†Ù‚Ø§Ø´Ùƒ",
  "Ù†Ù‡Ø§Ø±ÙŠØ©",
  "Ù†Ù‡Ø§Ø±ÙŠØ©Ù",
  "Ù†Ù‡Ø§Ø¦ÙŠØ©",
  "Ù†Ø´Ø§Ø·Ùƒ",
  "Ù‡Ø¯Ø§ÙŠØ§",
  "Ù‡ÙˆÙŠØ©",
  "Ù‡ÙˆØ§ØªÙ",
  "Ù‡ÙˆØ§ÙŠØ©",
  "Ù‡ÙˆØ§Ø¬Ø³",
  "ÙˆØ§Ø¯ÙŠ",
  "ÙˆØ§Ø¯ÙŠÙ‡",
  "ÙˆØ§Ø¯ÙŠÙƒ",
  "ÙˆØ±Ù‚Ø©",
  "ÙˆØ±Ø§Ø«Ø©",
  "ÙˆØ±Ø¯Ø©",
  "ÙˆØ¬Ø¨Ø§Øª",
  "ÙˆØ¬Ù‡Ùƒ",
  "ÙˆØ¬Ù‡Ù‡Ø§",
  "ÙˆØ¬Ù‡Ù‡Ù…",
  "ÙˆØ«Ø§Ø¦Ù‚",
  "ÙˆØ«ÙŠÙ‚Ø©",
  "ÙˆØ³Ø§Ø¦Ù„",
  "ÙˆØ­Ø¯Ø§Øª",
  "ÙˆÙ‚Ø§Ø¦Ø¹",
  "ÙˆÙ„Ø§Ø¯Ø©",
  "ÙŠÙ‚ÙŠÙ†Ùƒ",
  "ÙŠÙ…Ø§Ù…Ø©",
  "ÙŠÙ…Ù†ÙŠØ©",
  "ÙŠÙˆØ³ÙÙŠ",
  "Ø±Ø¬Ù„Ù†Ø§",
  "Ø±Ø¬Ù„Ù‡Ø§",
  "Ø±Ø¬Ù„Ù‡Ù…",
  "Ø·ÙÙ„Ù†Ø§",
  "Ø·ÙÙ„Ù‡Ø§",
  "Ø·ÙÙ„Ù‡Ù…",
  "ØµØ¨ÙŠØ§Ù†",
  "Ø¨Ù†ØªÙ†Ø§",
  "Ø¨Ù†ØªÙ‡Ø§",
  "Ø¨Ù†ØªÙ‡Ù…",
  "Ù‚Ù…Ø±Ù†Ø§",
  "Ù‚Ù…Ø±Ù‡Ø§",
  "Ù‚Ù…Ø±Ù‡Ù…",
  "Ø´Ù…Ø³Ù†Ø§",
  "Ø´Ù…Ø³Ù‡Ø§",
  "Ø´Ù…Ø³Ù‡Ù…",
  "Ù†ÙˆØ±Ù†Ø§",
  "Ù†ÙˆØ±Ù‡Ø§",
  "Ù†ÙˆØ±Ù‡Ù…",
  "ÙˆØ±Ø¯Ùƒ",
  "ÙˆØ±Ø¯Ù‡Ø§",
  "ÙˆØ±Ø¯Ù‡Ù…",
  "Ù‚ÙˆØ³Ùƒ",
  "Ù‚ÙˆØ³Ù‡Ø§",
  "Ù‚ÙˆØ³Ù‡Ù…",
  "ØµÙˆØªÙƒ",
  "ØµÙˆØªÙ‡Ø§",
  "ØµÙˆØªÙ‡Ù…",
  "Ø¨Ø§Ø¨Ùƒ",
  "Ø¨Ø§Ø¨Ù‡Ø§",
  "Ø¨Ø§Ø¨Ù‡Ù…",
  "Ø¨Ø§Ø¨Ù†Ø§",
  "Ø¨ÙŠØªÙÙƒ",
  "Ø¨ÙŠØªÙÙƒ",
  "Ø¨ÙŠØªÙ‡Ù…",
  "Ø¨ÙŠØªÙ‡Ø§",
  "Ø¨ÙŠØªÙ†Ø§",
  "Ù‚ØµØ±Ù",
  "Ù‚ØµØ±Ù†Ø§",
  "Ù‚ØµØ±Ù‡Ø§",
  "Ù‚ØµØ±Ù‡Ù…",
  "Ù‚Ø§Ù†ÙˆÙ†",
  "Ù‚ÙˆØ§Ù†ÙŠÙ†",
  "ÙˆØ²ÙŠØ±Ùƒ",
  "ÙˆØ²ÙŠØ±Ù‡",
  "Ù‚Ø§Ø¶ÙŠÙƒ",
  "Ù‚Ø§Ø¶ÙŠÙ‡",
  "Ø·Ù„Ø§Ø¨Ùƒ",
  "Ø·Ù„Ø§Ø¨Ù‡Ø§",
  "Ø·Ù„Ø§Ø¨Ù‡Ù…",
  "Ù‚Ø§Ø±Ø¦Ùƒ",
  "Ù‚Ø§Ø±Ø¦Ù‡",
  "Ù‚Ø§Ø±Ø¦Ù‡Ø§",
  "Ù‚Ø§Ø±Ø¦",
  "Ù‚Ø§Ø±ÙŠ",
  "ÙƒØ§ØªØ¨",
  "ÙƒØ§ØªØ¨Ùƒ",
  "ÙƒØ§ØªØ¨Ù‡",
  "ÙƒØ§ØªØ¨Ù‡Ø§",
  "Ù‚Ø§Ø±Ø¦",
  "Ù‚Ø§Ø±ÙŠ",
  "Ù‚Ù‡ÙˆØ©",
  "Ø´Ø§ÙŠÙŒ",
  "Ù…Ø§Ø¡ÙŒ",
  "Ø¹Ø¯ÙˆÙŒ",
  "ØµØ¯ÙŠÙ‚",
  "Ù‚Ù…ÙŠØµ",
  "Ø«ÙŠØ§Ø¨",
  "Ù…Ù„Ø§Ø¨Ø³",
  "Ù…Ù„Ø¹Ø¨",
  "Ø¯ÙØªØ±",
  "ÙƒØªØ§Ø¨",
  "ÙƒØªØ§Ø¨Ùƒ",
  "Ù…ÙƒØªØ¨",
  "Ù…ÙƒØªØ¨Ùƒ",
  "Ù…Ø·Ø¨Ø®",
  "ÙƒØ±Ø³ÙŠ",
  "Ù‚Ù…Ø§Ø´",
  "Ù…Ø¯ÙŠÙ†Ø©",
  "Ù‚Ø±ÙŠØ©",
  "Ø´Ø§Ø±Ø¹",
  "Ù…Ù†Ø²Ù„",
  "Ù…Ø¹Ø¨Ø¯",
  "Ù…Ø¯Ø±Ø³",
  "Ù…Ø¯ÙŠØ±",
  "Ø·Ø§Ù„Ø¨",
  "Ù…Ø·Ø§Ø±",
  "Ù…ÙŠÙ†Ø§Ø¡",
  "Ø³ÙÙŠÙ†Ø©",
  "Ø³ÙŠØ§Ø±Ø©",
  "Ù‚Ø§Ø±Ø¨",
  "Ø­Ø¯ÙŠÙ‚Ø©",
  "Ù†Ø§ÙØ°Ø©",
  "Ù…ØµØ¨Ø§Ø­",
  "Ù…ÙØªØ§Ø­",
  "Ø®Ø±ÙŠØ·Ø©",
  "Ø¨Ø·Ø§Ù‚Ø©",
  "ÙˆØ±Ù‚Ø©",
  "ØµÙˆØ±Ø©",
  "ÙˆØ«ÙŠÙ‚Ø©",
  "Ø±ÙˆØ§ÙŠØ©",
  "Ù‚ØµÙŠØ¯Ø©",
  "Ù…Ù†Ø§Ø±Ø©",
  "Ø¨ÙˆØ§Ø¨Ø©",
  "Ù‚ÙŠØ§Ø¯Ø©",
  "Ø¹Ù…Ø§Ø±Ø©",
  "Ø¹Ø¨Ø§Ø±Ø©",
  "Ø´Ø§Ø±Ø©",
  "Ø¥Ø´Ø§Ø±Ø©",
  "Ù‡ÙˆÙŠØ©",
  "ÙˆØ³ÙŠÙ„Ø©",
  "Ù‚Ø§Ø¦Ù…Ø©",
  "Ù…Ù†ØµØ©",
  "Ù…Ø§Ø¦Ø¯Ø©",
  "Ø·Ø§ÙˆÙ„Ø©",
  "ØºØ±ÙØ©",
  "ØºÙ†ÙŠÙ…Ø©",
  "Ø³Ø¹Ø§Ø¯Ø©",
  "Ø³ÙŠØ§Ø³Ø©",
  "ÙƒØ±Ø§Ù…Ø©",
  "Ø³Ù„Ø§Ù…Ø©",
  "ÙØ§Ø¦Ø¯Ø©",
  "Ù…ÙŠØ²Ø©",
  "Ù…ÙŠØ²Ø©ÙŒ"
];

/* =========================
   ØªØ·Ø¨ÙŠØ¹ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ÙˆØ§Ù„Ø·ÙˆÙ„
   ========================= */
function normalizeArabic(s){
  const diacritics = /[\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06ED]/g;
  s = (s||"").replace(diacritics, "");
  s = s.replace(/[Ø¥Ø£Ø¢Ø§]/g, "Ø§");
  s = s.replace(/[Ù‰ÙŠ]/g, "ÙŠ");
  return s;
}
function charLen(s){ return [...(s||"")].length; }

/* =========================
   ÙØ¦Ø§Øª + Ø§Ø­ØªÙŠØ§Ø·ÙŠ
   ========================= */
const CATEGORIES = {
  "Ø·Ø¨ÙŠØ¹Ø©": ["Ø£Ø²Ù‡Ø§Ø±","Ø´Ù…Ø³","Ù‚Ù…Ø±","Ø¨Ø­Ø±","ÙˆØ±Ø¯Ø©","ØºØµÙˆÙ†","Ø¸Ù„Ø§Ù„","Ø³Ø­Ø§Ø¨","Ø¹Ø´Ø¨","ØµØ®ÙˆØ±"],
  "Ø£Ø´ÙŠØ§Ø¡/Ø£Ø¯ÙˆØ§Øª": ["Ù…ÙØªØ§Ø­","ÙƒØªØ§Ø¨","ÙƒØ±Ø³ÙŠ","Ù‚Ù…Ø§Ø´","Ù‚Ù„Ù…","ÙˆØ±Ù‚","Ø·Ø§Ø¨Ø¹","Ù…Ù…Ø³Ùƒ","Ù…Ù„ØµÙ‚","Ù…ØºÙ„Ù"],
  "Ø£Ù…Ø§ÙƒÙ†": ["Ù…Ø¯ÙŠÙ†Ø©","Ù‚Ø±ÙŠØ©","Ù…Ø¹Ø¨Ø¯","Ù‚ØµØ±","Ø³ÙˆÙ‚","Ù…ÙŠÙ†Ø§Ø¡","Ù…Ø·Ø§Ø±","Ø­Ø¯ÙŠÙ‚Ø©","ÙˆØ§Ø¯ÙŠ","Ø¬Ø³Ø±"],
  "ØµÙØ§Øª": ["Ø¬Ù…ÙŠÙ„","Ø¸Ø±ÙŠÙ","Ù‚Ø§Ø³ÙŠ","Ù„Ø·ÙŠÙ","Ø°ÙƒÙŠ","Ø´Ø¬Ø§Ø¹","Ù‚ÙˆÙŠ","Ø¶Ø¹ÙŠÙ","Ù†Ø´ÙŠØ·","Ù‡Ø§Ø¯Ø¦"],
  "Ø¹Ø§Ù…Ù‘Ø©": []
};

const fallbackWords = [
  "Ø£Ø²Ù‡Ø§Ø±","Ø£Ø­Ø¯Ø§Ø«","Ø£ØµÙˆØ§Øª","Ø£Ù…Ø«Ù„Ø©","Ø£Ù…Ø§Ù†Ø©","Ø£Ø´Ø¬Ø§Ø±","Ø¥Ø´Ø§Ø±Ø©",
  "Ø¨Ø­Ø±ÙŠØ©","Ø¨Ù„Ø¯ÙŠØ©","Ø¨Ø·Ø§Ù‚Ø©","Ø¨ÙˆØµÙ„Ø©","Ø¨Ø°ÙˆØ±Ùƒ","Ø¨Ù‚Ø§ÙŠØ§","Ø¨Ø´Ø§Ø±Ø©",
  "ØªØµÙ…ÙŠÙ…","ØªØ±ØªÙŠØ¨","ØªÙ‚Ø±ÙŠØ±","ØªØ³Ù„ÙŠÙ…","ØªØ¯Ø±ÙŠØ¨","ØªØ¹Ø§ÙŠØ´","ØªØ¨Ø§Ø¯Ù„",
  "Ø¬Ø¯Ø§ÙˆÙ„","Ø¬Ø²ÙŠØ±Ø©","Ø¬Ù…Ø§Ø¹Ø©","Ø¬Ù…ÙŠÙ„Ø©","Ø¬ÙˆÙ„Ø§Øª","Ø¬Ø±Ø§Ø¦Ø¯","Ø¬ÙˆØ§Ø¦Ø²","Ø¬Ù„ÙˆØ³","Ø¬Ø¯ÙˆÙ„Ùƒ",
  "Ø­ÙƒØ§ÙŠØ©","Ø­Ø±Ø§Ø³Ø©","Ø­Ù‚ÙŠÙ‚Ø©","Ø­ØµÙŠÙ„Ø©","Ø­ÙˆØ§ÙØ²","Ø­Ø§Ø¶Ø±Ø©",
  "Ø®Ø·ÙˆØ§Øª","Ø®ÙŠØ§Ø±Ø§Øª","Ø®Ø²Ø§Ù†Ø©","Ø®Ù„Ø§ØµØ©","Ø®Ø±ÙŠØ·Ø©","Ø®Ø·ÙŠØ±Ø©",
  "Ø¯Ø¹ÙˆØ§Øª","Ø¯Ø±ÙˆØ³","Ø¯Ù„ÙŠÙ„Ùƒ","Ø¯Ø¹Ø§ÙˆÙ‰","Ø¯Ù‚ÙŠÙ‚Ø©",
  "Ø±Ø­Ù„Ø§Øª","Ø±Ø³Ø§Ù„Ø©","Ø±ØºØ¨Ø§Øª","Ø±ÙˆØ§Ø¨Ø·","Ø±ÙˆØ§ÙŠØ©","Ø±Ù‚Ø§Ø¦Ù‚",
  "Ø³ÙÙŠÙ†Ø©","Ø³ÙŠØ§Ø³Ø©","Ø³Ø¹Ø§Ø¯Ø©","Ø³Ù„Ø§Ù„Ø©","Ø³Ø¬Ù„Ø§Øª","Ø³ØªØ§Ø¦Ø±","Ø³Ø§Ø­Ø§Øª",
  "Ø´Ù‡Ø§Ø¯Ø©","Ø´Ø¬Ø§Ø¹Ø©","Ø´Ø¹Ø§Ø¦Ø±","Ø´ÙˆØ§Ù‡Ø¯","Ø´ÙˆØ§Ø·Ø¦","Ø´Ø±ÙŠØ¹Ø©","Ø´Ø·Ø§Ø¦Ø±","Ø´Ø±ÙŠÙƒØ©",
  "ØµØ¯Ø§Ù‚Ø©","ØµÙ†Ø§Ø¹Ø©","ØµØ±Ø§Ø­Ø©","ØµÙŠØ§Ù†Ø©","ØµØ­Ø§Ø±Ù‰","ØµÙˆØ§Ø¹Ù‚",
  "Ø¶ÙŠØ§ÙØ©","Ø¶Ù…Ø§Ù†Ùƒ","Ø¶ÙˆØ§Ø¨Ø·","Ø¶Ø±Ø§Ø¦Ø¨","Ø¶Ø±Ø¨Ø§Øª","Ø¶Ø¨Ø§Ø¨ÙŠ",
  "Ø·Ø¨ÙŠØ¹ÙŠ","Ø·Ù„Ø¨Ø§Øª","Ø·Ù…Ø§Ø·Ù…",
  "Ø¸ÙˆØ§Ù‡Ø±","Ø¸Ø±ÙŠÙØ©","Ø¸Ù„Ù…Ø§Øª",
  "Ø¹ÙˆØ§Ù…Ù„","Ø¹Ù†Ø§ØµØ±","Ø¹Ù†Ø§ÙŠØ©","Ø¹ÙˆØ§Ø·Ù","Ø¹ÙˆØ§ØµÙ","Ø¹Ø°ÙˆØ¨Ø©",
  "ØºÙ†Ø§Ø¦Ù…","ØºØ±Ø§Ù…Ø©","ØºØ³Ø§Ù„Ø©","ØºØ±Ø§Ø¦Ø¨","ØºØ±ÙØªÙƒ",
  "ÙØ§Ø¦Ø¯Ø©","ÙØ¶Ø§Ø¦Ù„","ÙÙˆØ§ÙƒÙ‡","ÙØ±Ø§Ø´Ø©","ÙÙƒØ§Ù‡Ø©","ÙØµØ§Ø¦Ù„",
  "Ù‚Ø§Ø¦Ù…Ø©","Ù‚Ø¯Ø±Ø§Øª","Ù‚ÙˆØ§Ø³Ù…","Ù‚Ø±Ø§Ø¡Ø©","Ù‚ØµØµÙŠØ©",
  "ÙƒØ±Ø§Ù…Ø©","ÙƒÙˆØ§ÙƒØ¨","ÙƒØ±Ø§Ø³Ø©","ÙƒÙØ§Ù„Ø©","ÙƒÙ„Ù…Ø§Øª","ÙƒÙØ§Ø¡Ø©","ÙƒÙ†ÙŠØ³Ø©",
  "Ù„ÙˆØ­Ø§Øª","Ù„ÙˆØ§Ø²Ù…","Ù„Ù…Ø­Ø§Øª","Ù„Ø­Ø¸Ø§Øª",
  "Ù…Ø³Ø§Ø¹Ø¯","Ù…ÙƒØªØ¨Ø©","Ù…Ø¯Ø§Ø±Ø³","Ù…Ø±Ø§Ø³Ù…","Ù…Ù†Ø§Ø²Ù„","Ù…Ø´Ø§Ø¹Ø±","Ù…ÙØ§ØªÙŠØ­","Ù…Ø±Ø§Ø­Ù„","Ù…Ù…Ø§Ù„Ùƒ","Ù…ÙˆØ§Ø³Ù…",
  "Ù†Ù…Ø§Ø°Ø¬","Ù†ÙˆØ§Ø­ÙŠ","Ù†Ù‚Ø§Ø´Ùƒ","Ù†Ù‡Ø§Ø¦ÙŠØ©","Ù†Ø´Ø§Ø·Ùƒ",
  "Ù‡Ø¯Ø§ÙŠØ§","Ù‡ÙˆØ§ÙŠØ©","Ù‡ÙˆØ§Ø¬Ø³","Ø¬ÙˆØ§Ù‡Ø±",
  "ÙˆØ«Ø§Ø¦Ù‚","ÙˆØ±Ø§Ø«Ø©","ÙˆØ¬Ø¨Ø§Øª","ÙˆØ¸Ø§Ø¦Ù","ÙˆÙ„Ø§Ø¯Ø©","ÙˆÙ‚Ø§Ø¦Ø¹","ÙˆØ³Ø§Ø¦Ù„","ÙˆØ­Ø¯Ø§Øª","ÙˆØ¬ÙˆÙ‡Ùƒ",
  "ÙŠÙ‚ÙŠÙ†Ùƒ","ÙŠÙ…Ø§Ù…Ø©","ÙŠÙ…Ù†ÙŠØ©","ÙŠÙˆØ³ÙÙŠ",
  "Ø³Ù„Ø§Ù…Ø©","Ø¥Ø¨Ø¯Ø§Ø¹","Ù‚ÙŠÙ…Ø©","ÙƒÙ„Ù…Ø©","Ù…Ø¯ÙŠÙ†Ø©","Ù‚Ù…Ø±","Ø´Ù…Ø³","ÙˆØ±Ø¯Ø©","ÙƒØªØ§Ø¨"
].filter(w=>charLen(w)===5);

/* =========================
   Ø­Ø§Ù„Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©
   ========================= */
let fiveLetterWords = [];   // ØªØªØ¹Ø¨Ø£ Ù…Ù† WORDS5_LARGE + Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ
let DICTIONARY = new Set(); // ÙŠØ¬Ù‡Ø² Ù„Ùˆ Ø§Ø­ØªØ¬Øª Ø§Ù„ØªØ­Ù‚Ù‚ Ù„Ø§Ø­Ù‚Ù‹Ø§
let words = [];
let currentWordIndex = 0;
let currentRow = 0;
let currentGuess = "";
let isLocked = false;
let savedGuesses = [[], [], []];
let shareCache = "";
let usedHintToday = false;
let hintFixedIndices = [new Set(), new Set(), new Set()];
let currentCategory = "Ø¹Ø§Ù…Ù‘Ø©";
let bestAttemptsToday = null;
let stats = { solved: 0, failed: 0, totalTries: 0 };

/* =========================
   DOM
   ========================= */
const grid = document.getElementById("grid");
const messageBox = document.getElementById("messageBox");
const correctAnswerBox = document.getElementById("correctAnswer");
const summary = document.getElementById("summary");
const daySeedPill = document.getElementById("daySeedPill");
const categoryPill = document.getElementById("categoryPill");
const countdown = document.getElementById("countdown");
const copyResultBtn = document.getElementById("copyResultBtn");
const hintBtn = document.getElementById("hintBtn");
const attemptStatus = document.getElementById("attemptStatus");
const bestStatus = document.getElementById("bestStatus");
const statsBox = document.getElementById("statsBox");
const statsChips = document.getElementById("statsChips");

/* =========================
   Ø£Ø¯ÙˆØ§Øª Ø¹Ø§Ù…Ø©
   ========================= */
function seedRandom(seed){ let x = Math.sin(seed) * 10000; return x - Math.floor(x); }
function pad(n){ return String(n).padStart(2,"0"); }
function vibrate(ms=80){ if (navigator.vibrate) navigator.vibrate(ms); }
function showMsg(txt, color="#0f0"){ messageBox.style.color = color; messageBox.textContent = txt; }

/* =========================
   Ø¨Ù†Ø§Ø¡ Ø§Ù„Ù…Ø¬Ù…Ù‘Ø¹ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø¯Ù…Ø¬Ø©
   ========================= */
function buildPools(){
  const pool = new Set();
  // ÙØ¦Ø§Øª
  Object.values(CATEGORIES).flat().forEach(w=>{
    if (charLen(w)===5) pool.add(w);
  });
  // Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ
  fallbackWords.forEach(w=>pool.add(w));
  // Ø§Ù„Ù‚Ø§Ù…ÙˆØ³ Ø§Ù„ÙƒØ¨ÙŠØ± Ø§Ù„Ù…Ø¯Ù…Ø¬
  WORDS5_LARGE.forEach(w=>{ if (charLen(w)===5) pool.add(w); });

  fiveLetterWords = Array.from(pool);
  DICTIONARY = new Set(fiveLetterWords.map(w=>normalizeArabic(w)));

  if (CATEGORIES["Ø¹Ø§Ù…Ù‘Ø©"].length === 0) {
    CATEGORIES["Ø¹Ø§Ù…Ù‘Ø©"] = fiveLetterWords.slice(0, Math.min(500, fiveLetterWords.length));
  }
}

/* =========================
   ÙˆØ§Ø¬Ù‡Ø©
   ========================= */
function createGrid() {
  grid.innerHTML = "";
  for (let i=0; i<MAX_ROWS; i++) {
    for (let j=0; j<WORD_LEN; j++) {
      const cell = document.createElement("div");
      cell.classList.add("cell");
      cell.id = `cell-${currentWordIndex}-${i}-${j}`;
      grid.appendChild(cell);
    }
  }
  updateAttemptStatus();
}
function createKeyboard() {
  const rows = ["Ø¯Ø¬Ø­Ø®Ø¹ØºÙÙ‚Ø«ØµØ¶","Ø·ÙƒÙ…Ù†ØªÙ„Ø§Ø¨ÙŠØ³Ø´","Ù‡Ø¸Ø²ÙˆØ©Ù‰Ø±Ø£Ø¥Ø¤Ø¡Ø°"];
  rows.forEach((row, idx) => {
    const rowDiv = document.getElementById(`row${idx+1}`);
    rowDiv.innerHTML = "";
    row.split("").forEach(k => {
      const key = document.createElement("div");
      key.classList.add("key");
      key.textContent = k;
      key.onclick = () => handleKey(k);
      rowDiv.appendChild(key);
    });
  });
}

/* =========================
   Ù…Ù†Ø·Ù‚ Ø§Ù„Ù„Ø¹Ø¨
   ========================= */
function lettersCountMap(word){
  const map = {};
  for (const ch of [...word]){ map[ch] = (map[ch]||0)+1; }
  return map;
}
function evaluateGuess(guess, correct){
  const res = Array(WORD_LEN).fill("absent");
  const count = lettersCountMap(correct);
  for (let i=0;i<WORD_LEN;i++){
    if (guess[i] === correct[i]){ res[i] = "correct"; count[guess[i]]--; }
  }
  for (let i=0;i<WORD_LEN;i++){
    if (res[i] !== "correct" && count[guess[i]]>0){ res[i] = "present"; count[guess[i]]--; }
  }
  return res;
}
function updateAttemptStatus(){
  attemptStatus.textContent = `Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©: ${currentRow+1} / ${MAX_ROWS}`;
  bestStatus.textContent = `Ø£ÙØ¶Ù„ Ù†ØªÙŠØ¬Ø© Ø§Ù„ÙŠÙˆÙ…: ${bestAttemptsToday ? bestAttemptsToday + " Ù…Ø­Ø§ÙˆÙ„Ø©" : "â€”"}`;
}
function updateGrid() {
  for (let i=0;i<WORD_LEN;i++){
    const cell = document.getElementById(`cell-${currentWordIndex}-${currentRow}-${i}`);
    if (cell) cell.textContent = currentGuess[i] || "";
  }
}
function renderGuess(result) {
  for (let j=0; j<WORD_LEN; j++) {
    const cell = document.getElementById(`cell-${currentWordIndex}-${currentRow}-${j}`);
    cell.textContent = currentGuess[j] ?? "";
    setTimeout(()=>cell.classList.add("flip"), j*60);
    setTimeout(()=>{ cell.classList.remove("flip"); cell.classList.add(result[j]); }, j*60 + 180);
  }
}
function updateKeyboardColors(guess, result) {
  const keys = document.querySelectorAll(".key");
  for (let i=0;i<WORD_LEN;i++){
    const letter = guess[i];
    keys.forEach(key => {
      if (key.textContent === letter) {
        if (result[i] === "correct") { key.classList.remove("present","absent"); key.classList.add("correct"); }
        else if (result[i] === "present" && !key.classList.contains("correct")) { key.classList.remove("absent"); key.classList.add("present"); }
        else if (!key.classList.contains("correct") && !key.classList.contains("present")) { key.classList.add("absent"); }
      }
    });
  }
}
function resetKeyboardColors(){ document.querySelectorAll(".key").forEach(k=>k.classList.remove("correct","present","absent")); }
function shakeRow(){
  const startIdx = currentRow*WORD_LEN;
  const cells = [...grid.children].slice(startIdx, startIdx+WORD_LEN);
  cells.forEach(c=>{ c.classList.add("shake"); setTimeout(()=>c.classList.remove("shake"), 420); });
}
function updateGridWithHints(){
  updateGrid();
  const fixed = hintFixedIndices[currentWordIndex];
  const correct = words[currentWordIndex];
  fixed.forEach(idx=>{
    const cell = document.getElementById(`cell-${currentWordIndex}-${currentRow}-${idx}`);
    if (cell){ cell.textContent = correct[idx]; }
    const arr = [...(currentGuess.padEnd(WORD_LEN," "))];
    arr[idx] = correct[idx];
    currentGuess = arr.join("").trimEnd();
  });
}
function handleKey(k) {
  if (isLocked || currentGuess.length >= WORD_LEN) return;
  if (!/^[\u0600-\u06FF]$/.test(k)) return;
  const fixed = hintFixedIndices[currentWordIndex];
  let i = currentGuess.length;
  while (fixed.has(i) && i < WORD_LEN) i++;
  if (i >= WORD_LEN) return;
  while (currentGuess.length < i) currentGuess += " ";
  currentGuess = currentGuess.substring(0, i) + k + currentGuess.substring(i+1);
  currentGuess = currentGuess.trimEnd();
  updateGridWithHints();
  saveState();
}
function handleBackspace() {
  if (isLocked) return;
  const fixed = hintFixedIndices[currentWordIndex];
  if (currentGuess.length === 0) return;
  let i = Math.max(0, currentGuess.length - 1);
  while (i>=0 && fixed.has(i)) i--;
  if (i<0) return;
  currentGuess = currentGuess.substring(0, i) + currentGuess.substring(i+1);
  currentGuess = currentGuess.trimEnd();
  updateGridWithHints();
  saveState();
}
function handleEnter() {
  if (isLocked) return;
  if (currentGuess.length < WORD_LEN){
    showMsg("Ø£ÙƒÙ…Ù„ Ø§Ù„ÙƒÙ„Ù…Ø© (5 Ø­Ø±ÙˆÙ)!", "#ffcc00"); shakeRow(); vibrate(); return;
  }

  // âœ… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù‚Ø§Ù…ÙˆØ³ Ø§Ø®ØªÙŠØ§Ø±ÙŠ
  if (REQUIRE_DICTIONARY) {
    const normGuess = normalizeArabic(currentGuess);
    if (!DICTIONARY.has(normGuess)){
      showMsg("Ø§Ù„ÙƒÙ„Ù…Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ø§Ù„Ù‚Ø§Ù…ÙˆØ³.", "#ffcc00"); shakeRow(); vibrate(120); return;
    }
  }

  const correct = words[currentWordIndex];
  const result = evaluateGuess(currentGuess, correct);
  renderGuess(result);
  updateKeyboardColors(currentGuess, result);
  savedGuesses[currentWordIndex].push({guess:currentGuess, result});
  stats.totalTries++;

  const isWin = currentGuess === correct;
  if (isWin) {
    const triesUsed = currentRow + 1;
    if (bestAttemptsToday === null || triesUsed < bestAttemptsToday) bestAttemptsToday = triesUsed;
    correctAnswerBox.innerHTML += `âœ… Ø§Ù„ÙƒÙ„Ù…Ø© ${currentWordIndex+1}: ${correct} (Ù…Ø­Ø§ÙˆÙ„Ø§Øª: ${triesUsed})<br>`;
    stats.solved++;
    currentWordIndex++;
    if (currentWordIndex >=3) { isLocked = true; showSummary(); makeShareText(); showStats(); }
    else { resetForNextWord(); }
  } else {
    currentRow++;
    if (currentRow >= MAX_ROWS) {
      correctAnswerBox.innerHTML += `âŒ Ø§Ù„ÙƒÙ„Ù…Ø© ${currentWordIndex+1}: ${correct}<br>`;
      stats.failed++;
      currentWordIndex++;
      if (currentWordIndex >=3) { isLocked = true; showSummary(); makeShareText(); showStats(); }
      else { resetForNextWord(); }
    } else {
      updateAttemptStatus();
    }
  }
  currentGuess = "";
  saveState();
}
function resetForNextWord() {
  currentRow = 0;
  currentGuess = "";
  createGrid();
  resetKeyboardColors();
  showMsg("");
  updateAttemptStatus();
  saveState();
}

/* =========================
   Ø§Ù„ØªÙ„Ù…ÙŠØ­ Ù…Ø±Ø© ÙŠÙˆÙ…ÙŠÙ‹Ø§
   ========================= */
function useHint(){
  if (isLocked) return;
  if (usedHintToday){ showMsg("Ø§Ø³ØªØ®Ø¯Ù…Øª ØªÙ„Ù…ÙŠØ­ Ø§Ù„ÙŠÙˆÙ… Ø¨Ø§Ù„ÙØ¹Ù„ âœ”", "#ffcc00"); return; }
  const word = words[currentWordIndex];
  const fixed = hintFixedIndices[currentWordIndex];
  const avail = [];
  for (let i=0;i<WORD_LEN;i++){ if (!fixed.has(i)) avail.push(i); }
  if (avail.length === 0){ showMsg("Ù„Ø§ ØªÙˆØ¬Ø¯ Ø®Ø§Ù†Ø§Øª Ù…ØªØ§Ø­Ø© Ù„Ù„ØªÙ„Ù…ÙŠØ­.", "#ffcc00"); return; }
  const idx = avail[Math.floor(Math.random()*avail.length)];
  fixed.add(idx);
  usedHintToday = true;
  const cell = document.getElementById(`cell-${currentWordIndex}-${currentRow}-${idx}`);
  if (cell){ cell.textContent = word[idx]; cell.classList.add("present"); setTimeout(()=>cell.classList.remove("present"), 300); }
  updateGridWithHints();
  showMsg(`ØªÙ… ÙƒØ´Ù Ø­Ø±Ù ÙÙŠ Ø§Ù„Ù…ÙˆØ¶Ø¹ ${idx+1} âœ…`, "#00e676");
  saveState();
}
hintBtn.addEventListener("click", useHint);

/* =========================
   Ø§Ù„Ù…Ù„Ø®Øµ/Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©/Ø§Ù„Ø¥Ø­ØµØ§Ø¡Ø§Øª
   ========================= */
function showSummary() {
  summary.innerHTML = "<h2>â­ Ù…Ù„Ø®Øµ Ù…Ø­Ø§ÙˆÙ„Ø§ØªÙƒ:</h2>";
  for (let w=0; w<3; w++) {
    const gridDiv = document.createElement("div");
    gridDiv.className = "summary-grid";
    for (let r=0;r<MAX_ROWS;r++) {
      const guessObj = savedGuesses[w]?.[r];
      for (let c=0;c<WORD_LEN;c++) {
        const cell = document.createElement("div");
        cell.className = "summary-cell";
        if (guessObj){
          cell.textContent = guessObj.guess[c];
          cell.classList.add(guessObj.result[c]);
        }
        gridDiv.appendChild(cell);
      }
    }
    summary.appendChild(gridDiv);
  }
}
function makeShareText(){
  let lines = ["ğŸ¯ Ø®Ù…Ø§Ø³ÙŠØ§Øª (Ø§Ù„ÙŠÙˆÙ…):", `Ø§Ù„ÙØ¦Ø©: ${currentCategory}`];
  for (let w=0; w<3; w++){
    const tries = savedGuesses[w] || [];
    lines.push(`ÙƒÙ„Ù…Ø© ${w+1}:`);
    if (!tries.length){ lines.push("â€”"); continue; }
    for (const t of tries){
      const row = t.result.map(r => r==="correct"?"ğŸŸ©":(r==="present"?"ğŸŸ¨":"â¬›")).join("");
      lines.push(row);
    }
  }
  shareCache = lines.join("\n");
}
copyResultBtn.addEventListener("click", async ()=>{
  if (!shareCache) makeShareText();
  try{ await navigator.clipboard.writeText(shareCache); showMsg("ØªÙ… Ù†Ø³Ø® Ø§Ù„Ù…Ù„Ø®Øµ! âœ”", "#00e676"); }
  catch(e){ showMsg("Ù„Ù… Ø£Ø³ØªØ·Ø¹ Ø§Ù„Ù†Ø³Ø® ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§. Ø­Ø¯Ø¯Ù‡ ÙˆØ§Ù†Ø³Ø®Ù‡ ÙŠØ¯ÙˆÙŠÙ‹Ø§.", "#ffcc00"); }
});
function showStats(){
  const totalWords = stats.solved + stats.failed;
  const successRate = totalWords ? Math.round((stats.solved/totalWords)*100) : 0;
  statsBox.style.display = "block";
  statsChips.innerHTML = `
    <div class="chip">âœ… ØªÙ… Ø­Ù„Ù‡Ø§: ${stats.solved}</div>
    <div class="chip">âŒ Ù„Ù… ØªÙØ­Ù„: ${stats.failed}</div>
    <div class="chip">ğŸ“ˆ Ù†Ø³Ø¨Ø© Ø§Ù„Ù†Ø¬Ø§Ø­: ${successRate}%</div>
    <div class="chip">ğŸ§® Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª: ${stats.totalTries}</div>
  `;
}

/* =========================
   Ø§Ù„ÙŠÙˆÙ… Ø§Ù„ØªØ§Ù„ÙŠ + Ø§Ù„Ø¨Ø°Ø±Ø©
   ========================= */
function startCountdown(){
  function tick(){
    const now = new Date();
    const nextMidnight = new Date(now);
    nextMidnight.setHours(24,0,0,0);
    const diff = nextMidnight - now;
    if (diff <= 0){ countdown.textContent = "â³ Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¢Ù†"; return; }
    const h = Math.floor(diff/3600000);
    const m = Math.floor((diff%3600000)/60000);
    const s = Math.floor((diff%60000)/1000);
    countdown.textContent = `â³ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${pad(h)}:${pad(m)}:${pad(s)}`;
  }
  tick(); setInterval(tick, 1000);
}
function pickCategoryBySeed(seed){
  const names = Object.keys(CATEGORIES);
  const pool = names.filter(n => n !== "Ø¹Ø§Ù…Ù‘Ø©");
  const useGeneral = seed % 4 === 0;
  if (useGeneral) return "Ø¹Ø§Ù…Ù‘Ø©";
  const idx = Math.floor(seedRandom(seed*3) * pool.length);
  return pool[idx] || "Ø¹Ø§Ù…Ù‘Ø©";
}
function pickWordsBySeed(seed, list) {
  const chosen = new Set();
  const L = list.length || 0;
  let i = 0;
  while (chosen.size < 3 && i < 2000) {
    const idx = Math.floor(seedRandom(seed + i) * L);
    if (list[idx]) chosen.add(list[idx]);
    i++;
  }
  if (chosen.size < 3){
    for (let k = 0; k < fiveLetterWords.length && chosen.size < 3; k++) chosen.add(fiveLetterWords[k]);
  }
  return Array.from(chosen);
}

/* =========================
   Ø­ÙØ¸/Ø§Ø³ØªØ±Ø¬Ø§Ø¹
   ========================= */
function saveState() {
  const today = new Date().toISOString().slice(0,10);
  const state = {
    currentWordIndex, currentRow, currentGuess, isLocked,
    savedGuesses, correctHTML: correctAnswerBox.innerHTML,
    date: today, usedHintToday, hintFixedIndices: hintFixedIndices.map(s=>[...s]),
    currentCategory, words, bestAttemptsToday, stats
  };
  localStorage.setItem("khmasiyatState", JSON.stringify(state));
}
function loadState() {
  const data = localStorage.getItem("khmasiyatState");
  if (!data) return false;
  try{
    const state = JSON.parse(data);
    const today = new Date().toISOString().slice(0,10);
    if (state.date === today) {
      currentWordIndex = state.currentWordIndex || 0;
      currentRow = state.currentRow || 0;
      currentGuess = state.currentGuess || "";
      isLocked = !!state.isLocked;
      savedGuesses = state.savedGuesses || [[],[],[]];
      correctAnswerBox.innerHTML = state.correctHTML || "";
      usedHintToday = !!state.usedHintToday;
      hintFixedIndices = (state.hintFixedIndices || [[],[],[]]).map(a=>new Set(a));
      currentCategory = state.currentCategory || "Ø¹Ø§Ù…Ù‘Ø©";
      words = state.words || words;
      bestAttemptsToday = state.bestAttemptsToday ?? null;
      stats = state.stats || { solved:0, failed:0, totalTries:0 };
      return true;
    }
  }catch(e){}
  return false;
}

/* =========================
   Bootstrap
   ========================= */
function createKeyboardListeners(){
  window.addEventListener("keydown", (e)=>{
    const key = e.key;
    if (key === "Enter"){ handleEnter(); return; }
    if (key === "Backspace"){ handleBackspace(); return; }
    if (/^[\u0600-\u06FF]$/.test(key)){ handleKey(key); }
  });
}
function initNewDay(seed, dateStr){
  daySeedPill.textContent = "Ø§Ù„ÙŠÙˆÙ…: " + dateStr;
  currentCategory = pickCategoryBySeed(seed);
  categoryPill.textContent = "Ø§Ù„ÙØ¦Ø©: " + currentCategory;

  let list = (CATEGORIES[currentCategory] || []).filter(w => charLen(w)===5);
  if (list.length < 5) list = fiveLetterWords;

  words = pickWordsBySeed(seed, list);
  createGrid(); createKeyboard();
  startCountdown(); createKeyboardListeners();
  saveState();
}
function bootstrap(){
  // Ø¬Ù‡Ù‘Ø² Ø§Ù„Ù…Ø¬Ù…Ù‘Ø¹ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø¯Ù…Ø¬Ø©
  buildPools();

  // ØªØ´ØºÙŠÙ„ Ø§Ù„ÙŠÙˆÙ…
  const today = new Date();
  const dateStr = today.toISOString().slice(0,10);
  const seed = parseInt(dateStr.replace(/-/g,''));

  createGrid(); createKeyboard();

  if (loadState()){
    const currList = savedGuesses[currentWordIndex] || [];
    for (let i=0; i<currList.length; i++){
      currentRow = i;
      currentGuess = currList[i].guess;
      renderGuess(currList[i].result);
      updateKeyboardColors(currList[i].guess, currList[i].result);
    }
    currentGuess = "";
    if (isLocked) { showSummary(); makeShareText(); showStats(); }
    daySeedPill.textContent = "Ø§Ù„ÙŠÙˆÙ…: " + dateStr;
    categoryPill.textContent = "Ø§Ù„ÙØ¦Ø©: " + (currentCategory || "Ø¹Ø§Ù…Ù‘Ø©");
  } else {
    initNewDay(seed, dateStr);
  }

  hintBtn.addEventListener("click", useHint);
  copyResultBtn.addEventListener("click", async ()=>{
    if (!shareCache) makeShareText();
    try{ await navigator.clipboard.writeText(shareCache); showMsg("ØªÙ… Ù†Ø³Ø® Ø§Ù„Ù…Ù„Ø®Øµ! âœ”", "#00e676"); }
    catch(e){ showMsg("Ù„Ù… Ø£Ø³ØªØ·Ø¹ Ø§Ù„Ù†Ø³Ø® ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§. Ø­Ø¯Ø¯Ù‡ ÙˆØ§Ù†Ø³Ø®Ù‡ ÙŠØ¯ÙˆÙŠÙ‹Ø§.", "#ffcc00"); }
  });

  updateAttemptStatus();
}
window.onload = bootstrap;
</script>
</body>
</html>
