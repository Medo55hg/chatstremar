<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ğŸ­ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„ÙˆÙ‡Ù…ÙŠØ© - Ù†Ø³Ø®Ø© Ø§Ù„Ø³ØªØ±ÙŠÙ…Ø± Ø§Ù„ÙØ§Ø®Ø±Ø©</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet" />
  <script src="tmi.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/tmi.js@1.8.5/dist/tmi.min.js"></script>
  <style>
    :root{
      /* Ù†Ø¸Ø§Ù… Ø£Ù„ÙˆØ§Ù† ÙØ§Ø®Ø± - Ø¯Ø§ÙƒÙ† Ù…Ø¹ Ø¥Ø¶Ø§Ø¡Ø§Øª Ù†ÙŠÙˆÙ† */
      --bg: #0a0b14;
      --bg-soft: #121320;
      --panel: rgba(20, 22, 36, 0.97);
      --panel-soft: rgba(26, 28, 45, 0.95);
      --card: #1e2132;
      --card-hover: #252840;
      --line: #2a2d4a;
      --line-soft: #363960;
      
      /* Ø£Ù„ÙˆØ§Ù† Ù†ÙŠÙˆÙ† ÙØ§Ø®Ø±Ø© */
      --neon-red: #ff2e63;
      --neon-red-glow: rgba(255, 46, 99, 0.3);
      --neon-blue: #00d4ff;
      --neon-blue-glow: rgba(0, 212, 255, 0.3);
      --neon-green: #00ff9d;
      --neon-green-glow: rgba(0, 255, 157, 0.3);
      --neon-purple: #b967ff;
      --neon-purple-glow: rgba(185, 103, 255, 0.3);
      --neon-yellow: #ffcc00;
      --neon-yellow-glow: rgba(255, 204, 0, 0.3);
      --neon-cyan: #08f7fe;
      --neon-cyan-glow: rgba(8, 247, 254, 0.3);
      
      /* Ù†ØµÙˆØµ */
      --text: #ffffff;
      --text-soft: #e0e0ff;
      --muted: #8a8dae;
      --muted-soft: #6a6d8e;
      
      /* ØªØ£Ø«ÙŠØ±Ø§Øª */
      --radius-xl: 24px;
      --radius-lg: 20px;
      --radius-md: 16px;
      --radius-sm: 12px;
      --radius-xs: 8px;
      
      --shadow-xl: 0 25px 50px -12px rgba(0, 0, 0, 0.8);
      --shadow-lg: 0 20px 40px rgba(0, 0, 0, 0.6);
      --shadow-md: 0 10px 30px rgba(0, 0, 0, 0.4);
      --shadow-sm: 0 5px 15px rgba(0, 0, 0, 0.3);
      
      --glow-red: 0 0 20px var(--neon-red-glow);
      --glow-blue: 0 0 20px var(--neon-blue-glow);
      --glow-green: 0 0 20px var(--neon-green-glow);
      --glow-purple: 0 0 20px var(--neon-purple-glow);
      --glow-yellow: 0 0 20px var(--neon-yellow-glow);
      
      /* ØªØ¯Ø±Ø¬Ø§Øª ÙØ§Ø®Ø±Ø© */
      --gradient-primary: linear-gradient(135deg, var(--neon-blue), var(--neon-purple));
      --gradient-success: linear-gradient(135deg, var(--neon-green), var(--neon-cyan));
      --gradient-warning: linear-gradient(135deg, var(--neon-yellow), #ff9500);
      --gradient-danger: linear-gradient(135deg, var(--neon-red), #ff3366);
      --gradient-dark: linear-gradient(135deg, #1a1c2e, #0f1120);
    }

    *{
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    /* Ø£Ù†ÙŠÙ…ÙŠØ´Ù† Ø¯Ø®ÙˆÙ„ Ù…ØªØ¯Ø±Ø¬ */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
    }

    @keyframes glowPulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }

    @keyframes shimmer {
      0% { background-position: -1000px 0; }
      100% { background-position: 1000px 0; }
    }

    @keyframes slideInRight {
      from { transform: translateX(100px); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    @keyframes slideInLeft {
      from { transform: translateX(-100px); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    body{
      margin:0;
      min-height:100vh;
      color:var(--text);
      font-family:'Cairo', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: var(--bg);
      overflow-x: hidden;
      position: relative;
    }

    /* Ø®Ù„ÙÙŠØ© Ù…ØªØ­Ø±ÙƒØ© */
    body::before{
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: 
        radial-gradient(circle at 20% 80%, var(--neon-purple-glow) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, var(--neon-blue-glow) 0%, transparent 50%),
        radial-gradient(circle at 40% 40%, var(--neon-red-glow) 0%, transparent 50%);
      filter: blur(60px);
      opacity: 0.15;
      z-index: -2;
      animation: float 20s ease-in-out infinite;
    }

    /* Ø´Ø¨ÙƒØ© Ø®Ù„ÙÙŠØ© */
    body::after{
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: 
        linear-gradient(rgba(255, 255, 255, 0.05) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255, 255, 255, 0.05) 1px, transparent 1px);
      background-size: 50px 50px;
      z-index: -1;
      opacity: 0.3;
    }

    /* Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„ÙØ§Ø®Ø± */
    header{
      padding: 20px 40px;
      background: rgba(20, 22, 36, 0.9);
      backdrop-filter: blur(30px);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      position: sticky;
      top: 0;
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: var(--shadow-lg);
      border-bottom: 1px solid var(--line);
    }

    .header-content{
      display: flex;
      align-items: center;
      gap: 30px;
      width: 100%;
      max-width: 1600px;
      margin: 0 auto;
    }

    .logo-container{
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .logo{
      width: 50px;
      height: 50px;
      background: var(--gradient-primary);
      border-radius: 15px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      box-shadow: var(--glow-blue);
      animation: glowPulse 2s ease-in-out infinite;
    }

    .title-container h1{
      font-size: 24px;
      font-weight: 900;
      background: linear-gradient(90deg, var(--neon-blue), var(--neon-purple));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      letter-spacing: 0.5px;
    }

    .title-container .subtitle{
      font-size: 12px;
      color: var(--muted);
      font-weight: 500;
      letter-spacing: 1px;
      text-transform: uppercase;
      margin-top: 2px;
    }

    .header-actions{
      display: flex;
      gap: 15px;
      margin-right: auto;
    }

    /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„ÙØ§Ø®Ø±Ø© */
    .btn{
      padding: 14px 28px;
      border-radius: var(--radius-md);
      border: none;
      font-family: 'Cairo', sans-serif;
      font-weight: 700;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      display: inline-flex;
      align-items: center;
      gap: 10px;
      position: relative;
      overflow: hidden;
      text-decoration: none;
      letter-spacing: 0.5px;
      text-transform: uppercase;
    }

    .btn::before{
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.7s;
    }

    .btn:hover::before{
      left: 100%;
    }

    .btn-primary{
      background: var(--gradient-primary);
      color: white;
      box-shadow: var(--glow-blue);
    }

    .btn-primary:hover{
      transform: translateY(-3px);
      box-shadow: 0 15px 35px rgba(0, 212, 255, 0.4);
    }

    .btn-success{
      background: var(--gradient-success);
      color: white;
      box-shadow: var(--glow-green);
    }

    .btn-success:hover{
      transform: translateY(-3px);
      box-shadow: 0 15px 35px rgba(0, 255, 157, 0.4);
    }

    .btn-danger{
      background: var(--gradient-danger);
      color: white;
      box-shadow: var(--glow-red);
    }

    .btn-danger:hover{
      transform: translateY(-3px);
      box-shadow: 0 15px 35px rgba(255, 46, 99, 0.4);
    }

    .btn-warning{
      background: var(--gradient-warning);
      color: white;
      box-shadow: var(--glow-yellow);
    }

    .btn-warning:hover{
      transform: translateY(-3px);
      box-shadow: 0 15px 35px rgba(255, 204, 0, 0.4);
    }

    .btn-outline{
      background: transparent;
      border: 2px solid var(--neon-blue);
      color: var(--neon-blue);
    }

    .btn-outline:hover{
      background: var(--neon-blue);
      color: white;
      box-shadow: var(--glow-blue);
    }

    /* Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
    .container{
      max-width: 1600px;
      margin: 0 auto;
      padding: 30px;
      animation: fadeIn 0.8s ease-out;
    }

    /* ØªØ®Ø·ÙŠØ· Ø§Ù„Ø´Ø¨ÙƒØ© */
    .dashboard-grid{
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 30px;
      margin-bottom: 30px;
    }

    @media (max-width: 1200px){
      .dashboard-grid{
        grid-template-columns: 1fr;
      }
    }

    /* Ø¨Ø§Ù†Ø± Ø§Ù„Ø¯ÙˆØ± Ø§Ù„ÙØ§Ø®Ø± */
    .turn-banner{
      grid-column: 1 / -1;
      background: rgba(20, 22, 36, 0.8);
      border-radius: var(--radius-xl);
      padding: 30px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: var(--shadow-xl);
      position: relative;
      overflow: hidden;
      backdrop-filter: blur(20px);
      margin-bottom: 30px;
      animation: slideInRight 0.6s ease-out;
    }

    .turn-banner::before{
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: var(--gradient-primary);
    }

    .turn-banner-content{
      display: flex;
      align-items: center;
      gap: 25px;
    }

    .turn-indicator{
      width: 80px;
      height: 80px;
      background: var(--gradient-primary);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      font-weight: 900;
      text-transform: uppercase;
      letter-spacing: 2px;
      box-shadow: var(--glow-blue);
      animation: glowPulse 2s ease-in-out infinite;
    }

    .turn-info{
      flex: 1;
    }

    .turn-label{
      font-size: 14px;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 2px;
      font-weight: 600;
      margin-bottom: 5px;
    }

    .turn-name{
      font-size: 32px;
      font-weight: 900;
      background: linear-gradient(90deg, var(--neon-blue), var(--neon-purple));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .turn-timer{
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .timer-container{
      position: relative;
      width: 100px;
      height: 100px;
    }

    .timer-svg{
      transform: rotate(-90deg);
      width: 100%;
      height: 100%;
    }

    .timer-background{
      fill: none;
      stroke: rgba(255, 255, 255, 0.1);
      stroke-width: 8;
    }

    .timer-progress{
      fill: none;
      stroke: url(#timerGradient);
      stroke-width: 8;
      stroke-linecap: round;
      stroke-dasharray: 283;
      stroke-dashoffset: 283;
      transition: stroke-dashoffset 1s linear;
    }

    .timer-text{
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 24px;
      font-weight: 900;
      color: var(--text);
    }

    /* Ø§Ù„Ø£Ù„ÙˆØ§Ø­ Ø§Ù„ÙØ§Ø®Ø±Ø© */
    .panel{
      background: rgba(20, 22, 36, 0.8);
      border-radius: var(--radius-xl);
      padding: 30px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: var(--shadow-xl);
      position: relative;
      overflow: hidden;
      backdrop-filter: blur(20px);
      animation: fadeIn 0.8s ease-out;
    }

    .panel::before{
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: var(--gradient-primary);
    }

    .panel-header{
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 30px;
    }

    .panel-title{
      font-size: 20px;
      font-weight: 800;
      color: var(--text);
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .panel-icon{
      width: 40px;
      height: 40px;
      background: var(--gradient-primary);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      box-shadow: var(--glow-blue);
    }

    .panel-actions{
      display: flex;
      gap: 12px;
    }

    /* Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† ÙˆØ§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„ÙˆÙ‡Ù…ÙŠØ© Ø¨Ù†ÙØ³ Ø§Ù„Ø´ÙƒÙ„ */
    .players-grid,
    .cards-grid{
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
    }

    @media (max-width: 1200px){
      .players-grid,
      .cards-grid{
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (max-width: 768px){
      .players-grid,
      .cards-grid{
        grid-template-columns: 1fr;
      }
    }

    .player-card,
    .card-item{
      background: rgba(30, 33, 50, 0.6);
      border-radius: var(--radius-lg);
      padding: 25px 20px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      text-align: center;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      cursor: pointer;
    }

    .player-card::before,
    .card-item::before{
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, rgba(0, 212, 255, 0.1), transparent);
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .player-card:hover,
    .card-item:hover{
      transform: translateY(-5px);
      background: rgba(37, 40, 65, 0.8);
      box-shadow: var(--glow-blue);
    }

    .player-card:hover::before,
    .card-item:hover::before{
      opacity: 1;
    }

    .player-card.selected,
    .card-item.selected{
      background: rgba(0, 212, 255, 0.1);
      border-color: var(--neon-blue);
      box-shadow: var(--glow-blue);
    }

    .player-card.winner,
    .card-item.revealed{
      background: rgba(0, 255, 157, 0.1);
      border-color: var(--neon-green);
      box-shadow: var(--glow-green);
    }

    .player-card.eliminated,
    .card-item.locked{
      background: rgba(255, 204, 0, 0.1);
      border-color: var(--neon-yellow);
      box-shadow: var(--glow-yellow);
    }

    .player-card.eliminated{
      opacity: 0.5;
      filter: grayscale(0.7);
    }

    .player-badge,
    .card-status{
      position: absolute;
      top: 15px;
      left: 15px;
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 11px;
      font-weight: 700;
      letter-spacing: 1px;
      text-transform: uppercase;
    }

    .badge-turn,
    .status-ready{
      background: rgba(0, 212, 255, 0.2);
      color: var(--neon-blue);
    }

    .badge-winner,
    .status-revealed{
      background: rgba(0, 255, 157, 0.2);
      color: var(--neon-green);
    }

    .badge-eliminated,
    .status-locked{
      background: rgba(255, 204, 0, 0.2);
      color: var(--neon-yellow);
    }

    .player-name,
    .card-text{
      font-size: 20px;
      font-weight: 800;
      color: var(--text);
      margin-bottom: 10px;
      position: relative;
      z-index: 1;
    }

    /* Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù…Ù† Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† */
    .player-stats{
      display: none;
    }

    /* Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ÙØ§Ø®Ø±Ø© */
    .stats-panel{
      grid-column: 1 / -1;
      margin-top: 30px;
      animation: slideInLeft 0.6s ease-out;
    }

    .stats-grid{
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .stat-card{
      background: rgba(30, 33, 50, 0.6);
      border-radius: var(--radius-lg);
      padding: 25px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      text-align: center;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .stat-card::before{
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, rgba(255, 46, 99, 0.1), transparent);
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .stat-card:hover{
      transform: translateY(-5px);
      background: rgba(37, 40, 65, 0.8);
      box-shadow: var(--glow-red);
    }

    .stat-card:hover::before{
      opacity: 1;
    }

    .stat-icon{
      width: 60px;
      height: 60px;
      margin: 0 auto 15px;
      background: var(--gradient-danger);
      border-radius: 15px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      box-shadow: var(--glow-red);
    }

    .stat-value{
      font-size: 32px;
      font-weight: 900;
      color: var(--text);
      margin-bottom: 5px;
      position: relative;
      z-index: 1;
    }

    .stat-label{
      font-size: 14px;
      color: var(--muted);
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 2px;
      position: relative;
      z-index: 1;
    }

    /* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… Ø§Ù„ÙØ§Ø®Ø± */
    .progress-section{
      grid-column: 1 / -1;
      margin: 30px 0;
      animation: fadeIn 0.8s ease-out;
    }

    .progress-header{
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 15px;
    }

    .progress-label{
      font-size: 14px;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 2px;
      font-weight: 600;
    }

    .progress-value{
      font-size: 18px;
      font-weight: 900;
      background: linear-gradient(90deg, var(--neon-blue), var(--neon-purple));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .progress-bar{
      height: 12px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 6px;
      overflow: hidden;
      position: relative;
    }

    .progress-fill{
      height: 100%;
      background: var(--gradient-primary);
      border-radius: 6px;
      position: relative;
      width: 0%;
      transition: width 1s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .progress-fill::after{
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      animation: shimmer 2s infinite;
    }

    /* Ø´Ø±ÙŠØ· Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„ÙØ§Ø®Ø± */
    .status-bar{
      grid-column: 1 / -1;
      background: rgba(20, 22, 36, 0.8);
      border-radius: var(--radius-xl);
      padding: 25px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      margin-top: 30px;
      backdrop-filter: blur(20px);
      animation: fadeIn 0.8s ease-out;
    }

    .status-content{
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 20px;
    }

    .status-message{
      font-size: 16px;
      font-weight: 600;
      color: var(--text-soft);
    }

    .status-message strong{
      color: var(--neon-blue);
    }

    .legend{
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
    }

    .legend-item{
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 16px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: var(--radius-sm);
      font-size: 13px;
      font-weight: 500;
    }

    .legend-dot{
      width: 10px;
      height: 10px;
      border-radius: 50%;
    }

    .dot-blue{
      background: var(--neon-blue);
      box-shadow: 0 0 10px var(--neon-blue);
    }

    .dot-green{
      background: var(--neon-green);
      box-shadow: 0 0 10px var(--neon-green);
    }

    .dot-yellow{
      background: var(--neon-yellow);
      box-shadow: 0 0 10px var(--neon-yellow);
    }

    /* Ù„ÙˆØ­Ø© Ø§Ù„Ø³ØªØ±ÙŠÙ…Ø± Ø§Ù„ÙØ§Ø®Ø±Ø© */
    .streamer-panel{
      grid-column: 1 / -1;
      margin-top: 30px;
    }

    .streamer-header{
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 25px;
    }

    .streamer-controls{
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 25px;
      margin-bottom: 30px;
    }

    .control-group{
      background: rgba(30, 33, 50, 0.6);
      border-radius: var(--radius-lg);
      padding: 25px;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .control-group h3{
      font-size: 18px;
      font-weight: 800;
      margin-bottom: 20px;
      color: var(--neon-cyan);
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .control-row{
      display: flex;
      gap: 15px;
      margin-bottom: 15px;
      align-items: center;
    }

    .control-row input,
    .control-row select{
      flex: 1;
      padding: 14px 20px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: var(--radius-sm);
      color: var(--text);
      font-family: 'Cairo', sans-serif;
      font-size: 14px;
      transition: all 0.3s ease;
    }

    .control-row input:focus,
    .control-row select:focus{
      outline: none;
      border-color: var(--neon-blue);
      box-shadow: 0 0 0 3px var(--neon-blue-glow);
    }

    .tables-container{
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
      gap: 25px;
      margin-top: 30px;
    }

    .table-wrapper{
      background: rgba(30, 33, 50, 0.6);
      border-radius: var(--radius-lg);
      padding: 25px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      overflow-x: auto;
    }

    .table-wrapper h3{
      font-size: 18px;
      font-weight: 800;
      margin-bottom: 20px;
      color: var(--neon-cyan);
    }

    .data-table{
      width: 100%;
      border-collapse: collapse;
    }

    .data-table th{
      text-align: right;
      padding: 15px;
      background: rgba(255, 255, 255, 0.05);
      color: var(--muted);
      font-weight: 700;
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: 1px;
      border-bottom: 2px solid rgba(255, 255, 255, 0.1);
    }

    .data-table td{
      padding: 15px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
      color: var(--text-soft);
    }

    .data-table tr:hover{
      background: rgba(255, 255, 255, 0.05);
    }

    /* Ø²Ø± Ø§Ù„ØªØ­ÙƒÙ… */
    .control-toggle{
      position: fixed;
      bottom: 30px;
      left: 30px;
      z-index: 1000;
      animation: float 3s ease-in-out infinite;
    }

    /* Ù†Ø§ÙØ°Ø© Ø§Ù„Ø´Ø§Øª Ø§Ù„ÙØ§Ø®Ø±Ø© */
    .chat-modal{
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(10px);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 2000;
    }

    .chat-card{
      background: rgba(20, 22, 36, 0.95);
      border-radius: var(--radius-xl);
      padding: 40px;
      width: 90%;
      max-width: 600px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: var(--shadow-xl);
      backdrop-filter: blur(30px);
      animation: slideInRight 0.5s ease-out;
    }

    .chat-header{
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 30px;
    }

    .chat-header h2{
      font-size: 28px;
      font-weight: 900;
      background: linear-gradient(90deg, var(--neon-blue), var(--neon-purple));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    /* Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„ÙØ§Ø®Ø±Ø© */
    .help-modal{
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      backdrop-filter: blur(20px);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 2000;
    }

    .help-card{
      background: rgba(20, 22, 36, 0.95);
      border-radius: var(--radius-xl);
      padding: 40px;
      width: 90%;
      max-width: 800px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: var(--shadow-xl);
      backdrop-filter: blur(30px);
      animation: fadeIn 0.5s ease-out;
    }

    .help-steps{
      display: grid;
      gap: 20px;
      margin-top: 30px;
    }

    .help-step{
      display: flex;
      gap: 20px;
      align-items: center;
      padding: 25px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: var(--radius-lg);
      border-left: 4px solid var(--neon-blue);
      transition: all 0.3s ease;
    }

    .help-step:hover{
      background: rgba(255, 255, 255, 0.1);
      transform: translateX(10px);
    }

    .step-number{
      width: 50px;
      height: 50px;
      background: var(--gradient-primary);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      font-weight: 900;
      color: white;
      flex-shrink: 0;
      box-shadow: var(--glow-blue);
    }

    .step-content{
      flex: 1;
    }

    .step-content h4{
      font-size: 18px;
      font-weight: 800;
      margin-bottom: 8px;
      color: var(--text);
    }

    .step-content p{
      color: var(--muted);
      line-height: 1.6;
    }

    /* ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„ÙÙˆØ² */
    .winner-overlay{
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 3000;
      backdrop-filter: blur(20px);
    }

    .winner-card{
      text-align: center;
      padding: 60px;
      background: rgba(20, 22, 36, 0.95);
      border-radius: var(--radius-xl);
      border: 2px solid var(--neon-green);
      box-shadow: 0 0 100px var(--neon-green-glow);
      animation: float 2s ease-in-out infinite;
    }

    .winner-title{
      font-size: 48px;
      font-weight: 900;
      background: linear-gradient(90deg, var(--neon-green), var(--neon-cyan));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 20px;
      letter-spacing: 2px;
    }

    .winner-names{
      font-size: 36px;
      font-weight: 800;
      color: var(--text);
      margin-bottom: 30px;
      letter-spacing: 1px;
    }

    /* Ø¥Ø´Ø¹Ø§Ø±Ø§Øª */
    .notification{
      position: fixed;
      top: 100px;
      right: 30px;
      padding: 20px 30px;
      background: rgba(20, 22, 36, 0.95);
      border-radius: var(--radius-lg);
      border-left: 4px solid var(--neon-blue);
      box-shadow: var(--shadow-lg);
      backdrop-filter: blur(20px);
      z-index: 1000;
      animation: slideInRight 0.3s ease-out;
      display: none;
    }

    /* Ø¹Ø±Ø¶ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª ÙÙŠ Ø§Ù„Ù…Ù†ØªØµÙ */
    .cards-middle{
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      display: none;
      gap: 50px;
      z-index: 2000;
    }

    .middle-card{
      width: 300px;
      padding: 40px;
      background: rgba(20, 22, 36, 0.95);
      border-radius: var(--radius-xl);
      border: 2px solid var(--neon-blue);
      box-shadow: 0 0 50px var(--neon-blue-glow);
      text-align: center;
      backdrop-filter: blur(20px);
      transform: scale(0.8);
      opacity: 0;
      transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .middle-card.show{
      transform: scale(1);
      opacity: 1;
    }

    .middle-card h3{
      font-size: 18px;
      color: var(--muted);
      margin-bottom: 15px;
      text-transform: uppercase;
      letter-spacing: 2px;
    }

    .middle-card p{
      font-size: 32px;
      font-weight: 900;
      color: var(--text);
    }

    /* ØªØ£Ø«ÙŠØ±Ø§Øª ØµÙˆØªÙŠØ© Ù…Ø±Ø¦ÙŠØ© */
    .sound-wave{
      position: fixed;
      bottom: 100px;
      right: 30px;
      display: flex;
      gap: 4px;
      align-items: flex-end;
      height: 50px;
      z-index: 1000;
    }

    .wave-bar{
      width: 4px;
      background: var(--neon-blue);
      border-radius: 2px;
      animation: wave 1.5s ease-in-out infinite;
    }

    .wave-bar:nth-child(2){ animation-delay: 0.1s; }
    .wave-bar:nth-child(3){ animation-delay: 0.2s; }
    .wave-bar:nth-child(4){ animation-delay: 0.3s; }
    .wave-bar:nth-child(5){ animation-delay: 0.4s; }

    @keyframes wave{
      0%, 100%{ height: 10px; }
      50%{ height: 40px; }
    }

    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ø¬ÙˆØ§Ù„ */
    @media (max-width: 768px){
      header{
        padding: 15px;
      }
      
      .header-content{
        flex-direction: column;
        gap: 15px;
      }
      
      .header-actions{
        margin-right: 0;
        width: 100%;
        justify-content: center;
      }
      
      .container{
        padding: 15px;
      }
      
      .dashboard-grid{
        gap: 15px;
      }
      
      .turn-banner{
        flex-direction: column;
        gap: 20px;
        padding: 20px;
      }
      
      .turn-banner-content{
        flex-direction: column;
        text-align: center;
      }
      
      .tables-container{
        grid-template-columns: 1fr;
      }
      
      .control-group{
        padding: 20px;
      }
      
      .btn{
        padding: 12px 20px;
        font-size: 12px;
      }
    }

    /* ØªØ£Ø«ÙŠØ±Ø§Øª Ø®Ø§ØµØ© */
    .particles{
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: -1;
    }

    .particle{
      position: absolute;
      width: 2px;
      height: 2px;
      background: var(--neon-blue);
      border-radius: 50%;
      animation: particleFloat 15s linear infinite;
    }

    @keyframes particleFloat{
      0%{
        transform: translateY(100vh) translateX(0);
        opacity: 0;
      }
      10%{
        opacity: 1;
      }
      90%{
        opacity: 1;
      }
      100%{
        transform: translateY(-100px) translateX(100px);
        opacity: 0;
      }
    }
    
    /* Ø²Ø± Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„ÙˆÙ‚Øª */
    .timer-controls {
      display: flex;
      gap: 10px;
      margin-left: 20px;
    }
    
    .time-control-btn {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      color: var(--text);
      font-size: 18px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }
    
    .time-control-btn:hover {
      background: var(--neon-blue);
      color: white;
      box-shadow: 0 0 15px var(--neon-blue-glow);
      transform: scale(1.1);
    }
    
    .time-control-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    /* Ø´Ø§Ø±Ø© Ø§Ù„Ù†Ù‚Ø·Ø© */
    .status-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: var(--neon-red);
    }
    
    .status-dot.connected {
      background: var(--neon-green);
      box-shadow: 0 0 10px var(--neon-green-glow);
    }
  </style>
</head>
<body>

<!-- Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„ÙØ§Ø®Ø± -->
<header>
  <div class="header-content">
    <div class="logo-container">
      <div class="logo">ğŸ­</div>
      <div class="title-container">
        <h1>Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„ÙˆÙ‡Ù…ÙŠØ©</h1>
        <div class="subtitle">Ù†Ø³Ø®Ø© Ø§Ù„Ø³ØªØ±ÙŠÙ…Ø± Ø§Ù„ÙØ§Ø®Ø±Ø©</div>
      </div>
    </div>
    
    <div class="header-actions">
      <button id="chatBtn" class="btn btn-primary">
        <span>ğŸ’¬</span>
        Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø´Ø§Øª
      </button>
      <button id="helpBtn" class="btn btn-outline">
        <span>â”</span>
        Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª
      </button>
      <button id="gmToggle" class="btn btn-warning">
        <span>âš™ï¸</span>
        Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
      </button>
    </div>
  </div>
</header>

<!-- Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
<div class="container">
  <!-- Ø¨Ø§Ù†Ø± Ø§Ù„Ø¯ÙˆØ± -->
  <div id="turnBanner" class="turn-banner" style="display: none;">
    <div class="turn-banner-content">
      <div class="turn-indicator">Ø§Ù„Ø¯ÙˆØ±</div>
      <div class="turn-info">
        <div class="turn-label">Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø­Ø§Ù„ÙŠ</div>
        <div id="turnName" class="turn-name">â€”</div>
      </div>
    </div>
    
    <div class="turn-timer">
      <div class="timer-container">
        <svg class="timer-svg" viewBox="0 0 100 100">
          <defs>
            <linearGradient id="timerGradient" x1="0%" y1="0%" x2="100%" y2="0%">
              <stop offset="0%" style="stop-color:var(--neon-blue);stop-opacity:1" />
              <stop offset="100%" style="stop-color:var(--neon-purple);stop-opacity:1" />
            </linearGradient>
          </defs>
          <circle cx="50" cy="50" r="45" class="timer-background"></circle>
          <circle cx="50" cy="50" r="45" class="timer-progress"></circle>
        </svg>
        <div id="timerText" class="timer-text">60</div>
      </div>
      
      <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„ÙˆÙ‚Øª -->
      <div class="timer-controls">
        <button id="pauseTimer" class="time-control-btn">â¸ï¸</button>
        <button id="playTimer" class="time-control-btn" style="display: none;">â–¶ï¸</button>
        <button id="resetTimer" class="time-control-btn">ğŸ”„</button>
      </div>
      
      <div class="timer-hint">
        <div style="font-size: 14px; color: var(--muted); margin-bottom: 5px;">Ø§Ø®ØªØ± Ø¨Ø·Ø§Ù‚Ø© Ù„Ù„Ø§Ø³Ù… Ø§Ù„ÙˆÙ‡Ù…ÙŠ Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚</div>
        <div style="font-size: 12px; color: var(--muted-soft);">Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ</div>
      </div>
    </div>
  </div>

  <!-- ØªØ®Ø·ÙŠØ· Ø§Ù„Ù„ÙˆØ­Ø© -->
  <div class="dashboard-grid">
    <!-- Ù„ÙˆØ­Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† -->
    <div class="panel">
      <div class="panel-header">
        <div class="panel-title">
          <div class="panel-icon">ğŸ‘¥</div>
          <span>Ø§Ù„Ù„Ø§Ø¹Ø¨ÙˆÙ†</span>
          <span id="playersCount" style="font-size: 14px; color: var(--muted); margin-right: 10px;">(0 Ù„Ø§Ø¹Ø¨)</span>
        </div>
        <div class="panel-actions">
          <button id="btnStart" class="btn btn-success">â–¶ï¸ Ø§Ø¨Ø¯Ø£</button>
          <button id="btnReset" class="btn btn-danger">ğŸ” Ø¥Ø¹Ø§Ø¯Ø©</button>
          <button id="btnSkip" class="btn btn-warning">â­ï¸ ØªØ¬Ø§ÙˆØ²</button>
        </div>
      </div>
      <div id="playersGrid" class="players-grid">
        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨Ø§Ù„Ù€ JavaScript -->
      </div>
    </div>

    <!-- Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„ÙˆÙ‡Ù…ÙŠØ© -->
    <div class="panel">
      <div class="panel-header">
        <div class="panel-title">
          <div class="panel-icon">ğŸƒ</div>
          <span>Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„ÙˆÙ‡Ù…ÙŠØ©</span>
          <span id="cardsCount" style="font-size: 14px; color: var(--muted); margin-right: 10px;">(0 Ø¨Ø·Ø§Ù‚Ø©)</span>
        </div>
        <div class="panel-actions">
          <button id="btnShuffleCards" class="btn btn-primary">ğŸ”€ Ø®Ù„Ø·</button>
          <button id="btnLockAll" class="btn btn-warning">ğŸ”’ Ù‚ÙÙ„</button>
          <button id="btnUnlockAll" class="btn btn-success">ğŸ”“ ÙØªØ­</button>
        </div>
      </div>
      <div id="cardsGrid" class="cards-grid">
        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨Ø§Ù„Ù€ JavaScript -->
      </div>
    </div>

    <!-- Ø´Ø±ÙŠØ· ØªÙ‚Ø¯Ù… Ø§Ù„Ø¬ÙˆÙ„Ø© -->
    <div class="progress-section">
      <div class="progress-header">
        <div class="progress-label">ØªÙ‚Ø¯Ù… Ø§Ù„Ø¬ÙˆÙ„Ø©</div>
        <div class="progress-value">Ø§Ù„Ø¬ÙˆÙ„Ø©: <span id="roundNumber">1</span></div>
      </div>
      <div class="progress-bar">
        <div id="roundProgress" class="progress-fill"></div>
      </div>
    </div>

    <!-- Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
    <div class="stats-panel">
      <div class="panel-header">
        <div class="panel-title">
          <div class="panel-icon">ğŸ“Š</div>
          <span>Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©</span>
        </div>
      </div>
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-icon">ğŸ¯</div>
          <div id="accuracyRate" class="stat-value">0%</div>
          <div class="stat-label">Ù…Ø¹Ø¯Ù„ Ø§Ù„ØµØ­Ø©</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">ğŸ”¥</div>
          <div id="mostChosenName" class="stat-value">â€”</div>
          <div class="stat-label">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙƒØ«Ø± Ø§Ø®ØªÙŠØ§Ø±Ù‹Ø§</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">ğŸ†</div>
          <div id="mostCorrectPlayer" class="stat-value">â€”</div>
          <div class="stat-label">Ø§Ù„Ø£ÙƒØ«Ø± Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">ğŸ“ˆ</div>
          <div id="remainingCards" class="stat-value">0</div>
          <div class="stat-label">Ø¨Ø·Ø§Ù‚Ø§Øª Ù…ØªØ¨Ù‚ÙŠØ©</div>
        </div>
      </div>
    </div>

    <!-- Ø´Ø±ÙŠØ· Ø§Ù„Ø­Ø§Ù„Ø© -->
    <div class="status-bar">
      <div class="status-content">
        <div class="status-message">
          Ø§Ù†Ø¶Ù…Ø§Ù… Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯ÙŠÙ†: <strong>ğŸ’¬ Ø§ÙƒØªØ¨ !Ø¯Ø®ÙˆÙ„ ÙÙŠ Ø§Ù„Ø´Ø§Øª</strong> 
          Ø«Ù… ÙŠØ¶ÙŠÙ Ø§Ù„Ø³ØªØ±ÙŠÙ…Ø± Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙˆÙ‡Ù…ÙŠ Ù…Ù† Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
        </div>
        <div class="legend">
          <div class="legend-item">
            <span class="legend-dot dot-green"></span>
            <span>Ù…Ù‚ØµÙ‰</span>
          </div>
          <div class="legend-item">
            <span class="legend-dot dot-yellow"></span>
            <span>Ù…Ù‚ÙÙ„Ø©</span>
          </div>
          <div class="legend-item">
            <span class="legend-dot dot-blue"></span>
            <span>Ø¯ÙˆØ± Ø­Ø§Ù„ÙŠ</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Ù„ÙˆØ­Ø© Ø§Ù„Ø³ØªØ±ÙŠÙ…Ø± -->
    <div id="gm" class="streamer-panel" style="display: none;">
      <div class="panel">
        <div class="streamer-header">
          <div class="panel-title">
            <div class="panel-icon">ğŸ®</div>
            <span>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ø³ØªØ±ÙŠÙ…Ø±</span>
          </div>
        </div>

        <div class="streamer-controls">
          <div class="control-group">
            <h3>ğŸ‘¤ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†</h3>
            <div class="control-row">
              <input id="playerName" type="text" placeholder="Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨ (Ù…Ø«Ø§Ù„: Ø£Ø­Ù…Ø¯)">
              <button id="addPlayerBtn" class="btn btn-success">Ø¥Ø¶Ø§ÙØ©</button>
            </div>
            <div style="font-size: 13px; color: var(--muted); margin-top: 10px;">
              Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ù… <strong>ğŸ’¬ Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø´Ø§Øª</strong> Ù„Ù„Ø§Ù†Ø¶Ù…Ø§Ù… Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
            </div>
          </div>

          <div class="control-group">
            <h3>ğŸƒ Ø¥Ø¶Ø§ÙØ© Ø£Ø³Ù…Ø§Ø¡ ÙˆÙ‡Ù…ÙŠØ©</h3>
            <div class="control-row">
              <input id="fakeWord" type="text" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙˆÙ‡Ù…ÙŠ (Ù…Ø«Ø§Ù„: Ø³ÙŠØ§Ø±Ø©)">
              <select id="fakeOwner"></select>
            </div>
            <div class="control-row">
              <button id="addFakeBtn" class="btn btn-primary">Ø¥Ø¶Ø§ÙØ© Ø¨Ø·Ø§Ù‚Ø©</button>
              <button id="clearUnowned" class="btn btn-danger">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</button>
            </div>
          </div>
        </div>

        <div class="tables-container">
          <div class="table-wrapper">
            <h3>ğŸ“‹ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†</h3>
            <table class="data-table">
              <thead>
                <tr>
                  <th>Ø§Ù„Ø§Ø³Ù…</th>
                  <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                  <th>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙˆÙ‡Ù…ÙŠ</th>
                  <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                </tr>
              </thead>
              <tbody id="playersTable">
                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨Ø§Ù„Ù€ JavaScript -->
              </tbody>
            </table>
          </div>

          <div class="table-wrapper">
            <h3>ğŸ“‹ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª</h3>
            <table class="data-table">
              <thead>
                <tr>
                  <th>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙˆÙ‡Ù…ÙŠ</th>
                  <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                  <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                </tr>
              </thead>
              <tbody id="cardsTable">
                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨Ø§Ù„Ù€ JavaScript -->
              </tbody>
            </table>
          </div>
        </div>

        <div style="margin-top: 30px;">
          <h3 style="color: var(--neon-cyan); margin-bottom: 15px;">ğŸ“ Ø³Ø¬Ù„ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«</h3>
          <textarea id="log" style="width: 100%; height: 150px; padding: 20px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: var(--radius-sm); color: var(--text); font-family: 'Cairo', sans-serif; font-size: 14px; resize: vertical;" placeholder="Ø³Ø¬Ù„ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«..." readonly></textarea>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Ø²Ø± Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø¹Ø§Ø¦Ù… -->
<button id="gmToggleFloating" class="control-toggle btn btn-warning" style="display: none;">
  <span>âš™ï¸</span>
  Ø§Ù„ØªØ­ÙƒÙ…
</button>

<!-- Ù†Ø§ÙØ°Ø© Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø´Ø§Øª -->
<div id="chatModal" class="chat-modal">
  <div class="chat-card">
    <div class="chat-header">
      <div style="font-size: 32px;">ğŸ’¬</div>
      <h2>Ø§ØªØµØ§Ù„ Ø¨Ø´Ø§Øª Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±</h2>
    </div>
    
    <div style="margin-bottom: 30px;">
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
        <button id="twitchBtn" class="btn btn-primary" style="justify-content: center;">ğŸ® Twitch</button>
        <button id="kickBtn" class="btn btn-outline" style="justify-content: center;">ğŸ¥Š Kick</button>
      </div>
      
      <div style="margin-bottom: 20px;">
        <label style="display: block; margin-bottom: 10px; color: var(--muted); font-weight: 600;">Ø§Ø³Ù… Ø§Ù„Ù‚Ù†Ø§Ø©</label>
        <input id="channelName" type="text" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ù‚Ù†Ø§Ø© Ø¨Ø¯ÙˆÙ† @" style="width: 100%; padding: 15px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: var(--radius-sm); color: var(--text); font-family: 'Cairo', sans-serif; font-size: 16px;">
      </div>
      
      <div style="display: flex; align-items: center; gap: 10px; padding: 15px; background: rgba(255, 255, 255, 0.05); border-radius: var(--radius-sm); margin-bottom: 20px;">
        <div id="statusDot" class="status-dot"></div>
        <span id="statusText" style="color: var(--text); font-weight: 600;">ØºÙŠØ± Ù…ØªØµÙ„</span>
      </div>
      
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 30px;">
        <button id="connectBtn" class="btn btn-success">ğŸš€ Ø§ØªØµØ§Ù„</button>
        <button id="disconnectBtn" class="btn btn-danger" disabled>âœ‹ Ù‚Ø·Ø¹ Ø§Ù„Ø§ØªØµØ§Ù„</button>
      </div>
    </div>
    
    <div style="border-top: 1px solid rgba(255, 255, 255, 0.1); padding-top: 20px;">
      <h3 style="color: var(--neon-cyan); margin-bottom: 15px; font-size: 16px;">ğŸ“‹ Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ø´Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©:</h3>
      <div style="display: grid; gap: 8px;">
        <div style="display: flex; align-items: center; gap: 10px;">
          <code style="background: rgba(0, 212, 255, 0.1); padding: 6px 12px; border-radius: var(--radius-xs); color: var(--neon-blue); font-family: monospace;">!Ø¯Ø®ÙˆÙ„</code>
          <span style="color: var(--muted);">Ù„Ù„Ø§Ù†Ø¶Ù…Ø§Ù… Ù„Ù„Ø¹Ø¨Ø©</span>
        </div>
        <div style="display: flex; align-items: center; gap: 10px;">
          <code style="background: rgba(0, 212, 255, 0.1); padding: 6px 12px; border-radius: var(--radius-xs); color: var(--neon-blue); font-family: monospace;">!Ù„Ø§Ø¹Ø¨ÙŠÙ†</code>
          <span style="color: var(--muted);">Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†</span>
        </div>
        <div style="display: flex; align-items: center; gap: 10px;">
          <code style="background: rgba(0, 212, 255, 0.1); padding: 6px 12px; border-radius: var(--radius-xs); color: var(--neon-blue); font-family: monospace;">!Ø¨Ø·Ø§Ù‚Ø§Øª</code>
          <span style="color: var(--muted);">Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„ÙˆÙ‡Ù…ÙŠØ©</span>
        </div>
      </div>
    </div>
    
    <div style="display: flex; justify-content: flex-end; margin-top: 30px;">
      <button id="closeChat" class="btn btn-outline">Ø¥ØºÙ„Ø§Ù‚</button>
    </div>
  </div>
</div>

<!-- Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª -->
<div id="helpOverlay" class="help-modal">
  <div class="help-card">
    <div class="chat-header" style="margin-bottom: 10px;">
      <div style="font-size: 32px;">ğŸ“š</div>
      <h2>Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù„Ø¹Ø¨ Ø§Ù„Ø´Ø§Ù…Ù„</h2>
    </div>
    
    <p style="color: var(--muted); line-height: 1.6; margin-bottom: 30px;">
      Ø¯Ù„ÙŠÙ„ ÙƒØ§Ù…Ù„ Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù„Ø¹Ø¨Ø© Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„ÙˆÙ‡Ù…ÙŠØ© ÙÙŠ Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±. Ø§ØªØ¨Ø¹ Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø¨Ø§Ù„ØªØ±ØªÙŠØ¨ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø£ÙØ¶Ù„ ØªØ¬Ø±Ø¨Ø©.
    </p>
    
    <div class="help-steps">
      <div class="help-step">
        <div class="step-number">1</div>
        <div class="step-content">
          <h4>Ø§ØªØµØ§Ù„ Ø§Ù„Ø´Ø§Øª</h4>
          <p>Ø§ØªØµÙ„ Ø¨Ø´Ø§Øª Twitch Ø£Ùˆ Kick Ù…Ù† Ø²Ø± "ğŸ’¬ Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø´Ø§Øª" ÙˆØ£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù‚Ù†Ø§Ø©.</p>
        </div>
      </div>
      
      <div class="help-step">
        <div class="step-number">2</div>
        <div class="step-content">
          <h4>Ø§Ù†Ø¶Ù…Ø§Ù… Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯ÙŠÙ†</h4>
          <p>Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯ÙˆÙ† ÙŠÙƒØªØ¨ÙˆÙ† <code style="background: rgba(0, 212, 255, 0.1); padding: 2px 8px; border-radius: 4px; color: var(--neon-blue); font-family: monospace;">!Ø¯Ø®ÙˆÙ„</code> ÙÙŠ Ø§Ù„Ø´Ø§Øª Ù„Ù„Ø§Ù†Ø¶Ù…Ø§Ù….</p>
        </div>
      </div>
      
      <div class="help-step">
        <div class="step-number">3</div>
        <div class="step-content">
          <h4>Ø¥Ø¶Ø§ÙØ© Ø£Ø³Ù…Ø§Ø¡ ÙˆÙ‡Ù…ÙŠØ©</h4>
          <p>Ø§Ù„Ø³ØªØ±ÙŠÙ…Ø± ÙŠØ¶ÙŠÙ Ø§Ø³Ù…Ù‹Ø§ ÙˆÙ‡Ù…ÙŠÙ‹Ø§ Ù„ÙƒÙ„ Ù„Ø§Ø¹Ø¨ Ù…Ù† Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø£Ùˆ ÙŠØªØ±ÙƒÙ‡Ù… ÙŠØ®ØªØ§Ø±ÙˆÙ†.</p>
        </div>
      </div>
      
      <div class="help-step">
        <div class="step-number">4</div>
        <div class="step-content">
          <h4>Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©</h4>
          <p>Ø§Ù†Ù‚Ø± Ø²Ø± "â–¶ï¸ Ø§Ø¨Ø¯Ø£" Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø¬ÙˆÙ„Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰. Ø§Ù„Ø¯ÙˆØ± ÙŠÙ†ØªÙ‚Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø¨ÙŠÙ† Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†.</p>
        </div>
      </div>
      
      <div class="help-step">
        <div class="step-number">5</div>
        <div class="step-content">
          <h4>Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª</h4>
          <p>Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø­Ø§Ù„ÙŠ ÙŠØ®ØªØ§Ø± Ù„Ø§Ø¹Ø¨Ù‹Ø§ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙŠÙ…Ù†Ù‰ ÙˆØ§Ø³Ù…Ù‹Ø§ ÙˆÙ‡Ù…ÙŠÙ‹Ø§ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙŠØ³Ø±Ù‰.</p>
        </div>
      </div>
      
      <div class="help-step">
        <div class="step-number">6</div>
        <div class="step-content">
          <h4>Ø§Ù„ÙÙˆØ² ÙˆØ§Ù„Ø¥Ù‚ØµØ§Ø¡</h4>
          <p>Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± ØµØ­ÙŠØ­Ù‹Ø§ØŒ ÙŠÙÙ‚ØµÙ‰ Ø§Ù„Ù„Ø§Ø¹Ø¨. Ø¢Ø®Ø± Ù„Ø§Ø¹Ø¨ÙŠÙ† ÙŠØªØ¨Ù‚ÙŠØ§Ù† ÙŠÙÙˆØ²Ø§Ù† Ø¨Ø§Ù„Ù„Ø¹Ø¨Ø©!</p>
        </div>
      </div>
    </div>
    
    <div style="display: flex; justify-content: flex-end; margin-top: 30px;">
      <button id="helpClose" class="btn btn-primary">Ø­Ø³Ù†Ø§Ù‹ØŒ ÙÙ‡Ù…Øª!</button>
    </div>
  </div>
</div>

<!-- ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø¬Ø³ÙŠÙ…Ø§Øª -->
<div class="particles" id="particles"></div>

<!-- ØªØ£Ø«ÙŠØ± Ø§Ù„Ù…ÙˆØ¬Ø§Øª Ø§Ù„ØµÙˆØªÙŠØ© -->
<div class="sound-wave" style="display: none;">
  <div class="wave-bar"></div>
  <div class="wave-bar"></div>
  <div class="wave-bar"></div>
  <div class="wave-bar"></div>
  <div class="wave-bar"></div>
</div>

<!-- Ø¥Ø´Ø¹Ø§Ø±Ø§Øª -->
<div id="notification" class="notification"></div>

<!-- Ø¹Ø±Ø¶ Ø§Ù„ÙØ§Ø¦Ø²ÙŠÙ† -->
<div id="winnerOverlay" class="winner-overlay">
  <div class="winner-card">
    <div class="winner-title">ğŸ† Ø§Ù„ÙØ§Ø¦Ø²ÙˆÙ† ğŸ†</div>
    <div id="winnerNames" class="winner-names"></div>
    <div style="color: var(--muted); font-size: 18px; margin-top: 20px;">Ø¢Ø®Ø± Ù„Ø§Ø¹Ø¨ÙŠÙ† ÙŠØªØ¨Ù‚ÙŠØ§Ù† ÙŠÙÙˆØ²Ø§Ù†!</div>
    <button id="closeWinner" class="btn btn-success" style="margin-top: 30px;">Ø§Ø¨Ø¯Ø£ Ø¬ÙˆÙ„Ø© Ø¬Ø¯ÙŠØ¯Ø©</button>
  </div>
</div>

<!-- Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ù†ØªØµÙ -->
<div id="cardsMiddle" class="cards-middle">
  <div id="middleLeftCard" class="middle-card">
    <h3>Ø§Ù„Ù„Ø§Ø¹Ø¨</h3>
    <p id="middlePlayer">â€”</p>
  </div>
  <div id="middleRightCard" class="middle-card">
    <h3>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙˆÙ‡Ù…ÙŠ</h3>
    <p id="middleCard">â€”</p>
  </div>
</div>

<!-- Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø© -->
<div id="matchResult" class="winner-overlay" style="background: rgba(0, 0, 0, 0.7);">
  <div class="winner-card" style="border-color: var(--neon-blue); box-shadow: 0 0 50px var(--neon-blue-glow);">
    <div id="resultText" style="font-size: 48px; font-weight: 900; margin-bottom: 20px;">â€”</div>
    <div id="resultMessage" style="color: var(--muted); font-size: 18px;">â€”</div>
  </div>
</div>

<script>
/* ===== Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù… ===== */
const state = {
  players: [],
  cards: [],
  turnIndex: -1,
  started: false,
  selectedMentionedId: null,
  selectedCardId: null,
  turnTimer: null,
  timeLeft: 60,
  currentRound: 1,
  gameEnded: false,
  cardChoices: {},
  lastWinners: [],
  chatConnected: false,
  chatPlatform: 'twitch',
  chatClient: null,
  kickSocket: null,
  chatChannel: '',
  connFlags: { twitch: false, kick: false },
  pendingPlayers: [],
  timerPaused: false,
  timerRunning: false
};

/* ===== Ù…Ø³Ø§Ø¹Ø¯Ø§Øª ===== */
const uid = () => Math.random().toString(36).slice(2, 10);
const normalize = s => (s || "").toString().trim().toLowerCase();
function byId(arr, id) { return arr.find(x => x.id === id); }
function currentPlayer() { if (state.turnIndex < 0 || state.turnIndex >= state.players.length) return null; return state.players[state.turnIndex]; }
function alivePlayers() { return state.players.filter(p => !p.eliminated); }

/* ===== Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù†ØµÙˆØµ ===== */
function log(t) {
  const logArea = document.getElementById('log');
  if (logArea) {
    logArea.value = `[${new Date().toLocaleTimeString()}] ${t}\n${logArea.value}`;
  }
  showNotification(t, 'info');
  updateStats();
}

/* ===== Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ===== */
function showNotification(message, type = 'info') {
  const notification = document.getElementById('notification');
  if (!notification) return;
  
  const colors = {
    info: 'var(--neon-blue)',
    success: 'var(--neon-green)',
    warning: 'var(--neon-yellow)',
    error: 'var(--neon-red)'
  };
  
  notification.innerHTML = message;
  notification.style.borderLeftColor = colors[type] || colors.info;
  notification.style.display = 'block';
  
  setTimeout(() => {
    notification.style.display = 'none';
  }, 3000);
}

/* ===== Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø³ÙŠÙ…Ø§Øª ===== */
function createParticles() {
  const container = document.getElementById('particles');
  if (!container) return;
  
  const particleCount = 50;
  const colors = ['#00d4ff', '#b967ff', '#00ff9d', '#ffcc00', '#ff2e63'];
  
  for (let i = 0; i < particleCount; i++) {
    const particle = document.createElement('div');
    particle.className = 'particle';
    particle.style.left = `${Math.random() * 100}vw`;
    particle.style.animationDelay = `${Math.random() * 15}s`;
    particle.style.animationDuration = `${Math.random() * 10 + 10}s`;
    particle.style.opacity = Math.random() * 0.5 + 0.1;
    particle.style.background = colors[Math.floor(Math.random() * colors.length)];
    container.appendChild(particle);
  }
}

/* ===== ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¯Ø§Ø¯ ===== */
function updateCounts() {
  const playersCount = document.getElementById('playersCount');
  const cardsCount = document.getElementById('cardsCount');
  
  if (playersCount) playersCount.textContent = `(${state.players.length} Ù„Ø§Ø¹Ø¨)`;
  if (cardsCount) cardsCount.textContent = `(${state.cards.length} Ø¨Ø·Ø§Ù‚Ø©)`;
}

/* ===== ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ===== */
function updateStats() {
  // Ù…Ø¹Ø¯Ù„ Ø§Ù„ØµØ­Ø©
  let totalGuesses = 0;
  let correctGuesses = 0;
  
  state.players.forEach(p => {
    totalGuesses += p.correctGuesses + p.wrongGuesses;
    correctGuesses += p.correctGuesses;
  });
  
  const accuracy = totalGuesses > 0 ? Math.round((correctGuesses / totalGuesses) * 100) : 0;
  const accuracyRate = document.getElementById('accuracyRate');
  if (accuracyRate) accuracyRate.textContent = `${accuracy}%`;
  
  // Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙƒØ«Ø± Ø§Ø®ØªÙŠØ§Ø±Ù‹Ø§
  let mostChosen = { name: 'â€”', count: 0 };
  Object.keys(state.cardChoices).forEach(cardId => {
    const card = byId(state.cards, cardId);
    if (card && state.cardChoices[cardId] > mostChosen.count) {
      mostChosen = {
        name: card.text,
        count: state.cardChoices[cardId]
      };
    }
  });
  
  const mostChosenName = document.getElementById('mostChosenName');
  const mostChosenCount = document.getElementById('mostChosenCount');
  if (mostChosenName) mostChosenName.textContent = mostChosen.name;
  if (mostChosenCount) mostChosenCount.textContent = `${mostChosen.count} Ù…Ø±Ø©`;
  
  // Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø£ÙƒØ«Ø± Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©
  let mostCorrect = { player: 'â€”', count: 0 };
  state.players.forEach(p => {
    if (p.correctGuesses > mostCorrect.count) {
      mostCorrect = {
        player: p.name,
        count: p.correctGuesses
      };
    }
  });
  
  const mostCorrectPlayer = document.getElementById('mostCorrectPlayer');
  const mostCorrectCount = document.getElementById('mostCorrectCount');
  if (mostCorrectPlayer) mostCorrectPlayer.textContent = mostCorrect.player;
  if (mostCorrectCount) mostCorrectCount.textContent = `${mostCorrect.count} ØµØ­ÙŠØ­Ø©`;
  
  // Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©
  const unrevealed = state.cards.filter(c => !c.revealed).length;
  const remainingCards = document.getElementById('remainingCards');
  const totalCards = document.getElementById('totalCards');
  if (remainingCards) remainingCards.textContent = `${unrevealed}`;
  if (totalCards) totalCards.textContent = `${state.cards.length}`;
  
  // ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
  const roundProgress = document.getElementById('roundProgress');
  if (roundProgress) {
    const revealed = state.cards.filter(c => c.revealed).length;
    const total = state.cards.length;
    const percentage = total > 0 ? Math.round((revealed / total) * 100) : 0;
    roundProgress.style.width = `${percentage}%`;
  }
  
  // ØªØ­Ø¯ÙŠØ« Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆÙ„Ø©
  const roundNumber = document.getElementById('roundNumber');
  if (roundNumber) roundNumber.textContent = state.currentRound;
}

/* ===== Ø¹Ø±Ø¶ Ø¨Ø§Ù†Ø± Ø§Ù„Ø¯ÙˆØ± ===== */
function renderTurnBanner() {
  const turnBanner = document.getElementById('turnBanner');
  const turnName = document.getElementById('turnName');
  const turnLabel = document.getElementById('turnLabel');
  
  const p = currentPlayer();
  if (p && !p.eliminated && !state.gameEnded) {
    if (turnName) turnName.textContent = p.name;
    if (turnBanner) turnBanner.style.display = 'flex';
    if (state.started && !state.timerPaused) {
      startTurnTimer();
    }
  } else {
    if (turnName) turnName.textContent = 'â€”';
    if (turnBanner) turnBanner.style.display = 'none';
    clearInterval(state.turnTimer);
    state.timerRunning = false;
  }
}

/* ===== Ù…Ø¤Ù‚Øª Ø§Ù„Ø¯ÙˆØ± ===== */
function startTurnTimer() {
  clearInterval(state.turnTimer);
  state.timeLeft = 60;
  state.timerPaused = false;
  state.timerRunning = true;
  updateTimerDisplay();
  
  // ØªØ­Ø¯ÙŠØ« Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ…
  updateTimerControls();
  
  state.turnTimer = setInterval(() => {
    if (!state.timerPaused) {
      state.timeLeft--;
      updateTimerDisplay();
      
      if (state.timeLeft <= 0) {
        clearInterval(state.turnTimer);
        state.timerRunning = false;
        const player = currentPlayer();
        if (player && !player.eliminated) {
          log(`â° Ø§Ù†ØªÙ‡Ù‰ ÙˆÙ‚Øª ${player.name}`);
        }
        nextTurnAuto();
      }
    }
  }, 1000);
}

function pauseTimer() {
  state.timerPaused = true;
  updateTimerControls();
  log('â¸ï¸ ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø¤Ù‚Øª');
  showNotification('Ø§Ù„Ù…Ø¤Ù‚Øª Ù…ØªÙˆÙ‚Ù', 'warning');
}

function resumeTimer() {
  state.timerPaused = false;
  updateTimerControls();
  log('â–¶ï¸ Ø§Ø³ØªØ¦Ù†Ø§Ù Ø§Ù„Ù…Ø¤Ù‚Øª');
  showNotification('Ø§Ù„Ù…Ø¤Ø¹Ø¯ Ù…Ø³ØªØ£Ù†Ù', 'success');
}

function resetTimerToDefault() {
  state.timeLeft = 60;
  state.timerPaused = false;
  updateTimerDisplay();
  updateTimerControls();
  log('ğŸ”„ ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø§Ù„Ù…Ø¤Ù‚Øª');
  showNotification('ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø§Ù„ÙˆÙ‚Øª', 'info');
}

function updateTimerControls() {
  const pauseBtn = document.getElementById('pauseTimer');
  const playBtn = document.getElementById('playTimer');
  
  if (state.timerPaused) {
    if (pauseBtn) pauseBtn.style.display = 'none';
    if (playBtn) playBtn.style.display = 'flex';
  } else {
    if (pauseBtn) pauseBtn.style.display = 'flex';
    if (playBtn) playBtn.style.display = 'none';
  }
  
  // ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ø§Ù„Ù…Ø¤Ø¹Ø¯ ÙŠØ¹Ù…Ù„
  const resetBtn = document.getElementById('resetTimer');
  if (pauseBtn) pauseBtn.disabled = !state.timerRunning;
  if (playBtn) playBtn.disabled = !state.timerRunning;
  if (resetBtn) resetBtn.disabled = !state.timerRunning;
}

function updateTimerDisplay() {
  const timerText = document.getElementById('timerText');
  const progress = document.querySelector('.timer-progress');
  
  if (timerText) timerText.textContent = state.timeLeft;
  
  if (progress) {
    const circumference = 2 * Math.PI * 45;
    const offset = circumference - (state.timeLeft / 60) * circumference;
    progress.style.strokeDasharray = `${circumference} ${circumference}`;
    progress.style.strokeDashoffset = offset;
    
    if (state.timeLeft <= 10) {
      progress.style.stroke = 'var(--neon-red)';
    } else if (state.timeLeft <= 30) {
      progress.style.stroke = 'var(--neon-yellow)';
    } else {
      progress.style.stroke = 'url(#timerGradient)';
    }
  }
}

/* ===== Ø¹Ø±Ø¶ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† ===== */
function renderPlayers() {
  const playersGrid = document.getElementById('playersGrid');
  if (!playersGrid) return;
  
  playersGrid.innerHTML = '';
  
  if (state.players.length === 0) {
    for (let i = 0; i < 6; i++) {
      const ghost = document.createElement('div');
      ghost.className = 'player-card';
      ghost.style.opacity = '0.5';
      ghost.innerHTML = `
        <div style="text-align: center; color: var(--muted);">
          <div style="font-size: 14px; margin-bottom: 10px;">ğŸ‘¤ Ù„Ø§Ø¹Ø¨</div>
          <div style="font-size: 12px;">Ø§ÙƒØªØ¨ !Ø¯Ø®ÙˆÙ„ ÙÙŠ Ø§Ù„Ø´Ø§Øª</div>
        </div>
      `;
      playersGrid.appendChild(ghost);
    }
    return;
  }
  
  state.players.forEach((p, index) => {
    const playerCard = document.createElement('div');
    playerCard.className = 'player-card';
    playerCard.dataset.id = p.id;
    
    if (p.isWinner) playerCard.classList.add('winner');
    if (state.selectedMentionedId === p.id) playerCard.classList.add('selected');
    if (p.eliminated) playerCard.classList.add('eliminated');
    
    playerCard.onclick = () => {
      if (p.eliminated || state.gameEnded) return;
      state.selectedMentionedId = p.id;
      document.querySelectorAll('.player-card').forEach(card => card.classList.remove('selected'));
      playerCard.classList.add('selected');
      tryResolveIfReady();
    };
    
    playerCard.innerHTML = `
      <div class="player-badge ${p.isWinner ? 'badge-winner' : p.eliminated ? 'badge-eliminated' : currentPlayer()?.id === p.id ? 'badge-turn' : 'status-ready'}">
        ${p.isWinner ? 'ÙØ§Ø¦Ø²' : p.eliminated ? 'Ù…Ù‚ØµÙ‰' : currentPlayer()?.id === p.id ? 'Ø§Ù„Ø¯ÙˆØ±' : 'Ø¬Ø§Ù‡Ø²'}
      </div>
      <div class="player-name">${p.name}</div>
    `;
    
    playersGrid.appendChild(playerCard);
  });
  
  renderPendingPlayersTable();
  updateCounts();
  renderTurnBanner();
  updateStats();
}

/* ===== Ø¹Ø±Ø¶ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª ===== */
function renderCards() {
  const cardsGrid = document.getElementById('cardsGrid');
  if (!cardsGrid) return;
  
  cardsGrid.innerHTML = '';
  
  if (state.cards.length === 0) {
    for (let i = 0; i < 6; i++) {
      const ghost = document.createElement('div');
      ghost.className = 'card-item';
      ghost.style.opacity = '0.5';
      ghost.innerHTML = `
        <div style="text-align: center; color: var(--muted);">
          <div style="font-size: 14px; margin-bottom: 10px;">ğŸƒ Ø¨Ø·Ø§Ù‚Ø©</div>
          <div style="font-size: 12px;">Ø³ÙŠØ¶Ø§Ù ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§</div>
        </div>
      `;
      cardsGrid.appendChild(ghost);
    }
    return;
  }
  
  state.cards.forEach(c => {
    const cardItem = document.createElement('div');
    cardItem.className = 'card-item';
    cardItem.dataset.id = c.id;
    
    if (c.revealed) cardItem.classList.add('revealed');
    if (c.locked) cardItem.classList.add('locked');
    if (state.selectedCardId === c.id) cardItem.classList.add('selected');
    
    cardItem.onclick = () => {
      if (!state.started) {
        showNotification('Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø£ÙˆÙ„Ø§Ù‹.', 'warning');
        return;
      }
      if (state.gameEnded) {
        showNotification('Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù„Ø¹Ø¨Ø©.', 'warning');
        return;
      }
      if (c.locked) {
        showNotification('Ù‡Ø°Ù‡ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ù…Ù‚ÙÙ„Ø©.', 'warning');
        return;
      }
      if (c.revealed) {
        showNotification('Ù‡Ø°Ù‡ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ù…Ù‚ØµØ§Ø© Ù…Ø³Ø¨Ù‚Ù‹Ø§.', 'warning');
        return;
      }
      
      state.selectedCardId = c.id;
      document.querySelectorAll('.card-item').forEach(item => item.classList.remove('selected'));
      cardItem.classList.add('selected');
      tryResolveIfReady();
    };
    
    cardItem.innerHTML = `
      <div class="card-status ${c.revealed ? 'status-revealed' : c.locked ? 'status-locked' : 'status-ready'}">
        ${c.revealed ? 'Ù…Ù‚ØµØ§Ø©' : c.locked ? 'Ù…Ù‚ÙÙ„Ø©' : 'Ø¬Ø§Ù‡Ø²Ø©'}
      </div>
      <div class="card-text">${c.text}</div>
    `;
    
    cardsGrid.appendChild(cardItem);
  });
  
  updateCounts();
  updateStats();
}

/* ===== ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© ===== */
function updateSelects() {
  const fakeOwner = document.getElementById('fakeOwner');
  if (!fakeOwner) return;
  
  fakeOwner.innerHTML = '<option value="">â€” Ø§Ø®ØªØ± Ù„Ø§Ø¹Ø¨Ù‹Ø§ â€”</option>';
  state.players.forEach(p => {
    const option = document.createElement('option');
    option.value = p.id;
    option.textContent = p.name;
    fakeOwner.appendChild(option);
  });
}

/* ===== Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… ===== */
function renderPendingPlayersTable() {
  const playersTable = document.getElementById('playersTable');
  if (!playersTable) return;
  
  playersTable.innerHTML = '';
  
  // Ø§Ù„Ù„Ø§Ø¹Ø¨ÙˆÙ† Ø§Ù„Ù†Ø´Ø·ÙˆÙ†
  state.players.forEach(p => {
    const tr = document.createElement('tr');
    const card = state.cards.find(c => c.ownerId === p.id);
    
    tr.innerHTML = `
      <td>${p.name}</td>
      <td>${p.eliminated ? 'Ù…Ù‚ØµÙ‰' : p.isWinner ? 'ğŸ† ÙØ§Ø¦Ø²' : 'Ù†Ø´Ø·'}</td>
      <td>${card ? card.text : 'â€”'}</td>
      <td>
        <button class="btn btn-danger" style="padding: 8px 16px; font-size: 12px;" onclick="deletePlayer('${p.id}')">Ø­Ø°Ù</button>
      </td>
    `;
    
    playersTable.appendChild(tr);
  });
  
  // Ø§Ù„Ù„Ø§Ø¹Ø¨ÙˆÙ† Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø£Ø³Ù…Ø§Ø¡ ÙˆÙ‡Ù…ÙŠØ©
  state.pendingPlayers.forEach(p => {
    const tr = document.createElement('tr');
    tr.style.backgroundColor = 'rgba(185, 103, 255, 0.1)';
    
    tr.innerHTML = `
      <td>${p.name}</td>
      <td style="color: var(--neon-yellow);">Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ø³Ù… ÙˆÙ‡Ù…ÙŠ</td>
      <td>
        <input type="text" placeholder="Ø§Ø³Ù… ÙˆÙ‡Ù…ÙŠ" id="fakeInput${p.id}" 
               style="width: 100%; padding: 8px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: var(--radius-xs); color: var(--text);">
      </td>
      <td>
        <button class="btn btn-success" style="padding: 8px 16px; font-size: 12px;" onclick="addFakeToPending('${p.id}')">Ø¥Ø¶Ø§ÙØ©</button>
        <button class="btn btn-danger" style="padding: 8px 16px; font-size: 12px; margin-right: 8px;" onclick="removePending('${p.id}')">Ø¥Ù„ØºØ§Ø¡</button>
      </td>
    `;
    
    playersTable.appendChild(tr);
  });
}

/* ===== Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… ===== */
function renderCardsTable() {
  const cardsTable = document.getElementById('cardsTable');
  if (!cardsTable) return;
  
  cardsTable.innerHTML = '';
  
  state.cards.forEach(c => {
    const tr = document.createElement('tr');
    
    tr.innerHTML = `
      <td>${c.text}</td>
      <td>${c.revealed ? 'Ù…Ù‚ØµØ§Ø©' : ''}${c.locked ? ' / Ù…Ù‚ÙÙ„Ø©' : ''}</td>
      <td>
        <button class="btn ${c.locked ? 'btn-success' : 'btn-warning'}" style="padding: 8px 16px; font-size: 12px;" onclick="toggleLockCard('${c.id}')">
          ${c.locked ? 'ÙØªØ­' : 'Ù‚ÙÙ„'}
        </button>
        <button class="btn btn-danger" style="padding: 8px 16px; font-size: 12px; margin-right: 8px;" onclick="deleteCard('${c.id}')">Ø­Ø°Ù</button>
      </td>
    `;
    
    cardsTable.appendChild(tr);
  });
}

/* ===== Ø¯ÙˆØ§Ù„ Ø§Ù„ØªØ­ÙƒÙ… ===== */
function addPlayerFromChat(username) {
  if (state.players.some(p => normalize(p.name) === normalize(username))) {
    log(`ğŸ’¬ Ø§Ù„Ø¨ÙˆØª: @${username} Ø£Ù†Øª Ù…Ø³Ø¬Ù„ Ø¨Ø§Ù„ÙØ¹Ù„!`);
    return;
  }
  
  const playerId = uid();
  const pendingPlayer = {
    id: playerId,
    name: username,
    joinedAt: new Date(),
    status: 'Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ø³Ù… ÙˆÙ‡Ù…ÙŠ'
  };
  
  state.pendingPlayers.push(pendingPlayer);
  renderPlayers();
  renderPendingPlayersTable();
  log(`ğŸ‘¤ ${username} Ø§Ù†Ø¶Ù… Ø¹Ø¨Ø± Ø§Ù„Ø´Ø§Øª (Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ø³Ù… ÙˆÙ‡Ù…ÙŠ)`);
  showNotification(`${username} Ø§Ù†Ø¶Ù… - Ø£Ø¶Ù Ù„Ù‡ Ø§Ø³Ù… ÙˆÙ‡Ù…ÙŠ`, 'success');
}

function addFakeToPending(playerId) {
  const input = document.getElementById(`fakeInput${playerId}`);
  if (!input || !input.value.trim()) {
    showNotification('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… ÙˆÙ‡Ù…ÙŠ', 'warning');
    return;
  }
  
  const fakeName = input.value.trim();
  const pendingIndex = state.pendingPlayers.findIndex(p => p.id === playerId);
  
  if (pendingIndex === -1) {
    showNotification('Ø§Ù„Ù„Ø§Ø¹Ø¨ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯', 'error');
    return;
  }
  
  if (state.cards.some(c => normalize(c.text) === normalize(fakeName))) {
    showNotification('Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙˆÙ‡Ù…ÙŠ Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¨Ù‚Ø§Ù‹!', 'error');
    return;
  }
  
  const pendingPlayer = state.pendingPlayers[pendingIndex];
  
  // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù„Ø§Ø¹Ø¨
  state.players.push({
    id: pendingPlayer.id,
    name: pendingPlayer.name,
    eliminated: false,
    correctGuesses: 0,
    wrongGuesses: 0,
    isWinner: false
  });
  
  // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©
  state.cards.push({
    id: uid(),
    text: fakeName,
    ownerId: pendingPlayer.id,
    revealed: false,
    locked: false
  });
  
  // Ø¥Ø²Ø§Ù„Ø© Ù…Ù† Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±
  state.pendingPlayers.splice(pendingIndex, 1);
  
  renderPlayers();
  renderCards();
  renderPendingPlayersTable();
  updateSelects();
  log(`âœ… ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙˆÙ‡Ù…ÙŠ "${fakeName}" Ù„Ù„Ø§Ø¹Ø¨ ${pendingPlayer.name}`);
  showNotification(`ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© ${fakeName} Ù„Ù€ ${pendingPlayer.name}`, 'success');
}

function removePending(playerId) {
  const pendingIndex = state.pendingPlayers.findIndex(p => p.id === playerId);
  if (pendingIndex === -1) return;
  
  const player = state.pendingPlayers[pendingIndex];
  state.pendingPlayers.splice(pendingIndex, 1);
  renderPendingPlayersTable();
  log(`âŒ ØªÙ… Ø¥Ø²Ø§Ù„Ø© ${player.name} Ù…Ù† Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±`);
}

function deletePlayer(playerId) {
  if (!confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù„Ø§Ø¹Ø¨ØŸ')) return;
  
  state.cards = state.cards.filter(c => c.ownerId !== playerId);
  state.players = state.players.filter(p => p.id !== playerId);
  if (state.turnIndex >= state.players.length) state.turnIndex = state.players.length - 1;
  
  renderPlayers();
  renderCards();
  renderPendingPlayersTable();
  renderTurnBanner();
  log('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù„Ø§Ø¹Ø¨');
}

function deleteCard(cardId) {
  if (!confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©ØŸ')) return;
  
  state.cards = state.cards.filter(c => c.id !== cardId);
  renderCards();
  renderCardsTable();
  log('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©');
}

function toggleLockCard(cardId) {
  const card = byId(state.cards, cardId);
  if (!card) return;
  
  card.locked = !card.locked;
  renderCards();
  renderCardsTable();
  log(`ØªÙ… ${card.locked ? 'Ù‚ÙÙ„' : 'ÙØªØ­'} Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©`);
}

/* ===== Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± ===== */
function tryResolveIfReady() {
  if (state.gameEnded) return;
  
  const turnP = currentPlayer();
  if (!turnP || turnP.eliminated) return;

  const mentionedId = state.selectedMentionedId;
  const cardId = state.selectedCardId;
  if (!mentionedId || !cardId) return;

  const mentioned = byId(state.players, mentionedId);
  const card = byId(state.cards, cardId);
  if (!mentioned || !card || card.locked) return;

  // ØªØªØ¨Ø¹ Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø±Ø§Øª
  if (!state.cardChoices[cardId]) state.cardChoices[cardId] = 0;
  state.cardChoices[cardId]++;

  const correct = !!card.ownerId && card.ownerId === mentioned.id;

  if (correct) {
    card.revealed = true;
    mentioned.correctGuesses++;
    
    if (!mentioned.eliminated) {
      mentioned.eliminated = true;
      log(`âœ… ØµØ­ÙŠØ­! "${card.text}" ØªØ®Øµ ${mentioned.name}. ØªÙ… Ø¥Ù‚ØµØ§Ø¤Ù‡.`);
    }
    
    showMiddleCards(mentioned.name, card.text, true);
    showNotification(`ğŸ‰ ${mentioned.name} ØªÙ… Ø¥Ù‚ØµØ§Ø¤Ù‡!`, 'success');
  } else {
    mentioned.wrongGuesses++;
    log(`âŒ ØºÙŠØ± ØµØ­ÙŠØ­! "${card.text}" Ù„Ø§ ØªØ®Øµ ${mentioned.name}.`);
    
    showMiddleCards(mentioned.name, card.text, false);
    showNotification(`âŒ ${mentioned.name} Ù„ÙŠØ³ Ù‡Ùˆ ${card.text}`, 'error');
  }

  renderPlayers();
  renderCards();
  
  // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙÙˆØ²
  if (!checkWinCondition()) {
    setTimeout(() => nextTurnAuto(), 1500);
  }
}

/* ===== Ø¹Ø±Ø¶ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª ÙÙŠ Ø§Ù„Ù…Ù†ØªØµÙ ===== */
function showMiddleCards(player, card, isCorrect) {
  const middleSection = document.getElementById('cardsMiddle');
  const leftCard = document.getElementById('middleLeftCard');
  const rightCard = document.getElementById('middleRightCard');
  const resultOverlay = document.getElementById('matchResult');
  const resultText = document.getElementById('resultText');
  const resultMessage = document.getElementById('resultMessage');
  
  if (!middleSection || !leftCard || !rightCard || !resultOverlay) return;
  
  // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†ØµÙˆØµ
  document.getElementById('middlePlayer').textContent = player;
  document.getElementById('middleCard').textContent = card;
  
  // Ø¹Ø±Ø¶ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª
  middleSection.style.display = 'flex';
  setTimeout(() => {
    leftCard.classList.add('show');
    rightCard.classList.add('show');
  }, 100);
  
  // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªÙŠØ¬Ø©
  setTimeout(() => {
    middleSection.style.display = 'none';
    leftCard.classList.remove('show');
    rightCard.classList.remove('show');
    
    if (isCorrect) {
      resultText.textContent = 'ğŸ‰ ØµØ­ÙŠØ­!';
      resultText.style.color = 'var(--neon-green)';
      resultMessage.textContent = `${player} ØªÙ… Ø¥Ù‚ØµØ§Ø¤Ù‡!`;
    } else {
      resultText.textContent = 'âŒ ØºÙŠØ± ØµØ­ÙŠØ­';
      resultText.style.color = 'var(--neon-red)';
      resultMessage.textContent = `${player} Ù„ÙŠØ³ Ù‡Ùˆ ${card}`;
    }
    
    resultOverlay.style.display = 'flex';
    
    setTimeout(() => {
      resultOverlay.style.display = 'none';
    }, 2000);
  }, 1500);
}

/* ===== Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙÙˆØ² ===== */
function checkWinCondition() {
  if (state.gameEnded) return false;
  
  const alive = alivePlayers();
  
  if (alive.length === 2) {
    endGame(alive);
    return true;
  } else if (alive.length === 1) {
    endGame(alive);
    return true;
  } else if (alive.length === 0) {
    state.gameEnded = true;
    state.started = false;
    clearInterval(state.turnTimer);
    log('ğŸ² Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù„Ø¹Ø¨Ø©! Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙØ§Ø¦Ø²ÙŠÙ†.');
    return true;
  }
  
  return false;
}

function endGame(winners) {
  state.gameEnded = true;
  state.started = false;
  clearInterval(state.turnTimer);
  
  winners.forEach(p => {
    p.isWinner = true;
    p.eliminated = false;
  });
  
  state.lastWinners = winners;
  const winnerNames = winners.map(w => w.name).join(' Ùˆ ');
  log(`ğŸ† Ø§Ù„ÙØ§Ø¦Ø²ÙˆÙ†: ${winnerNames}! Ù…Ø¨Ø±ÙˆÙƒ Ù„Ù„ÙØ§Ø¦Ø²ÙŠÙ†!`);
  
  showWinnersAnimation(winnerNames);
  showNotification(`ğŸ† ${winnerNames} ÙŠÙÙˆØ²ÙˆÙ†!`, 'success');
}

function showWinnersAnimation(names) {
  const overlay = document.getElementById('winnerOverlay');
  const winnerNames = document.getElementById('winnerNames');
  
  if (!overlay || !winnerNames) return;
  
  winnerNames.textContent = names;
  overlay.style.display = 'flex';
}

/* ===== Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø¯ÙˆØ§Ø± ===== */
function startGame() {
  if (state.gameEnded) {
    resetGame();
    return;
  }
  
  if (alivePlayers().length === 0) {
    showNotification('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù„Ø§Ø¹Ø¨ÙŠÙ†.', 'warning');
    return;
  }
  if (state.cards.length === 0) {
    showNotification('Ø£Ø¶Ù Ø¨Ø·Ø§Ù‚Ø§Øª Ø£ÙˆÙ„Ø§Ù‹.', 'warning');
    return;
  }
  
  state.started = true;
  state.gameEnded = false;
  state.turnIndex = state.players.findIndex(p => !p.eliminated);
  if (state.turnIndex < 0) state.turnIndex = 0;
  
  log('Ø¨Ø¯Ø£Øª Ø§Ù„Ù„Ø¹Ø¨Ø©.');
  showNotification('Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¨Ø¯Ø£Øª!', 'success');
  renderPlayers();
  renderCards();
  renderTurnBanner();
}

function nextTurnAuto() {
  if (!state.started || state.gameEnded) return;
  const n = state.players.length;
  if (!n) return;
  
  let i = state.turnIndex;
  for (let step = 0; step < n; step++) {
    i = (i + 1) % n;
    if (!state.players[i].eliminated) {
      state.turnIndex = i;
      break;
    }
  }

  state.selectedMentionedId = null;
  state.selectedCardId = null;
  
  if (!checkWinCondition()) {
    renderPlayers();
    renderTurnBanner();
    showNotification(`Ø§Ù„Ø¯ÙˆØ± Ø§Ù„Ø¢Ù†: ${currentPlayer()?.name || 'â€”'}`, 'info');
  }
}

function resetGame() {
  state.gameEnded = false;
  state.started = false;
  state.turnIndex = -1;
  state.lastWinners = [];
  state.cardChoices = {};
  state.currentRound = 1;
  state.timerPaused = false;
  state.timerRunning = false;
  
  state.players.forEach(p => {
    p.eliminated = false;
    p.correctGuesses = 0;
    p.wrongGuesses = 0;
    p.isWinner = false;
  });
  
  state.cards.forEach(c => {
    c.revealed = false;
    c.locked = false;
  });
  
  state.selectedMentionedId = null;
  state.selectedCardId = null;
  state.timeLeft = 60;
  clearInterval(state.turnTimer);
  
  log('ØªÙ…Øª Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©.');
  showNotification('ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©', 'info');
  renderPlayers();
  renderCards();
  renderTurnBanner();
  updateTimerControls();
  updateStats();
}

/* ===== Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø´Ø§Øª ===== */
function setConnStatus(ok, platformName = null) {
  state.chatConnected = !!ok;
  state.chatPlatform = platformName === 'Twitch' ? 'twitch' : platformName === 'Kick' ? 'kick' : null;
  
  const statusDot = document.getElementById('statusDot');
  const statusText = document.getElementById('statusText');
  const connectBtn = document.getElementById('connectBtn');
  const disconnectBtn = document.getElementById('disconnectBtn');
  const channelName = document.getElementById('channelName');
  
  if (statusDot) statusDot.className = 'status-dot' + (ok ? ' connected' : '');
  if (statusText) statusText.textContent = ok ? `Ù…ØªØµÙ„ Ø¨Ù€ ${platformName}` : 'ØºÙŠØ± Ù…ØªØµÙ„';
  if (connectBtn) connectBtn.disabled = ok;
  if (disconnectBtn) disconnectBtn.disabled = !ok;
  if (channelName) channelName.disabled = ok;
  
  if (ok) {
    showNotification(`ØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ ${platformName}`, 'success');
  }
}

async function connectTwitch(channel) {
  if (!window.tmi) {
    showNotification('tmi.js ØºÙŠØ± Ù…ÙØ­Ù…Ù‘ÙÙ„', 'error');
    return;
  }
  
  try {
    disconnectFromChat(); // Ù‚Ø·Ø¹ Ø£ÙŠ Ø§ØªØµØ§Ù„ Ø³Ø§Ø¨Ù‚
    
    const client = new tmi.Client({
      channels: [channel],
      connection: {
        secure: true,
        reconnect: true,
        reconnectDecay: 1.4,
        reconnectInterval: 2000
      },
      options: { debug: false }
    });

    state.chatClient = client;
    
    client.on('connected', (address, port) => {
      state.connFlags.twitch = true;
      localStorage.setItem('fn_twitch_channel', channel);
      setConnStatus(true, 'Twitch');
      state.chatChannel = channel;
      log(`âœ… ØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø´Ø§Øª Twitch: ${channel}`);
    });

    client.on('disconnected', (reason) => {
      state.connFlags.twitch = false;
      setConnStatus(false, null);
      log(`âš ï¸ Ø§Ù†Ù‚Ø·Ø¹ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø´Ø§Øª Twitch: ${reason || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}`);
    });

    client.on('message', (channel, tags, message, self) => {
      if (self) return;
      const user = tags['display-name'] || tags.username || 'Ù…Ø´Ø§Ù‡Ø¯';
      handleChatCommand(user, message.trim());
    });

    await client.connect();
    return true;
  } catch (e) {
    console.error('Twitch connection error:', e);
    showNotification(`ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ Twitch: ${e.message}`, 'error');
    setConnStatus(false, null);
    return false;
  }
}

async function connectKick(channel) {
  try {
    disconnectFromChat(); // Ù‚Ø·Ø¹ Ø£ÙŠ Ø§ØªØµØ§Ù„ Ø³Ø§Ø¨Ù‚
    
    // Ø£ÙˆÙ„Ø§Ù‹ Ù†Ø­Ø§ÙˆÙ„ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù‚Ù†Ø§Ø©
    const res = await fetch(`https://kick.com/api/v2/channels/${channel}`, {
      headers: {
        'Accept': 'application/json',
        'Content-Type': 'application/json'
      }
    });
    
    if (!res.ok) {
      throw new Error('ÙØ´Ù„ ÙÙŠ Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù‚Ù†Ø§Ø©');
    }
    
    const data = await res.json();
    const roomId = data?.chatroom?.id;
    
    if (!roomId) {
      throw new Error('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ØºØ±ÙØ© Ø§Ù„Ø´Ø§Øª');
    }

    // Ø¥Ù†Ø´Ø§Ø¡ Ø§ØªØµØ§Ù„ WebSocket
    const ws = new WebSocket("wss://ws-us2.pusher.com/app/32cbd69e4b950bf97679?protocol=7&client=js&version=8.4.0-rc2&flash=false");
    state.kickSocket = ws;

    ws.onopen = () => {
      // Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ÙÙŠ ØºØ±ÙØ© Ø§Ù„Ø´Ø§Øª
      ws.send(JSON.stringify({
        event: "pusher:subscribe",
        data: {
          auth: "",
          channel: `chatrooms.${roomId}.v2`
        }
      }));
      
      // Ø¥Ø±Ø³Ø§Ù„ ping Ø¯ÙˆØ±ÙŠ Ù„Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„Ø§ØªØµØ§Ù„
      const pingInterval = setInterval(() => {
        if (ws.readyState === WebSocket.OPEN) {
          ws.send(JSON.stringify({ event: "pusher:ping", data: {} }));
        } else {
          clearInterval(pingInterval);
        }
      }, 12000);

      state.connFlags.kick = true;
      localStorage.setItem('fn_kick_channel', channel);
      setConnStatus(true, 'Kick');
      state.chatChannel = channel;
      log(`âœ… ØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø´Ø§Øª Kick: ${channel}`);
    };

    ws.onmessage = (event) => {
      try {
        const pkt = JSON.parse(event.data);
        if (pkt.event === "App\\Events\\ChatMessageEvent") {
          const d = JSON.parse(pkt.data);
          const user = d?.sender?.username || 'Ù…Ø´Ø§Ù‡Ø¯';
          const text = (d?.content || '').trim();
          handleChatCommand(user, text);
        }
      } catch (e) {
        console.error('Error parsing Kick message:', e);
      }
    };

    ws.onerror = (error) => {
      console.error('Kick WebSocket error:', error);
      state.connFlags.kick = false;
      setConnStatus(false, null);
      log('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§ØªØµØ§Ù„ Kick');
    };

    ws.onclose = (event) => {
      console.log('Kick WebSocket closed:', event.code, event.reason);
      state.connFlags.kick = false;
      setConnStatus(false, null);
      log('âš ï¸ ØªÙ… Ø¥ØºÙ„Ø§Ù‚ Ø§ØªØµØ§Ù„ Kick');
    };

    return true;
  } catch (e) {
    console.error('Kick connection error:', e);
    showNotification(`ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ Kick: ${e.message}`, 'error');
    setConnStatus(false, null);
    return false;
  }
}

function disconnectFromChat() {
  console.log('Disconnecting from chat...');
  
  if (state.connFlags.twitch && state.chatClient) {
    try {
      state.chatClient.disconnect();
      console.log('Disconnected from Twitch');
    } catch (e) {
      console.error('Error disconnecting from Twitch:', e);
    }
    state.connFlags.twitch = false;
    state.chatClient = null;
  }
  
  if (state.connFlags.kick && state.kickSocket) {
    try {
      state.kickSocket.close();
      console.log('Disconnected from Kick');
    } catch (e) {
      console.error('Error disconnecting from Kick:', e);
    }
    state.connFlags.kick = false;
    state.kickSocket = null;
  }
  
  setConnStatus(false, null);
  state.chatChannel = '';
  log('âŒ ØªÙ… Ù‚Ø·Ø¹ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø´Ø§Øª');
  showNotification('ØªÙ… Ù‚Ø·Ø¹ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø´Ø§Øª', 'info');
}

function handleChatCommand(username, message) {
  if (!state.chatConnected) return;
  
  message = message.trim();
  const lowerMessage = message.toLowerCase();
  
  if (lowerMessage === '!Ø¯Ø®ÙˆÙ„') {
    addPlayerFromChat(username);
  } else if (lowerMessage === '!Ù„Ø§Ø¹Ø¨ÙŠÙ†') {
    const playerList = state.players.map(p => p.name).join('ØŒ ');
    log(`ğŸ’¬ Ø§Ù„Ø¨ÙˆØª: Ø§Ù„Ù„Ø§Ø¹Ø¨ÙˆÙ†: ${playerList || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù„Ø§Ø¹Ø¨ÙŠÙ†'}`);
  } else if (lowerMessage === '!Ø¨Ø·Ø§Ù‚Ø§Øª') {
    const cardList = state.cards.map(c => c.text).join('ØŒ ');
    log(`ğŸ’¬ Ø§Ù„Ø¨ÙˆØª: Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„ÙˆÙ‡Ù…ÙŠØ©: ${cardList || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨Ø·Ø§Ù‚Ø§Øª'}`);
  } else if (lowerMessage === '!Ø§Ù„Ø¯ÙˆØ±') {
    const current = currentPlayer();
    if (current && !current.eliminated) {
      log(`ğŸ’¬ Ø§Ù„Ø¨ÙˆØª: Ø§Ù„Ø¯ÙˆØ± Ø§Ù„Ø¢Ù†: ${current.name}`);
    } else {
      log(`ğŸ’¬ Ø§Ù„Ø¨ÙˆØª: Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¯ÙˆØ± Ø­Ø§Ù„ÙŠ`);
    }
  } else if (lowerMessage === '!Ù…Ø³Ø§Ø¹Ø¯Ø©' || lowerMessage === '!help') {
    log(`ğŸ’¬ Ø§Ù„Ø¨ÙˆØª: Ø§Ù„Ø£ÙˆØ§Ù…Ø±: !Ø¯Ø®ÙˆÙ„ - !Ù„Ø§Ø¹Ø¨ÙŠÙ† - !Ø¨Ø·Ø§Ù‚Ø§Øª - !Ø§Ù„Ø¯ÙˆØ± - !Ù…Ø³Ø§Ø¹Ø¯Ø©`);
  }
}

/* ===== Ø§Ù„ØªÙ‡ÙŠØ¦Ø© ===== */
document.addEventListener('DOMContentLoaded', function() {
  // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¬Ø³ÙŠÙ…Ø§Øª
  createParticles();
  
  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  document.getElementById('chatBtn').addEventListener('click', () => {
    document.getElementById('chatModal').style.display = 'flex';
  });
  
  document.getElementById('helpBtn').addEventListener('click', () => {
    document.getElementById('helpOverlay').style.display = 'flex';
  });
  
  document.getElementById('gmToggle').addEventListener('click', () => {
    const panel = document.getElementById('gm');
    panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
    showNotification('Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… ' + (panel.style.display === 'none' ? 'Ù…ØºÙ„Ù‚Ø©' : 'Ù…ÙØªÙˆØ­Ø©'), 'info');
  });
  
  document.getElementById('closeChat').addEventListener('click', () => {
    document.getElementById('chatModal').style.display = 'none';
  });
  
  document.getElementById('helpClose').addEventListener('click', () => {
    document.getElementById('helpOverlay').style.display = 'none';
  });
  
  document.getElementById('closeWinner').addEventListener('click', () => {
    document.getElementById('winnerOverlay').style.display = 'none';
    resetGame();
  });
  
  // Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„ÙˆÙ‚Øª
  document.getElementById('pauseTimer').addEventListener('click', pauseTimer);
  document.getElementById('playTimer').addEventListener('click', resumeTimer);
  document.getElementById('resetTimer').addEventListener('click', resetTimerToDefault);
  
  // Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø´Ø§Øª
  document.getElementById('twitchBtn').addEventListener('click', () => {
    state.chatPlatform = 'twitch';
    document.getElementById('twitchBtn').classList.add('btn-primary');
    document.getElementById('twitchBtn').classList.remove('btn-outline');
    document.getElementById('kickBtn').classList.add('btn-outline');
    document.getElementById('kickBtn').classList.remove('btn-primary');
  });
  
  document.getElementById('kickBtn').addEventListener('click', () => {
    state.chatPlatform = 'kick';
    document.getElementById('kickBtn').classList.add('btn-primary');
    document.getElementById('kickBtn').classList.remove('btn-outline');
    document.getElementById('twitchBtn').classList.add('btn-outline');
    document.getElementById('twitchBtn').classList.remove('btn-primary');
  });
  
  document.getElementById('connectBtn').addEventListener('click', async () => {
    const channel = document.getElementById('channelName').value.trim().toLowerCase();
    if (!channel) {
      showNotification('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù‚Ù†Ø§Ø©', 'warning');
      return;
    }
    
    // Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© ØªØ­Ù…ÙŠÙ„
    showNotification('Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø´Ø§Øª...', 'info');
    
    let success = false;
    
    if (state.chatPlatform === 'twitch') {
      success = await connectTwitch(channel);
    } else if (state.chatPlatform === 'kick') {
      success = await connectKick(channel);
    }
    
    if (!success) {
      showNotification('ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ø³Ù… Ø§Ù„Ù‚Ù†Ø§Ø©.', 'error');
    }
  });
  
  document.getElementById('disconnectBtn').addEventListener('click', disconnectFromChat);
  
  // Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ…
  document.getElementById('btnStart').addEventListener('click', startGame);
  document.getElementById('btnReset').addEventListener('click', resetGame);
  document.getElementById('btnSkip').addEventListener('click', () => {
    if (!state.started || state.gameEnded) {
      showNotification('Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø£ÙˆÙ„Ø§Ù‹.', 'warning');
      return;
    }
    const cur = currentPlayer()?.name || '-';
    log(`â­ï¸ ØªÙ… ØªØ¬Ø§ÙˆØ² Ø¯ÙˆØ± ${cur}.`);
    nextTurnAuto();
  });
  
  document.getElementById('btnShuffleCards').addEventListener('click', () => {
    for (let i = state.cards.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [state.cards[i], state.cards[j]] = [state.cards[j], state.cards[i]];
    }
    renderCards();
    showNotification('ØªÙ… Ø®Ù„Ø· Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª', 'info');
  });
  
  document.getElementById('btnLockAll').addEventListener('click', () => {
    state.cards.forEach(c => c.locked = true);
    renderCards();
    showNotification('ØªÙ… Ù‚ÙÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª', 'info');
  });
  
  document.getElementById('btnUnlockAll').addEventListener('click', () => {
    state.cards.forEach(c => c.locked = false);
    renderCards();
    showNotification('ØªÙ… ÙØªØ­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª', 'info');
  });
  
  // Ø£Ø²Ø±Ø§Ø± Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
  document.getElementById('addPlayerBtn').addEventListener('click', () => {
    const name = document.getElementById('playerName').value.trim();
    if (!name) {
      showNotification('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨', 'warning');
      return;
    }
    
    if (!state.players.some(p => normalize(p.name) === normalize(name))) {
      const playerId = uid();
      state.players.push({
        id: playerId,
        name,
        eliminated: false,
        correctGuesses: 0,
        wrongGuesses: 0,
        isWinner: false
      });
      
      document.getElementById('playerName').value = '';
      renderPlayers();
      updateSelects();
      log(`ğŸ‘¤ ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù„Ø§Ø¹Ø¨: ${name}`);
      showNotification(`ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù„Ø§Ø¹Ø¨ ${name}`, 'success');
    } else {
      showNotification('Ø§Ù„Ù„Ø§Ø¹Ø¨ Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ù‹Ø§.', 'warning');
    }
  });
  
  document.getElementById('addFakeBtn').addEventListener('click', () => {
    const text = document.getElementById('fakeWord').value.trim();
    const ownerId = document.getElementById('fakeOwner').value || null;
    
    if (!text) {
      showNotification('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… ÙˆÙ‡Ù…ÙŠ', 'warning');
      return;
    }
    
    if (ownerId) {
      state.cards.push({
        id: uid(),
        text,
        ownerId,
        revealed: false,
        locked: false
      });
      document.getElementById('fakeWord').value = '';
      renderCards();
      renderCardsTable();
      updateSelects();
      const ownerName = state.players.find(p => p.id === ownerId)?.name || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
      log(`ğŸƒ ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø¨Ø·Ø§Ù‚Ø©: "${text}" Ù„Ù„Ø§Ø¹Ø¨ ${ownerName}`);
      showNotification(`ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© ${text} Ù„Ù€ ${ownerName}`, 'success');
    } else {
      state.cards.push({
        id: uid(),
        text,
        ownerId: null,
        revealed: false,
        locked: false
      });
      document.getElementById('fakeWord').value = '';
      renderCards();
      renderCardsTable();
      log(`ğŸƒ ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø¨Ø·Ø§Ù‚Ø©: "${text}" Ø¨Ø¯ÙˆÙ† Ù…Ø§Ù„Ùƒ`);
      showNotification(`ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© ${text}`, 'success');
    }
  });
  
  document.getElementById('clearUnowned').addEventListener('click', () => {
    state.cards = state.cards.filter(c => !!c.ownerId);
    renderCards();
    renderCardsTable();
    updateSelects();
    log('ØªÙ…Øª Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª ØºÙŠØ± Ø§Ù„Ù…Ù…Ù„ÙˆÙƒØ©');
    showNotification('ØªÙ… ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª', 'info');
  });
  
  // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© ØªØ±Ø­ÙŠØ¨
  setTimeout(() => {
    showNotification('Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ùƒ ÙÙŠ Ù„Ø¹Ø¨Ø© Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„ÙˆÙ‡Ù…ÙŠØ© Ø§Ù„ÙØ§Ø®Ø±Ø©! ğŸ­', 'success');
  }, 1000);
  
  // Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø£ÙˆÙ„ÙŠØ©
  updateCounts();
  updateStats();
  updateTimerControls();
  renderTurnBanner();
});

// Ø¬Ø¹Ù„ Ø§Ù„Ø¯ÙˆØ§Ù„ Ù…ØªØ§Ø­Ø© Ø¹Ø§Ù„Ù…ÙŠØ§Ù‹ Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙÙŠ Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„
window.deletePlayer = deletePlayer;
window.deleteCard = deleteCard;
window.toggleLockCard = toggleLockCard;
window.addFakeToPending = addFakeToPending;
window.removePending = removePending;
</script>
</body>
</html>
